/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./src/Scripts/eDiscovery/FB_MatterDetails/src/FormBuilderHelper.ts":
/*!**************************************************************************!*\
  !*** ./src/Scripts/eDiscovery/FB_MatterDetails/src/FormBuilderHelper.ts ***!
  \**************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   enumFields: () => (/* binding */ enumFields),\n/* harmony export */   enumMatterDetailFields: () => (/* binding */ enumMatterDetailFields),\n/* harmony export */   runMe: () => (/* binding */ runMe)\n/* harmony export */ });\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n//This function is called from the module-loader webcomponent in the form builder\nfunction runMe(_x) {\n  return _runMe.apply(this, arguments);\n}\n\n// This function creates variables for the form.\nfunction _runMe() {\n  _runMe = _asyncToGenerator(function* (context) {\n    var {\n      expertMatterNumber,\n      matterDetails,\n      pipelineMatter\n    } = createVariables(context);\n    if (!expertMatterNumber) throw new Error(\"No expertMatterNumber\");\n    if (!matterDetails) throw new Error(\"No matterDetails\");\n    if (!pipelineMatter) throw new Error(\"No pipelineMatter\");\n    window.tester = context; //just for debugging\n    hideShowMatterDetails(matterDetails, expertMatterNumber, pipelineMatter);\n    //add a change event to the expert-matter-number\n    addEventHandlers(context, matterDetails, expertMatterNumber, pipelineMatter);\n    generateTempMatterNumber(context);\n  });\n  return _runMe.apply(this, arguments);\n}\nfunction createVariables(context) {\n  // Get the fields\n  // let matterDetails = context.fields[enumFields.matterDetails];\n\n  if (!context.form) throw new Error(\"No form\");\n  var matterDetails = context.form.fieldsById[enumFields.customAltEdiscoveryInstructionMatterDetails];\n  var expertMatterNumber = context.form.fieldsById[enumFields.expertMatterNumber];\n  var pipelineMatter = context.form.fieldsById[enumFields.pipelineMatter];\n\n  // Return the variables\n  return {\n    expertMatterNumber,\n    matterDetails,\n    pipelineMatter\n  };\n}\nfunction addEventHandlers(context, matterDetails, expertMatterNumber, pipelineMatter) {\n  var _context$form$fieldsB, _context$form$fieldsB2, _context$form$fieldsB3;\n  if (!context.form) throw new Error(\"No form\");\n  (_context$form$fieldsB = context.form.fieldsById[enumFields.expertMatterNumber]) === null || _context$form$fieldsB === void 0 ? void 0 : _context$form$fieldsB.on(\"change\", function (ev) {\n    // hide or show the matter details field\n    hideShowMatterDetails(matterDetails, expertMatterNumber, pipelineMatter);\n\n    // update the matter details field\n    updateMatterDetails(matterDetails, expertMatterNumber, pipelineMatter);\n  });\n\n  //add event handlet for pipeline-matter changed\n  (_context$form$fieldsB2 = context.form.fieldsById[enumFields.pipelineMatter]) === null || _context$form$fieldsB2 === void 0 ? void 0 : _context$form$fieldsB2.on(\"change\", function (ev) {\n    // hide or show the matter details field\n    hideShowMatterDetails(matterDetails, expertMatterNumber, pipelineMatter);\n\n    // update the matter details field\n    updateMatterDetails(matterDetails, expertMatterNumber, pipelineMatter);\n  });\n\n  //add event handlet for jurisdiction changed\n  (_context$form$fieldsB3 = context.form.fieldsById[enumFields.jurisdictionsCountry]) === null || _context$form$fieldsB3 === void 0 ? void 0 : _context$form$fieldsB3.on(\"change\", /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator(function* (ev) {\n      var _context$form, _context$form$fieldsB4, _context$form2, _context$form2$fields;\n      //update blade jurisdiction     \n      var selectedId = (_context$form = context.form) === null || _context$form === void 0 ? void 0 : (_context$form$fieldsB4 = _context$form.fieldsById[\"jurisdictions-country\"]) === null || _context$form$fieldsB4 === void 0 ? void 0 : _context$form$fieldsB4.getValue();\n      console.log(\"%c Jurisdiction changed to: \" + ((_context$form2 = context.form) === null || _context$form2 === void 0 ? void 0 : (_context$form2$fields = _context$form2.fieldsById[\"jurisdictions-country\"]) === null || _context$form2$fields === void 0 ? void 0 : _context$form2$fields.getValue()), \"color: red; font-size: 20px;\");\n      var aspect = context.getAspect(\"Sharedo.Core.Legal.Aspects.Widgets.InstructionWorkTypeDetails\");\n      var selectedJurisdictionCountry = yield $ajax.get(\"/api/v1/public/modeller/optionSets/allValues/\".concat(selectedId));\n      if (!selectedJurisdictionCountry) {\n        //log issue\n        console.log(\"%c [ModuleLoader] getAspect return value\", \"background: #222; color: #bada55\", selectedJurisdictionCountry);\n        return;\n      }\n      var options = yield $ajax.get(\"/api/v1/public/modeller/optionSets/jurisdictions/values\");\n      var selectedJurisdiction = options.find(option => option.name === selectedJurisdictionCountry.name);\n      if (!selectedJurisdiction) {\n        //log issue\n        console.log(\"%c [ModuleLoader] getAspect return value\", \"background: #222; color: #bada55\", selectedJurisdiction);\n        return;\n      }\n      aspect.widget.instruction.jurisdictionId(selectedJurisdiction.id);\n    });\n    return function (_x2) {\n      return _ref.apply(this, arguments);\n    };\n  }());\n}\n\n// hide or show the matter details field\nfunction hideShowMatterDetails(matterDetails, expertMatterNumber, pipelineMatter) {\n  setMatterDetailsState(matterDetails, pipelineMatter.getValue());\n}\n\n// make all child properties readonly\nfunction setMatterDetailsState(matterDetails) {\n  var _matterDetails$fields, _matterDetails$fields2;\n  var status = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n  if (!matterDetails.fields) throw new Error(\"No fields\");\n  if (!matterDetails.fieldsById) throw new Error(\"No fieldsById\");\n\n  // get all the child properties\n  matterDetails.fields.forEach(child => {\n    // set the readonly status of the child property\n    child.readonly(!status);\n  });\n\n  // show/hide the partner name and selector\n  (_matterDetails$fields = matterDetails.fieldsById[enumMatterDetailFields.matterDetailsPartnerSelector]) === null || _matterDetails$fields === void 0 ? void 0 : _matterDetails$fields.hidden(!status);\n  (_matterDetails$fields2 = matterDetails.fieldsById[enumMatterDetailFields.matterDetailsPartnerName]) === null || _matterDetails$fields2 === void 0 ? void 0 : _matterDetails$fields2.hidden(status);\n}\n\n// clear all the child properties of the matter details sub area of the form builder\nfunction clearMatterDetails(_x3) {\n  return _clearMatterDetails.apply(this, arguments);\n}\n/* \n1. We first get the data from the endpoint by calling getMatterData() function\n2. Then we clear the matterDetails\n3. We find the selected matter by using the matter code and client name from the data we got from the endpoint\n4. If the matter is undefined, we clear the matterDetails and return\n5. If the matter is not undefined, we set the values of the matterDetails fields */\nfunction _clearMatterDetails() {\n  _clearMatterDetails = _asyncToGenerator(function* (matterDetails) {\n    var _matterDetails$fields3;\n    (_matterDetails$fields3 = matterDetails.fields) === null || _matterDetails$fields3 === void 0 ? void 0 : _matterDetails$fields3.forEach(function (child) {\n      child.setValue(\"\");\n    });\n  });\n  return _clearMatterDetails.apply(this, arguments);\n}\nfunction updateMatterDetails(_x4, _x5, _x6) {\n  return _updateMatterDetails.apply(this, arguments);\n}\nfunction _updateMatterDetails() {\n  _updateMatterDetails = _asyncToGenerator(function* (matterDetails, expertMatterNumber, pipelineMatter) {\n    var _matterDetails$parent, _matterDetails$parent2, _matterDetails$parent3, _matterDetails$fields4, _matterDetails$fields5, _matterDetails$fields6, _matterDetails$fields7, _matterDetails$fields8, _matterDetails$fields9;\n    var data = yield getMatterData();\n    clearMatterDetails(matterDetails); //clear the matter details form\n\n    var selectedMatter = data.find(function (matter) {\n      return expertMatterNumber.getValue() === \"\".concat(matter.data.matterCode, \" - \").concat(matter.data.client.name);\n    });\n    if (selectedMatter === undefined || pipelineMatter.getValue() === true) {\n      //if the matter is not found or if the matter is a pipeline matter, clear the matter details form and return\n      clearMatterDetails(matterDetails);\n      return;\n    }\n    if (!((_matterDetails$parent = matterDetails.parent) !== null && _matterDetails$parent !== void 0 && _matterDetails$parent.fieldsById)) throw new Error(\"No client\");\n    var tempMatterNumber = (_matterDetails$parent2 = matterDetails.parent) === null || _matterDetails$parent2 === void 0 ? void 0 : (_matterDetails$parent3 = _matterDetails$parent2.fieldsById['temp-matter-number']) === null || _matterDetails$parent3 === void 0 ? void 0 : _matterDetails$parent3.getValue();\n    if (tempMatterNumber === undefined || tempMatterNumber.length === 0) {\n      // matterDetails.parent.childrenByPropertyId['temp-matter-number'].setValue(\"N/A\");\n    }\n    (_matterDetails$fields4 = matterDetails.fieldsById[enumMatterDetailFields.matterDetailsClientName]) === null || _matterDetails$fields4 === void 0 ? void 0 : _matterDetails$fields4.setValue(selectedMatter.data.client.name);\n    (_matterDetails$fields5 = matterDetails.fieldsById[enumMatterDetailFields.matterDetailsClientCode]) === null || _matterDetails$fields5 === void 0 ? void 0 : _matterDetails$fields5.setValue(selectedMatter.data.client.code);\n    (_matterDetails$fields6 = matterDetails.fieldsById[enumMatterDetailFields.matterDetailsPracticeArea]) === null || _matterDetails$fields6 === void 0 ? void 0 : _matterDetails$fields6.setValue(selectedMatter.data.practiceArea.name);\n    (_matterDetails$fields7 = matterDetails.fieldsById[enumMatterDetailFields.matterDetailsName]) === null || _matterDetails$fields7 === void 0 ? void 0 : _matterDetails$fields7.setValue(selectedMatter.data.shortName);\n    (_matterDetails$fields8 = matterDetails.fieldsById[enumMatterDetailFields.matterDetailsPartnerName]) === null || _matterDetails$fields8 === void 0 ? void 0 : _matterDetails$fields8.setValue(selectedMatter.data.partner.name);\n    (_matterDetails$fields9 = matterDetails.fieldsById[enumMatterDetailFields.matterDetailsIb]) === null || _matterDetails$fields9 === void 0 ? void 0 : _matterDetails$fields9.setValue(selectedMatter.data.secure);\n    console.log(\"matterDetails.isValid():\" + matterDetails.isValid());\n  });\n  return _updateMatterDetails.apply(this, arguments);\n}\nfunction getMatterData() {\n  return _getMatterData.apply(this, arguments);\n}\nfunction _getMatterData() {\n  _getMatterData = _asyncToGenerator(function* () {\n    //get the data from the server without cache\n    return yield $ajax.get(window.document.location.origin + \"/_ideFiles/SampleData/eDiscovery/matters.json\");\n  });\n  return _getMatterData.apply(this, arguments);\n}\nfunction generateTempMatterNumber(context) {\n  var _context$form3, _context$form3$fields;\n  var date = new Date();\n  var year = date.getFullYear();\n  var month = date.getMonth() + 1;\n  var day = date.getDate();\n  var hour = date.getHours();\n  var minute = date.getMinutes();\n  var second = date.getSeconds();\n  var millisecond = date.getMilliseconds();\n  var tempMatterNumber = \"T\".concat(year).concat(month).concat(day).concat(hour).concat(minute).concat(second).concat(millisecond);\n  (_context$form3 = context.form) === null || _context$form3 === void 0 ? void 0 : (_context$form3$fields = _context$form3.fieldsById[enumFields.tempMatterNumber]) === null || _context$form3$fields === void 0 ? void 0 : _context$form3$fields.setValue(tempMatterNumber);\n}\nvar enumFields = /*#__PURE__*/function (enumFields) {\n  enumFields[\"customAltEdiscoveryInstructionMatterDetails\"] = \"custom-alt-ediscovery-instruction-matter-details\";\n  enumFields[\"jurisdictionsCountry\"] = \"jurisdictions-country\";\n  enumFields[\"pipelineMatter\"] = \"pipeline-matter\";\n  enumFields[\"expertMatterNumber\"] = \"expert-matter-number\";\n  enumFields[\"tempMatterNumber\"] = \"temp-matter-number\";\n  enumFields[\"subMatterCode\"] = \"sub-matter-code\";\n  enumFields[\"abcMatterNumber\"] = \"abc-matter-number\";\n  enumFields[\"matterDetails\"] = \"matter-details\";\n  return enumFields;\n}({});\nvar enumMatterDetailFields = /*#__PURE__*/function (enumMatterDetailFields) {\n  enumMatterDetailFields[\"matterDetailsPartnerSelector\"] = \"matter-details-partner-selector\";\n  enumMatterDetailFields[\"matterDetailsPartnerName\"] = \"matter-details-partner-name\";\n  enumMatterDetailFields[\"matterDetailsClientName\"] = \"matter-details-client-name\";\n  enumMatterDetailFields[\"matterDetailsClientCode\"] = \"matter-details-client-code\";\n  enumMatterDetailFields[\"matterDetailsPracticeArea\"] = \"matter-details-practice-area\";\n  enumMatterDetailFields[\"matterDetailsName\"] = \"matter-details-name\";\n  enumMatterDetailFields[\"matterDetailsIb\"] = \"matter-details-ib\";\n  return enumMatterDetailFields;\n}({});\n\n//# sourceURL=webpack://test/./src/Scripts/eDiscovery/FB_MatterDetails/src/FormBuilderHelper.ts?");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The require scope
/******/ 	var __webpack_require__ = {};
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module can't be inlined because the eval devtool is used.
/******/ 	var __webpack_exports__ = {};
/******/ 	__webpack_modules__["./src/Scripts/eDiscovery/FB_MatterDetails/src/FormBuilderHelper.ts"](0, __webpack_exports__, __webpack_require__);
/******/ 	
/******/ })()
;