(()=>{var e=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o={};(()=>{"use strict";e(o);var n=function(e,o,n,t){return new(n||(n=Promise))((function(i,r){function a(e){try{l(t.next(e))}catch(e){r(e)}}function s(e){try{l(t.throw(e))}catch(e){r(e)}}function l(e){var o;e.done?i(e.value):(o=e.value,o instanceof n?o:new n((function(e){e(o)}))).then(a,s)}l((t=t.apply(e,o||[])).next())}))};function t(e){return n(this,void 0,void 0,(function*(){return i(e,"GET",void 0)}))}function i(e,o,t){return n(this,void 0,void 0,(function*(){let n=function(e){let o=window.document.location.origin;return-1===e.indexOf(o)&&(0!==e.indexOf("/")&&(e="/"+e),e=o+e),e}(e),i=function(){let e=(n=function(){let e={};return document.cookie.split(";").reduce((function(o,n){var t=n.split("=");if(2===t.length){var i=t[0].trim(),r=t[1];e[i]=r}return o}),{}),e}()._api)?"Bearer "+n:null,o=new Headers;var n;return o.append("Content-Type","application/json"),e&&o.append("Authorization",e),o}();return yield fetch(n,{method:o,headers:i,body:t?JSON.stringify(t):void 0}).then((e=>{var o;if(console.log(e),-1===(null===(o=e.headers.get("content-type"))||void 0===o?void 0:o.indexOf("application/json")))throw new Error("Response was not JSON");return e.json()}))}))}var r=function(e,o,n,t){return new(n||(n=Promise))((function(i,r){function a(e){try{l(t.next(e))}catch(e){r(e)}}function s(e){try{l(t.throw(e))}catch(e){r(e)}}function l(e){var o;e.done?i(e.value):(o=e.value,o instanceof n?o:new n((function(e){e(o)}))).then(a,s)}l((t=t.apply(e,o||[])).next())}))};let a=document.querySelector(".navbar-brand");function s(){if(!$ui.pageContext.user)return void setTimeout((()=>{console.log("retry..."),s()}),1);let e=$ui.pageContext.user.userid();console.log("currentUserOdsId",e),t(`/api/ods/teams/person/${e}/primaryTeam`).then((o=>r(this,void 0,void 0,(function*(){console.log(`/api/ods/teams/person/${e}/primaryTeam`,o);let a=o.primaryTeam,s=a.organisationId;console.log("organisationId",s);let d=a.parentTeamId;console.log("parentTeamId",d);let c=a.id;console.log("teamId",c),function(e,o){return n(this,void 0,void 0,(function*(){return i("/api/v1/public/workItem/findByQuery","POST",o)}))}(0,{search:{page:{page:1,rowsPerPage:20},sort:{direction:"ascending",orderBy:"title"},types:{includeTypesDerivedFrom:["immersion-organization"]},roles:[{role:"immersion-related-to",subjectIdsHoldingRole:[c]}]},enrich:[{path:"title"},{path:"reference"},{path:"form-immersion-organisation.organizationThemeSystemName"}]}).then((e=>r(this,void 0,void 0,(function*(){if(console.log("/api/v1/public/workItem/findByQuery",e),!e||!e.results||!e.results[0])return void console.log("findByQuery: Nothing Found");let o=e.results[0];if(console.log("findByQuery: data",o),!o.data)return void console.log("findByQuery: No Data");let n=o.data["form-immersion-organisation.organizationThemeSystemName"];console.log("form-immersion-organisation.organizationThemeSystemName",n),n&&""!=n?(function(e){r(this,void 0,void 0,(function*(){let o=$ui.widgets.instances().find((e=>"Sharedo.Core.Case.Widgets.Logo"==e.base.systemName));console.log("Sharedo.Core.Case.Widgets.Logo",o),console.log("portalBrandLogoUrl <-- ",`/themes/${e}/images/portal-brand-logo`),$ui.pageContext.portalBrandLogoUrl(`/themes/${e}/images/portal-brand-logo`),console.log("$ui.widgets.create(Sharedo.Core.Case.Widgets.Logo)"),$ui.widgets.create("Sharedo.Core.Case.Widgets.Logo",o.base.id,{defaultLogo:"/theme/images/logo.png"},{id:o.base.id,systemName:"Sharedo.Core.Case.Widgets.Logo",canExpandCollapse:!0,isExpanded:!0,icon:null,title:"Logo",helpText:null})}))}(n),yield function(e){return r(this,void 0,void 0,(function*(){console.log("applyOrganisationTheme()...."),t(`/api/themes/bySystemName/${e}`).then((o=>{console.log(`/api/themes/bySystemName/${e}`,o);let n=JSON.parse(o.jsonConfig);console.log("r.jsonConfig",n),n.settings.forEach((e=>{"css-var"==e.type&&(console.log("css-var",e),document.documentElement.style.setProperty("--"+e.key,e.value)),"data-attr"==e.type&&(console.log("data-attr",e),document.documentElement.setAttribute("data-theme-"+e.key,e.value))})),console.log("...Done...")}))}))}(n)):console.log("No Theme")})))).finally((()=>{l()}))})))).finally((()=>{})).catch((e=>{console.log("Error",e),l()}))}function l(){a.classList.add("loaded")}document.addEventListener("DOMContentLoaded",(()=>{s()}))})();var n=Globals="undefined"==typeof Globals?{}:Globals;for(var t in o)n[t]=o[t];o.__esModule&&Object.defineProperty(n,"__esModule",{value:!0})})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEVBQVVHLFNBQVNDLFNBQVNDLElBQ1YsV0FBVkEsRUFBRUMsT0FDRjFDLFFBQVFDLElBQUksVUFBV3dDLEdBQ3ZCcEUsU0FBU3NFLGdCQUFnQkMsTUFBTUMsWUFBWSxLQUFPSixFQUFFdEQsSUFBS3NELEVBQUU5RSxRQUdqRCxhQUFWOEUsRUFBRUMsT0FDRjFDLFFBQVFDLElBQUksWUFBYXdDLEdBQ3pCcEUsU0FBU3NFLGdCQUFnQkcsYUFBYSxjQUFnQkwsRUFBRXRELElBQUtzRCxFQUFFOUUsTyxJQUt2RXFDLFFBQVFDLElBQUksYUFBYSxHQUdqQyxHLENBNUNrQjhDLENBQXVCdkIsSUFMekJ4QixRQUFRQyxJQUFJLFdBU3BCLE1BQUcrQyxTQUFRLEtBQ1BDLEdBQVksR0FFcEIsTUFBR0QsU0FBUSxTQUVSRSxPQUFPQyxJQUNObkQsUUFBUUMsSUFBSSxRQUFTa0QsR0FDckJGLEdBQVksR0FFcEIsQ0FJQSxTQUFTQSxJQUNMNUMsRUFBZStDLFVBQVVDLElBQUksU0FDakMsQ0F0SEFoRixTQUFTaUYsaUJBQWlCLG9CQUFvQixLQUc5Qy9DLEdBQTRCLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9HbG9iYWxzL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL0dsb2JhbHMvd2VicGFjay9ydW50aW1lL21ha2UgbmFtZXNwYWNlIG9iamVjdCIsIndlYnBhY2s6Ly9HbG9iYWxzLy4uLy4uL0NvbW1vbi9hcGkvYXBpLnRzIiwid2VicGFjazovL0dsb2JhbHMvLi9JbW1lcnNpb25UaGVtZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgcmVxdWlyZSBzY29wZVxudmFyIF9fd2VicGFja19yZXF1aXJlX18gPSB7fTtcblxuIiwiLy8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5yID0gKGV4cG9ydHMpID0+IHtcblx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG5cdH1cblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbn07IiwiXG4vKipcbiAqIFRoaXMgZmlsZSBjb250YWlucyB0aGUgYXBpIGNhbGxzIHRvIHRoZSBiYWNrZW5kLlxuICogdXRpbGlzaW5nIHRoZSBheGlvcyBsaWJyYXJ5IHRvIG1ha2UgdGhlIGNhbGxzLlxuICogaW5jbHVzaW5nIG9mIHdlYnBhY2tJZ25vcmUgaXMgdG8gYWxsb3cgdGhlIHdlYnBhY2sgdG8gaWdub3JlIHRoZSBjYWxscyBhbmQgbm90IHRyeSB0byBidW5kbGUgdGhlbS5cbiAqL1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZVBvc3Q8VD4oYXBpOiBzdHJpbmcsIHBvc3RCb2R5OiBhbnkpIDogUHJvbWlzZTxUPntcbiAgICAvL3JldHVybiBhd2FpdCAkYWpheC5wb3N0KC8qIHdlYnBhY2tJZ25vcmU6IHRydWUgKi8gdmFsaWRhdGVBcGkoYXBpKSwgcG9zdEJvZHkpO1xuICAgIHJldHVybiBleGVjdXRlRmV0Y2g8VD4oYXBpLFwiUE9TVFwiLHBvc3RCb2R5KTtcbn1cblxuLy8gZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVHZXQ8VD4oYXBpOiBzdHJpbmcpIDogUHJvbWlzZTxUPntcbi8vICAgICByZXR1cm4gYXdhaXQgJGFqYXguZ2V0KC8qIHdlYnBhY2tJZ25vcmU6IHRydWUgKi8gdmFsaWRhdGVBcGkoYXBpKSk7XG4vLyB9IFxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZUdldDxUPihhcGk6IHN0cmluZykgOiBQcm9taXNlPFQ+e1xuICAgcmV0dXJuIGV4ZWN1dGVGZXRjaDxUPihhcGksXCJHRVRcIix1bmRlZmluZWQpO1xufVxuXG5cblxuXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBleGVjdXRlUHV0PFQ+KGFwaTogc3RyaW5nLCBwb3N0Qm9keTogYW55KSA6IFByb21pc2U8VD57XG4gICAgLy9yZXR1cm4gYXdhaXQgJGFqYXgucHV0KC8qIHdlYnBhY2tJZ25vcmU6IHRydWUgKi8gdmFsaWRhdGVBcGkoYXBpKSwgcG9zdEJvZHkpO1xuICAgIHJldHVybiBleGVjdXRlRmV0Y2g8VD4oYXBpLFwiUFVUXCIscG9zdEJvZHkpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZURlbGV0ZTxUPihhcGk6IHN0cmluZykgOiBQcm9taXNlPFQ+e1xuICAgIC8vcmV0dXJuIGF3YWl0ICRhamF4LmRlbGV0ZSgvKiB3ZWJwYWNrSWdub3JlOiB0cnVlICovIHZhbGlkYXRlQXBpKGFwaSkpO1xuICAgIHJldHVybiBleGVjdXRlRmV0Y2g8VD4oYXBpLFwiREVMRVRFXCIsdW5kZWZpbmVkKTtcbn1cblxuZnVuY3Rpb24gdmFsaWRhdGVBcGkoYXBpOiBzdHJpbmcpIDogc3RyaW5ne1xuICAgbGV0IGxvY2F0aW9uPSAgd2luZG93LmRvY3VtZW50LmxvY2F0aW9uLm9yaWdpbjtcblxuICAgLy9pZiBhcGkgZG9lcyBub3QgaW5jbHVkZSB0aGUgbG9jYXRpb24gdGhlbiBhZGQgaXQuXG4gICAgaWYoYXBpLmluZGV4T2YobG9jYXRpb24pID09PSAtMSl7XG4gICAgICAgIC8vY2hlY2sgaWYgYXBpIHN0YXJ0IHdpdGggYSAvIGlmIG5vdCBhZGQgaXQuXG4gICAgICAgIGlmKGFwaS5pbmRleE9mKFwiL1wiKSAhPT0gMCl7XG4gICAgICAgICAgICBhcGkgPSBcIi9cIiArIGFwaTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgYXBpID0gbG9jYXRpb24gKyBhcGk7XG4gICAgfVxuICAgIHJldHVybiBhcGk7XG4gICAgXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBleGVjdXRlRmV0Y2g8VD4oYXBpOiBzdHJpbmcsIG1ldGhvZDpzdHJpbmcsZGF0YTphbnkpIDogUHJvbWlzZTxUPntcbiAgICBsZXQgdXJsID0gdmFsaWRhdGVBcGkoYXBpKTtcbiAgICBsZXQgZmV0Y2hIZWFkZXJzID0gYnVpbGRIZWFkZXJzKCk7XG4gICAgbGV0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLHtcbiAgICAgICAgbWV0aG9kOiBtZXRob2QsXG4gICAgICAgIGhlYWRlcnM6IGZldGNoSGVhZGVycyxcbiAgICAgICAgYm9keTogZGF0YT8gSlNPTi5zdHJpbmdpZnkoZGF0YSk6IHVuZGVmaW5lZFxuICAgIH1cbiAgICApLnRoZW4oKHJlc3BvbnNlKSA9PiB7XG4gICAgICAgIFxuICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgIC8vY2hlY2sgaWYgcmVzcG9uc2UgaXMgSlNPTlxuICAgICAgICBpZihyZXNwb25zZS5oZWFkZXJzLmdldChcImNvbnRlbnQtdHlwZVwiKT8uaW5kZXhPZihcImFwcGxpY2F0aW9uL2pzb25cIikgPT09IC0xKXtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlJlc3BvbnNlIHdhcyBub3QgSlNPTlwiKTtcbiAgICAgICAgfVxuICAgICAgICAvL3JldHVybiB0aGUganNvbiBhcyBvYmplY3RcbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcbiAgICB9KTtcbiAgICByZXR1cm4gcmVzcG9uc2U7XG59XG5cbmZ1bmN0aW9uIGJ1aWxkSGVhZGVycygpIHtcbiAgICBsZXQgYmVhcmVyID0gZ2V0QmVhcmVyVG9rZW4oKTtcbiAgICBsZXQgZmV0Y2hIZWFkZXJzID0gbmV3IEhlYWRlcnMoKTtcbiAgICBmZXRjaEhlYWRlcnMuYXBwZW5kKFwiQ29udGVudC1UeXBlXCIsIFwiYXBwbGljYXRpb24vanNvblwiKTtcbiAgICBpZiAoYmVhcmVyKSB7XG4gICAgICAgIGZldGNoSGVhZGVycy5hcHBlbmQoXCJBdXRob3JpemF0aW9uXCIsIGJlYXJlcik7XG4gICAgfVxuICAgIHJldHVybiBmZXRjaEhlYWRlcnM7XG59XG5cblxuZXhwb3J0IGZ1bmN0aW9uIGdldENvb2tpZXMoKTogeyBba2V5OnN0cmluZ106c3RyaW5nIH1cbntcbiAgICBsZXQgcmV0VmFsdWU6IHsgW2tleTpzdHJpbmddOnN0cmluZyB9ID0ge307XG4gICAgbGV0IGNvb2tpZXMgPSBkb2N1bWVudC5jb29raWUuc3BsaXQoXCI7XCIpLnJlZHVjZShmdW5jdGlvbiAoY29va2llcywgY29va2llKVxuICAgIHtcbiAgICAgICAgdmFyIHBhcnRzID0gY29va2llLnNwbGl0KFwiPVwiKTtcbiAgICAgICAgaWYgKHBhcnRzLmxlbmd0aCA9PT0gMilcbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIGtleSA9IHBhcnRzWzBdLnRyaW0oKTtcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IHBhcnRzWzFdO1xuXG4gICAgICAgICAgICByZXRWYWx1ZVtrZXldID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNvb2tpZXM7XG4gICAgfSwge30pO1xuXG4gICAgcmV0dXJuIHJldFZhbHVlO1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIGdldEJlYXJlclRva2VuKClcbntcbiAgICB2YXIgY29va2llcyA9IGdldENvb2tpZXMoKTtcbiAgICB2YXIgdG9rZW4gPSBjb29raWVzW1wiX2FwaVwiXTtcblxuICAgIGlmKCB0b2tlbiApIHJldHVybiBcIkJlYXJlciBcIiArIHRva2VuO1xuICAgIHJldHVybiBudWxsO1xufTsiLCJcclxuXHJcbmltcG9ydCB7IGV4ZWN1dGVHZXQsIGV4ZWN1dGVQb3N0LCBleGVjdXRlUHV0IH0gZnJvbSBcIi4uLy4uL0NvbW1vbi9hcGkvYXBpXCI7XHJcblxyXG5cclxubGV0IGhpZGRlbkVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm5hdmJhci1icmFuZFwiKTtcclxuXHJcblxyXG4vLzxkaXYgaWQ9XCJ0c3BhcnRpY2xlc1wiPjwvZGl2PlxyXG4vLyBsZXQgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuLy8gZGl2LmlkID0gXCJ0c3BhcnRpY2xlc1wiO1xyXG4vLyBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGRpdik7XHJcbi8vIGxvYWRTdGFyc1ByZXNldCh0c1BhcnRpY2xlcyx0cnVlLFwidHNwYXJ0aWNsZXNcIik7XHJcblxyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCAoKSA9PiB7XHJcblxyXG5cclxuZ2V0VXNlck9yZ2FuaXNhdGlvblNldHRpbmcoKTtcclxufSk7XHJcblxyXG5mdW5jdGlvbiBnZXRVc2VyT3JnYW5pc2F0aW9uU2V0dGluZygpIHtcclxuXHJcbiAgICAvL2dldCBib2R5IGFuZCBtYWtlIGl0IGJsdXJlZFxyXG4gICBcclxuXHJcblxyXG4gICAgaWYgKCEkdWkucGFnZUNvbnRleHQudXNlcikge1xyXG4gICAgICAgIC8vd2FpdCBmb3IgdGhlIHVzZXIgdG8gYmUgbG9hZGVkXHJcbiAgICAgICAgbGV0IHVzZXJMb2FkZWQgPSBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJyZXRyeS4uLlwiKVxyXG4gICAgICAgICAgICBnZXRVc2VyT3JnYW5pc2F0aW9uU2V0dGluZygpO1xyXG4gICAgICAgIH0sIDEpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBsZXQgY3VycmVudFVzZXJPZHNJZCA9ICR1aS5wYWdlQ29udGV4dC51c2VyLnVzZXJpZCgpO1xyXG4gICAgY29uc29sZS5sb2coXCJjdXJyZW50VXNlck9kc0lkXCIsIGN1cnJlbnRVc2VyT2RzSWQpO1xyXG5cclxuICAgIGV4ZWN1dGVHZXQ8YW55PihgL2FwaS9vZHMvdGVhbXMvcGVyc29uLyR7Y3VycmVudFVzZXJPZHNJZH0vcHJpbWFyeVRlYW1gKS50aGVuKGFzeW5jIChyKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5sb2coYC9hcGkvb2RzL3RlYW1zL3BlcnNvbi8ke2N1cnJlbnRVc2VyT2RzSWR9L3ByaW1hcnlUZWFtYCwgcik7XHJcblxyXG4gICAgICAgIGxldCBwcmltYXJ5VGVhbSA9IHIucHJpbWFyeVRlYW07XHJcbiAgICAgICAgbGV0IG9yZ2FuaXNhdGlvbklkID0gcHJpbWFyeVRlYW0ub3JnYW5pc2F0aW9uSWQ7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJvcmdhbmlzYXRpb25JZFwiLCBvcmdhbmlzYXRpb25JZCk7XHJcblxyXG4gICAgICAgIGxldCBwYXJlbnRUZWFtSWQgPSBwcmltYXJ5VGVhbS5wYXJlbnRUZWFtSWQ7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJwYXJlbnRUZWFtSWRcIiwgcGFyZW50VGVhbUlkKTtcclxuXHJcbiAgICAgICAgbGV0IHRlYW1JZCA9IHByaW1hcnlUZWFtLmlkO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwidGVhbUlkXCIsIHRlYW1JZCk7XHJcblxyXG4gICAgICAgIGxldCBwYXlMb2FkID0ge1xyXG4gICAgICAgICAgICBcInNlYXJjaFwiOiB7XHJcbiAgICAgICAgICAgICAgICBcInBhZ2VcIjoge1xyXG4gICAgICAgICAgICAgICAgICAgIFwicGFnZVwiOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgIFwicm93c1BlclBhZ2VcIjogMjBcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBcInNvcnRcIjoge1xyXG4gICAgICAgICAgICAgICAgICAgIFwiZGlyZWN0aW9uXCI6IFwiYXNjZW5kaW5nXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgXCJvcmRlckJ5XCI6IFwidGl0bGVcIlxyXG4gICAgICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAgICAgICBcInR5cGVzXCI6IHtcclxuICAgICAgICAgICAgICAgICAgICBcImluY2x1ZGVUeXBlc0Rlcml2ZWRGcm9tXCI6IFtcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJpbW1lcnNpb24tb3JnYW5pemF0aW9uXCJcclxuICAgICAgICAgICAgICAgICAgICBdXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgXCJyb2xlc1wiOiBbXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBcInJvbGVcIjogXCJpbW1lcnNpb24tcmVsYXRlZC10b1wiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcInN1YmplY3RJZHNIb2xkaW5nUm9sZVwiOiBbdGVhbUlkXVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIF1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgXCJlbnJpY2hcIjogW1xyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIFwicGF0aFwiOiBcInRpdGxlXCJcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgXCJwYXRoXCI6IFwicmVmZXJlbmNlXCJcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgXCJwYXRoXCI6IFwiZm9ybS1pbW1lcnNpb24tb3JnYW5pc2F0aW9uLm9yZ2FuaXphdGlvblRoZW1lU3lzdGVtTmFtZVwiXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIF1cclxuICAgICAgICB9O1xyXG5cclxuXHJcbiAgICAgICAgZXhlY3V0ZVBvc3Q8YW55PihcIi9hcGkvdjEvcHVibGljL3dvcmtJdGVtL2ZpbmRCeVF1ZXJ5XCIsIHBheUxvYWQpLnRoZW4oYXN5bmMgKGZpbmRSZXN1bHQpID0+IHtcclxuXHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiL2FwaS92MS9wdWJsaWMvd29ya0l0ZW0vZmluZEJ5UXVlcnlcIiwgZmluZFJlc3VsdCk7XHJcblxyXG4gICAgICAgICAgICBpZiAoIWZpbmRSZXN1bHQgfHwgIWZpbmRSZXN1bHQucmVzdWx0cyB8fCAhZmluZFJlc3VsdC5yZXN1bHRzWzBdKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImZpbmRCeVF1ZXJ5OiBOb3RoaW5nIEZvdW5kXCIpXHJcbiAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBsZXQgZGF0YSA9IGZpbmRSZXN1bHQucmVzdWx0c1swXTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJmaW5kQnlRdWVyeTogZGF0YVwiLCBkYXRhKTtcclxuICAgICAgICAgICAgaWYoIWRhdGEuZGF0YSl7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImZpbmRCeVF1ZXJ5OiBObyBEYXRhXCIpXHJcbiAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGxldCB0aGVtZSA9IGRhdGEuZGF0YVtcImZvcm0taW1tZXJzaW9uLW9yZ2FuaXNhdGlvbi5vcmdhbml6YXRpb25UaGVtZVN5c3RlbU5hbWVcIl1cclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJmb3JtLWltbWVyc2lvbi1vcmdhbmlzYXRpb24ub3JnYW5pemF0aW9uVGhlbWVTeXN0ZW1OYW1lXCIsIHRoZW1lKVxyXG4gICAgICAgICAgICBpZiAoIXRoZW1lIHx8IHRoZW1lID09IFwiXCIpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiTm8gVGhlbWVcIilcclxuICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbG9hZExvZ28odGhlbWUpO1xyXG4gICAgICAgICAgICBhd2FpdCBhcHBseU9yZ2FuaXNhdGlvblRoZW1lKHRoZW1lKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vYWRkIGNsYXNzIGxvYWRlZCB0byBib2R5XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIH0pLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgICAgICBmYWRlSW5Mb2dvKCk7XHJcbiAgICAgICAgfSlcclxuICAgIH0pLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgIFxyXG4gICAgfSkuY2F0Y2goKGUpID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIkVycm9yXCIsIGUpO1xyXG4gICAgICAgIGZhZGVJbkxvZ28oKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5cclxuXHJcbmZ1bmN0aW9uIGZhZGVJbkxvZ28oKSB7XHJcbiAgICBoaWRkZW5FbGVtZW50IS5jbGFzc0xpc3QuYWRkKFwibG9hZGVkXCIpO1xyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBhcHBseU9yZ2FuaXNhdGlvblRoZW1lKHRoZW1lVG9TZXQ6IHN0cmluZykge1xyXG4gICBcclxuICAgIGNvbnNvbGUubG9nKFwiYXBwbHlPcmdhbmlzYXRpb25UaGVtZSgpLi4uLlwiKTtcclxuICAgIGV4ZWN1dGVHZXQ8YW55PihgL2FwaS90aGVtZXMvYnlTeXN0ZW1OYW1lLyR7dGhlbWVUb1NldH1gKS50aGVuKChyKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5sb2coYC9hcGkvdGhlbWVzL2J5U3lzdGVtTmFtZS8ke3RoZW1lVG9TZXR9YCwgcik7XHJcbiAgICAgICAgbGV0IHRTZXR0aW5ncyA9IEpTT04ucGFyc2Uoci5qc29uQ29uZmlnKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhcInIuanNvbkNvbmZpZ1wiLCB0U2V0dGluZ3MpO1xyXG4gICAgICAgIHRTZXR0aW5ncy5zZXR0aW5ncy5mb3JFYWNoKChzOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgaWYgKHMudHlwZSA9PSBcImNzcy12YXJcIikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJjc3MtdmFyXCIsIHMpO1xyXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLnNldFByb3BlcnR5KFwiLS1cIiArIHMua2V5LCBzLnZhbHVlKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKHMudHlwZSA9PSBcImRhdGEtYXR0clwiKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImRhdGEtYXR0clwiLCBzKTtcclxuICAgICAgICAgICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJkYXRhLXRoZW1lLVwiICsgcy5rZXksIHMudmFsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiLi4uRG9uZS4uLlwiKVxyXG5cclxuICAgIH0pXHJcbn1cclxuYXN5bmMgZnVuY3Rpb24gbG9hZExvZ28odGhlbWVUb1NldDogc3RyaW5nKSB7XHJcbiAgICBsZXQgbG9nb1dpZGdldCA9ICR1aS53aWRnZXRzLmluc3RhbmNlcygpLmZpbmQoKHc6IGFueSkgPT4gdy5iYXNlLnN5c3RlbU5hbWUgPT0gXCJTaGFyZWRvLkNvcmUuQ2FzZS5XaWRnZXRzLkxvZ29cIik7XHJcbiAgICBjb25zb2xlLmxvZyhcIlNoYXJlZG8uQ29yZS5DYXNlLldpZGdldHMuTG9nb1wiLCBsb2dvV2lkZ2V0KTtcclxuICAgIGNvbnNvbGUubG9nKFwicG9ydGFsQnJhbmRMb2dvVXJsIDwtLSBcIiwgYC90aGVtZXMvJHt0aGVtZVRvU2V0fS9pbWFnZXMvcG9ydGFsLWJyYW5kLWxvZ29gKTtcclxuICAgICR1aS5wYWdlQ29udGV4dC5wb3J0YWxCcmFuZExvZ29VcmwoYC90aGVtZXMvJHt0aGVtZVRvU2V0fS9pbWFnZXMvcG9ydGFsLWJyYW5kLWxvZ29gKTtcclxuXHJcbiAgICBjb25zb2xlLmxvZyhcIiR1aS53aWRnZXRzLmNyZWF0ZShTaGFyZWRvLkNvcmUuQ2FzZS5XaWRnZXRzLkxvZ28pXCIpO1xyXG4gICAgJHVpLndpZGdldHMuY3JlYXRlKFwiU2hhcmVkby5Db3JlLkNhc2UuV2lkZ2V0cy5Mb2dvXCIsIGxvZ29XaWRnZXQuYmFzZS5pZCwge1xyXG4gICAgICAgIFwiZGVmYXVsdExvZ29cIjogXCIvdGhlbWUvaW1hZ2VzL2xvZ28ucG5nXCJcclxuICAgIH0sXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBcImlkXCI6IGxvZ29XaWRnZXQuYmFzZS5pZCxcclxuICAgICAgICAgICAgXCJzeXN0ZW1OYW1lXCI6IFwiU2hhcmVkby5Db3JlLkNhc2UuV2lkZ2V0cy5Mb2dvXCIsXHJcbiAgICAgICAgICAgIFwiY2FuRXhwYW5kQ29sbGFwc2VcIjogdHJ1ZSxcclxuICAgICAgICAgICAgXCJpc0V4cGFuZGVkXCI6IHRydWUsXHJcbiAgICAgICAgICAgIFwiaWNvblwiOiBudWxsLFxyXG4gICAgICAgICAgICBcInRpdGxlXCI6IFwiTG9nb1wiLFxyXG4gICAgICAgICAgICBcImhlbHBUZXh0XCI6IG51bGxcclxuICAgICAgICB9KTtcclxufVxyXG5cclxuIl0sIm5hbWVzIjpbIl9fd2VicGFja19yZXF1aXJlX18iLCJleHBvcnRzIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsInZhbHVlIiwiZXhlY3V0ZUdldCIsImFwaSIsImV4ZWN1dGVGZXRjaCIsInVuZGVmaW5lZCIsIm1ldGhvZCIsImRhdGEiLCJ1cmwiLCJsb2NhdGlvbiIsIndpbmRvdyIsImRvY3VtZW50Iiwib3JpZ2luIiwiaW5kZXhPZiIsInZhbGlkYXRlQXBpIiwiZmV0Y2hIZWFkZXJzIiwiYmVhcmVyIiwidG9rZW4iLCJyZXRWYWx1ZSIsImNvb2tpZSIsInNwbGl0IiwicmVkdWNlIiwiY29va2llcyIsInBhcnRzIiwibGVuZ3RoIiwia2V5IiwidHJpbSIsImdldENvb2tpZXMiLCJIZWFkZXJzIiwiYXBwZW5kIiwiYnVpbGRIZWFkZXJzIiwiZmV0Y2giLCJoZWFkZXJzIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJ0aGVuIiwicmVzcG9uc2UiLCJjb25zb2xlIiwibG9nIiwiZ2V0IiwiRXJyb3IiLCJqc29uIiwiaGlkZGVuRWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJnZXRVc2VyT3JnYW5pc2F0aW9uU2V0dGluZyIsIiR1aSIsInBhZ2VDb250ZXh0IiwidXNlciIsInNldFRpbWVvdXQiLCJjdXJyZW50VXNlck9kc0lkIiwidXNlcmlkIiwiciIsInByaW1hcnlUZWFtIiwib3JnYW5pc2F0aW9uSWQiLCJwYXJlbnRUZWFtSWQiLCJ0ZWFtSWQiLCJpZCIsInBvc3RCb2R5IiwiZXhlY3V0ZVBvc3QiLCJmaW5kUmVzdWx0IiwicmVzdWx0cyIsInRoZW1lIiwidGhlbWVUb1NldCIsImxvZ29XaWRnZXQiLCJ3aWRnZXRzIiwiaW5zdGFuY2VzIiwiZmluZCIsInciLCJiYXNlIiwic3lzdGVtTmFtZSIsInBvcnRhbEJyYW5kTG9nb1VybCIsImNyZWF0ZSIsImxvYWRMb2dvIiwidFNldHRpbmdzIiwicGFyc2UiLCJqc29uQ29uZmlnIiwic2V0dGluZ3MiLCJmb3JFYWNoIiwicyIsInR5cGUiLCJkb2N1bWVudEVsZW1lbnQiLCJzdHlsZSIsInNldFByb3BlcnR5Iiwic2V0QXR0cmlidXRlIiwiYXBwbHlPcmdhbmlzYXRpb25UaGVtZSIsImZpbmFsbHkiLCJmYWRlSW5Mb2dvIiwiY2F0Y2giLCJlIiwiY2xhc3NMaXN0IiwiYWRkIiwiYWRkRXZlbnRMaXN0ZW5lciJdLCJzb3VyY2VSb290IjoiIn0=