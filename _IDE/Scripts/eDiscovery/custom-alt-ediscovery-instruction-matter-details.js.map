{"version":3,"file":"custom-alt-ediscovery-instruction-matter-details.js","names":["runMe","_x","_runMe","apply","arguments","_asyncToGenerator","context","expertMatterNumber","matterDetails","pipelineMatter","createVariables","window","tester","hideShowMatterDetails","addEventHandlers","fields","enumFields","jurisdiction","jurisdictionsCountry","on","ev","updateMatterDetails","setMatterDetailsState","getValue","status","length","undefined","children","forEach","child","options","readonly","refresh","childrenByPropertyId","enumMatterDetailFields","matterDetailsPartnerSelector","hidden","matterDetailsPartnerName","clearMatterDetails","_x2","_clearMatterDetails","setValue","_x3","_x4","_x5","_updateMatterDetails","data","getMatterData","selectedMatter","find","matter","concat","matterCode","client","name","tempMatterNumber","parent","matterDetailsClientName","matterDetailsClientCode","code","matterDetailsPracticeArea","practiceArea","matterDetailsName","shortName","partner","matterDetailsIb","secure","console","log","isValid","_getMatterData","$ajax","get","document","location","origin"],"sources":["../../../src/Scripts/eDiscovery/custom-alt-ediscovery-instruction-matter-details.ts"],"sourcesContent":["import { FormBuilderField } from \"../../Typings/FormBuilder/IAlpacaForm\";\nimport { IFormBuilderContext } from \"../../Typings/FormBuilder/IFormBuilderContext\";\nimport { IExpertMatter } from \"./IExpertMatterData\";\n\n//This function is called from the module-loader webcomponent in the form builder\nexport async function runMe(context: IFormBuilderContext) {    \n    let { expertMatterNumber, matterDetails, pipelineMatter } = createVariables(context);\n    (window as any).tester = context; //just for debugging\n    hideShowMatterDetails(matterDetails, expertMatterNumber, pipelineMatter);\n    //add a change event to the expert-matter-number\n    addEventHandlers(context, matterDetails, expertMatterNumber, pipelineMatter);\n}\n\n// This function creates variables for the form.\nfunction createVariables(context: IFormBuilderContext) {\n    // Get the fields\n    let matterDetails = context.fields[enumFields.matterDetails];\n    let expertMatterNumber = context.fields[enumFields.expertMatterNumber];\n    let pipelineMatter = context.fields[enumFields.pipelineMatter];\n    let jurisdiction = context.fields[enumFields.jurisdictionsCountry];\n\n    // Return the variables\n    return { expertMatterNumber, matterDetails, pipelineMatter };\n}\n\nfunction addEventHandlers(context: IFormBuilderContext, matterDetails: FormBuilderField, expertMatterNumber: FormBuilderField, pipelineMatter: FormBuilderField) {\n    context.fields[enumFields.expertMatterNumber].on(\"change\", function (this: any, ev: any) {\n\n        // hide or show the matter details field\n        hideShowMatterDetails(matterDetails, expertMatterNumber, pipelineMatter);\n\n        // update the matter details field\n        updateMatterDetails(matterDetails, expertMatterNumber, pipelineMatter);\n    });\n\n    //add event handlet for pipeline-matter changed\n    context.fields[\"pipeline-matter\"].on(\"change\", function (this: any, ev: any) {\n\n        // hide or show the matter details field\n        hideShowMatterDetails(matterDetails, expertMatterNumber, pipelineMatter);\n\n        // update the matter details field\n        updateMatterDetails(matterDetails, expertMatterNumber, pipelineMatter);\n    });\n}\n\nfunction hideShowMatterDetails(matterDetails: FormBuilderField, expertMatterNumber: FormBuilderField, pipelineMatter: FormBuilderField) {\n        setMatterDetailsState(matterDetails,pipelineMatter.getValue());    \n}\n\n// make all child properties readonly\nfunction setMatterDetailsState(matterDetails: FormBuilderField, status: boolean = true) {\n    // get all the child properties\n    matterDetails.children.forEach(function (child: any) {\n        // set the readonly status of the child property\n        child.options.readonly = !status;\n        // refresh the child property\n        child.refresh();\n    });\n\n    // show/hide the partner name and selector\n    matterDetails.childrenByPropertyId[enumMatterDetailFields.matterDetailsPartnerSelector].options.hidden = !status;\n    matterDetails.childrenByPropertyId[enumMatterDetailFields.matterDetailsPartnerName].options.hidden = status;    \n    matterDetails.childrenByPropertyId[enumMatterDetailFields.matterDetailsPartnerName].refresh();\n    matterDetails.childrenByPropertyId[enumMatterDetailFields.matterDetailsPartnerSelector].refresh();\n}\n\n\nasync function clearMatterDetails(matterDetails: FormBuilderField) {\n    matterDetails.children.forEach(function (child: any) {\n        child.setValue(\"-\");\n    });\n}\n\n/* Here is the explanation for the code above:\n1. We first get the data from the endpoint by calling getMatterData() function\n2. Then we clear the matterDetails\n3. We find the selected matter by using the matter code and client name from the data we got from the endpoint\n4. If the matter is undefined, we clear the matterDetails and return\n5. If the matter is not undefined, we set the values of the matterDetails fields */\nasync function updateMatterDetails(matterDetails: FormBuilderField, expertMatterNumber: FormBuilderField,pipelineMatter:FormBuilderField) {\n    \nlet data = await getMatterData();\n\n    clearMatterDetails(matterDetails); //clear the matter details form\n\n    let selectedMatter = data.find(function (matter: any) {\n        return expertMatterNumber.getValue() === `${matter.data.matterCode} - ${matter.data.client.name}`;\n    });\n \n    if(selectedMatter === undefined || pipelineMatter.getValue() === true) { //if the matter is not found or if the matter is a pipeline matter, clear the matter details form and return\n        clearMatterDetails(matterDetails);\n        return;\n    }\n    \n    let tempMatterNumber = matterDetails.parent.childrenByPropertyId['temp-matter-number'].getValue();\n\n    if(tempMatterNumber === undefined || tempMatterNumber.length === 0 )\n    {\n        matterDetails.parent.childrenByPropertyId['temp-matter-number'].setValue(\"N/A\");\n    }\n\n    matterDetails.childrenByPropertyId[enumMatterDetailFields.matterDetailsClientName].setValue(selectedMatter.data.client.name);\n    matterDetails.childrenByPropertyId[enumMatterDetailFields.matterDetailsClientCode].setValue(selectedMatter.data.client.code);\n    matterDetails.childrenByPropertyId[enumMatterDetailFields.matterDetailsPracticeArea].setValue(selectedMatter.data.practiceArea.name);\n    matterDetails.childrenByPropertyId[enumMatterDetailFields.matterDetailsName].setValue(selectedMatter.data.shortName);\n    matterDetails.childrenByPropertyId[enumMatterDetailFields.matterDetailsPartnerName].setValue(selectedMatter.data.partner.name);\n    matterDetails.childrenByPropertyId[enumMatterDetailFields.matterDetailsIb].setValue(selectedMatter.data.secure);\n\n    console.log(\"matterDetails.isValid():\" + matterDetails.isValid());\n\n    \n}\n\nasync function getMatterData() {\n    //get the data from the server without cache\n    return await $ajax.get(window.document.location.origin +  \"/_ideFiles/SampleData/eDiscovery/matters.json\") as IExpertMatter[];\n}\n\n\nexport enum enumFields {\n    customAltEdiscoveryInstructionMatterDetails = \"custom-alt-ediscovery-instruction-matter-details\" ,\n    jurisdictionsCountry = \"jurisdictions-country\" ,\n    pipelineMatter = \"pipeline-matter\" ,\n    expertMatterNumber = \"expert-matter-number\" ,\n    tempMatterNumber = \"temp-matter-number\" ,\n    subMatterCode = \"sub-matter-code\" ,\n    abcMatterNumber = \"abc-matter-number\" ,\n    matterDetails = \"matter-details\" \n }\n\nexport enum enumMatterDetailFields {\n    matterDetailsPartnerSelector = \"matter-details-partner-selector\" ,\n    matterDetailsPartnerName = \"matter-details-partner-name\" ,\n    matterDetailsClientName = \"matter-details-client-name\" ,\n    matterDetailsClientCode = \"matter-details-client-code\" ,\n    matterDetailsPracticeArea = \"matter-details-practice-area\" ,\n    matterDetailsName = \"matter-details-name\" ,\n    matterDetailsIb = \"matter-details-ib\"\n}\n\n\n"],"mappings":"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"}