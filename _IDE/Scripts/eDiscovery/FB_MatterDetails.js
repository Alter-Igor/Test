(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{enumFields:()=>v,enumMatterDetailFields:()=>p,runMe:()=>s});var n=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{d(o.next(e))}catch(e){i(e)}}function l(e){try{d(o.throw(e))}catch(e){i(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}d((o=o.apply(e,t||[])).next())}))};function o(e,t,o){return n(this,void 0,void 0,(function*(){let n=function(e){let t=window.document.location.origin;return-1===e.indexOf(t)&&(0!==e.indexOf("/")&&(e="/"+e),e=t+e),e}(e),r=function(){let e=(n=function(){let e={};return document.cookie.split(";").reduce((function(t,n){var o=n.split("=");if(2===o.length){var r=o[0].trim(),i=o[1];e[r]=i}return t}),{}),e}()._api)?"Bearer "+n:null,t=new Headers;var n;return t.append("Content-Type","application/json"),e&&t.append("Authorization",e),t}();return yield fetch(n,{method:t,headers:r,body:o?JSON.stringify(o):void 0}).then((e=>{var t;if(console.log(e),-1===(null===(t=e.headers.get("content-type"))||void 0===t?void 0:t.indexOf("application/json")))throw new Error("Response was not JSON");return e.json()}))}))}var r=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{d(o.next(e))}catch(e){i(e)}}function l(e){try{d(o.throw(e))}catch(e){i(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}d((o=o.apply(e,t||[])).next())}))};var i=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{d(o.next(e))}catch(e){i(e)}}function l(e){try{d(o.throw(e))}catch(e){i(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}d((o=o.apply(e,t||[])).next())}))};function a(e,t){let n={roleConfig:[],ODSEntities:[]};if(!e)return n;let o=function(e){if(!e)return;let t=Sharedo.Core.Case.Aspects.Widgets.OdsEntityPicker;return e.aspects().filter((e=>e.widget instanceof t))}(e);return null==o||o.forEach((e=>{e.widget.odsEntities().forEach((e=>{e.roleSystemName&&e.roleSystemName()===t&&n.ODSEntities.push(e)})),e.widget.options.roleConfigModels.forEach((e=>{e.roleSystemName===t&&n.roleConfig.push(e)}))})),n}function l(e,t){return i(this,void 0,void 0,(function*(){let e=yield function(e){return r(this,void 0,void 0,(function*(){try{let t="/api/ods/_search";return yield function(e,t){return n(this,void 0,void 0,(function*(){return o(e,"POST",t)}))}(window.document.location.origin+t,e)}catch(t){console.warn("ODS Search Error",t,e)}}))}(t);return console.log("%c ODS Search Result","color: #ff0000",e),e?(console.log("%c ODS Search Result","color: #ff0000",e),function(e){try{return e.rows.map((e=>JSON.parse(e.result)))}catch(t){console.warn("ODS Helper Error trying to extract rows from search result",t,e)}return[]}(e)):(console.log("%c ODS Search Result - undefined","color: #ff0000"),[])}))}var d=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{d(o.next(e))}catch(e){i(e)}}function l(e){try{d(o.throw(e))}catch(e){i(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}d((o=o.apply(e,t||[])).next())}))};const u="matter-partner",c="client";function s(e){var t,n,o,r;let{expertMatterNumber:i,matterDetails:a,pipelineMatter:l}=function(e){if(!e.form)throw new Error("No form");let t=e.form.fieldsById[v.matterDetails];return{expertMatterNumber:e.form.fieldsById[v.expertMatterNumber],matterDetails:t,pipelineMatter:e.form.fieldsById[v.pipelineMatter]}}(e);if(!i)throw new Error("No expertMatterNumber");if(!a)throw new Error("No matterDetails");if(!l)throw new Error("No pipelineMatter");if(window.tester=e,void 0!==e.workItemContext.id()){let i=!0;if(!(null===(n=null===(t=e.workItemContext)||void 0===t?void 0:t.phaseName())||void 0===n?void 0:n.toLowerCase().includes("draft"))&&(null===(o=e.workItemContext)||void 0===o?void 0:o.phaseName())||(i=!1),!0===i)return console.log("%c [ModuleLoader] FB_MatterDetails - exit (only run on new)","background: #222; color: #bada55",e.workItemContext.id()),console.log("%c [ModuleLoader] context.workItemContext.id() ","background: #222; color: #bada55",e.workItemContext.id()),console.log("%c [ModuleLoader] context.workItemContext?.phaseName() ","background: #222; color: #bada55",null===(r=e.workItemContext)||void 0===r?void 0:r.phaseName()),!0}return window.aspectDebuger=window.aspectDebuger||{},window.aspectDebuger.matterDetailsFormBuilder=a,f(a,0,l),function(e,t,n,o){var r,i,a,l;if(!e.form)throw new Error("No form");null===(r=t.fieldsById[p.matterDetailsPartnerName])||void 0===r||r.on("change",(function(e){var n;console.log("%c Partner name changed to: "+(null===(n=t.fieldsById[p.matterDetailsPartnerName])||void 0===n?void 0:n.getValue()),"color: pink; font-size: 20px;")})),null===(i=e.form.fieldsById[v.expertMatterNumber])||void 0===i||i.on("change",(function(r){f(t,0,o),m(e,t,n,o)})),null===(a=e.form.fieldsById[v.pipelineMatter])||void 0===a||a.on("change",(function(r){f(t,0,o),m(e,t,n,o)})),null===(l=e.form.fieldsById[v.jurisdictionsCountry])||void 0===l||l.on("change",(function(t){var n,o,r,i;return d(this,void 0,void 0,(function*(){let t=null===(o=null===(n=e.form)||void 0===n?void 0:n.fieldsById["jurisdictions-country"])||void 0===o?void 0:o.getValue();console.log("%c Jurisdiction changed to: "+(null===(i=null===(r=e.form)||void 0===r?void 0:r.fieldsById["jurisdictions-country"])||void 0===i?void 0:i.getValue()),"color: red; font-size: 20px;");let a=e.getAspect("Sharedo.Core.Legal.Aspects.Widgets.InstructionWorkTypeDetails"),l=yield $ajax.get(`/api/v1/public/modeller/optionSets/allValues/${t}`);if(!l)return void console.log("%c [ModuleLoader] getAspect return value","background: #222; color: #bada55",l);let d=(yield $ajax.get("/api/v1/public/modeller/optionSets/jurisdictions/values")).find((e=>e.name===l.name));d?a.widget.instruction.jurisdictionId(d.id):console.log("%c [ModuleLoader] getAspect return value","background: #222; color: #bada55",d)}))}))}(e,a,i,l),function(e){var t,n;let o=new Date,r=`T${o.getFullYear()}${o.getMonth()+1}${o.getDate()}${o.getHours()}${o.getMinutes()}${o.getSeconds()}${o.getMilliseconds()}`;null===(n=null===(t=e.form)||void 0===t?void 0:t.fieldsById[v.tempMatterNumber])||void 0===n||n.setValue(r)}(e),$ui.events.broadcast("script.matterDetailsLoaded",e),!0}function f(e,t,n){!function(e,t=!0){var n;if(!e.fields)throw new Error("No fields");if(!e.fieldsById)throw new Error("No fieldsById");e.fields.forEach((e=>{e.readonly(!t)})),null===(n=e.fieldsById[p.matterDetailsIbLastChecked])||void 0===n||n.hidden(!0)}(e,n.getValue())}function m(e,t,r,s){var f,m,g,y,h,w,b,D,x,N,M,S,I,C,E,O,P,B,k;return d(this,void 0,void 0,(function*(){let V=yield function(e){return d(this,void 0,void 0,(function*(){let t=[];if(void 0===e||0===e.length)return t;try{let r=yield function(e){return n(this,void 0,void 0,(function*(){return o(e,"GET",void 0)}))}(`/api/externalMatterProvider/details/${e}`);if(console.log("%c [ModuleLoader] getMatterData return value","background: #222; color: #bada55",r),r&&r.matterCode){let e={data:r};t.push(e)}}catch(e){console.log("Failed to get matter data from server",e)}return t}))}(r.getValue());console.log(V);let j=V.find((function(e){return r.getValue()===e.data.matterCode}));if(void 0===j||!0===s.getValue())return void function(e){var t;d(this,void 0,void 0,(function*(){null===(t=e.fields)||void 0===t||t.forEach((function(e){e.setValue("")}))}))}(t);if(!(null===(f=t.parent)||void 0===f?void 0:f.fieldsById))throw new Error("No client");let A=null===(g=null===(m=t.parent)||void 0===m?void 0:m.fieldsById["temp-matter-number"])||void 0===g?void 0:g.getValue();void 0===A||A.length,null===(h=null===(y=e.form)||void 0===y?void 0:y.fieldsById[v.expertMatterNumberValue])||void 0===h||h.setValue((null===(w=null==j?void 0:j.data)||void 0===w?void 0:w.matterCode)||""),null===(b=t.fieldsById[p.matterDetailsClientName])||void 0===b||b.setValue((null===(x=null===(D=null==j?void 0:j.data)||void 0===D?void 0:D.client)||void 0===x?void 0:x.name)||""),null===(N=t.fieldsById[p.matterDetailsClientCode])||void 0===N||N.setValue((null===(S=null===(M=null==j?void 0:j.data)||void 0===M?void 0:M.client)||void 0===S?void 0:S.code)||""),null===(I=t.fieldsById[p.matterDetailsName])||void 0===I||I.setValue((null===(C=null==j?void 0:j.data)||void 0===C?void 0:C.shortName)||""),null===(E=t.fieldsById[p.matterDetailsPartnerName])||void 0===E||E.setValue((null===(P=null===(O=null==j?void 0:j.data)||void 0===O?void 0:O.partner)||void 0===P?void 0:P.name)||""),null===(B=t.fieldsById[p.matterDetailsIb])||void 0===B||B.setValue((null===(k=null==j?void 0:j.data)||void 0===k?void 0:k.secure)||""),console.log("matterDetails.isValid():"+t.isValid());try{!function(e,t){(function(e){return i(this,void 0,void 0,(function*(){return l(0,{startPage:1,endPage:1,rowsPerPage:10,searchString:e,odsEntityTypes:[],availability:{isAvailable:null,isOutOfOffice:null,isNotAvailable:null},location:{postcode:null,range:10},connection:{systemName:null},competencies:[],teams:[],roles:[],odsTypes:["client"],wallManagement:!1})}))})(e.data.client.code).then((e=>{let n=e[0];console.log("%c Found Client name : "+(null==n?void 0:n.name),"color: pink; font-size: 20px;",e);let o=function(e){return a(e.blade,c)}(t),r=o.roleConfig[0],i=o.ODSEntities[0];if(!r||!i)return;if(!n)return void i.selected(!1);let l=r.addService.createSelectedEntityModel(n.id,"organisation",n.name);r.addService.selectedEntity(l)}))}(j,e)}catch(e){console.log("Failed to auto updating ods pickers, user required to select manually")}try{!function(e,t){e.data.partner.name.split(",")[0],function(e){return i(this,void 0,void 0,(function*(){return l(0,{startPage:1,endPage:1,rowsPerPage:10,searchString:e,odsEntityTypes:[],availability:{isAvailable:null,isOutOfOffice:null,isNotAvailable:null},location:{postcode:null,range:10},connection:{systemName:null},competencies:[],teams:[],roles:[],odsTypes:["acl","alt-ediscovery-user-type","client","department","document-training-type","employee","expert","external-team","external","pod","structural","system-administrator"],wallManagement:!1})}))}(e.data.partner.email).then((e=>{let n=e[0];console.log("%c Partner name changed to: "+(null==n?void 0:n.id),"color: pink; font-size: 20px;",n);let o=function(e){return a(e.blade,u)}(t),r=o.roleConfig[0],i=o.ODSEntities[0];if(!r||!i)return;if(!n)return void i.selected(!1);let l=r.addService.createSelectedEntityModel(n.id,"user",n.firstName+" "+n.surname);r.addService.selectedEntity(l)}))}(j,e)}catch(e){console.log("Failed to auto updating ods pickers, user required to select manually")}}))}var v,p;!function(e){e.customAltEdiscoveryInstructionMatterDetails="custom-alt-ediscovery-instruction-matter-details",e.jurisdictionsCountry="jurisdictions-country",e.pipelineMatter="pipeline-matter",e.expertMatterNumber="expert-matter-number",e.expertMatterNumberValue="expert-matter-number-value",e.tempMatterNumber="temp-matter-number",e.subMatterCode="sub-matter-code",e.abcMatterNumber="abc-matter-number",e.matterDetails="matter-details"}(v||(v={})),function(e){e.matterDetailsPartnerSelector="matter-details-partner-selector",e.matterDetailsPartnerName="matter-details-partner-name",e.matterDetailsClientName="matter-details-client-name",e.matterDetailsClientCode="matter-details-client-code",e.matterDetailsPracticeArea="matter-details-practice-area",e.matterDetailsName="matter-details-name",e.matterDetailsIb="matter-details-ib",e.matterDetailsIbLastChecked="matter-details-ib-last-check"}(p||(p={})),window.FB_MatterDetails=t})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRkJfTWF0dGVyRGV0YWlscy5qcyIsIm1hcHBpbmdzIjoibUJBQ0EsSUFBSUEsRUFBc0IsQ0NBMUJBLEVBQXdCLENBQUNDLEVBQVNDLEtBQ2pDLElBQUksSUFBSUMsS0FBT0QsRUFDWEYsRUFBb0JJLEVBQUVGLEVBQVlDLEtBQVNILEVBQW9CSSxFQUFFSCxFQUFTRSxJQUM1RUUsT0FBT0MsZUFBZUwsRUFBU0UsRUFBSyxDQUFFSSxZQUFZLEVBQU1DLElBQUtOLEVBQVdDLElBRTFFLEVDTkRILEVBQXdCLENBQUNTLEVBQUtDLElBQVVMLE9BQU9NLFVBQVVDLGVBQWVDLEtBQUtKLEVBQUtDLEdDQ2xGVixFQUF5QkMsSUFDSCxvQkFBWGEsUUFBMEJBLE9BQU9DLGFBQzFDVixPQUFPQyxlQUFlTCxFQUFTYSxPQUFPQyxZQUFhLENBQUVDLE1BQU8sV0FFN0RYLE9BQU9DLGVBQWVMLEVBQVMsYUFBYyxDQUFFZSxPQUFPLEdBQU8sRyx5WEM2Q3ZELFNBQWVDLEVBQWdCQyxFQUFhQyxFQUFjQyxHLHlDQUM3RCxJQUFJQyxFQWpCUixTQUFxQkgsR0FDbEIsSUFBSUksRUFBV0MsT0FBT0MsU0FBU0YsU0FBU0csT0FXdkMsT0FSOEIsSUFBM0JQLEVBQUlRLFFBQVFKLEtBRWEsSUFBckJKLEVBQUlRLFFBQVEsT0FDWFIsRUFBTSxJQUFNQSxHQUdoQkEsRUFBTUksRUFBV0osR0FFZEEsQ0FFWCxDQUdjUyxDQUFZVCxHQUNsQlUsRUFtQlIsV0FDSSxJQUFJQyxHQWdDQUMsRUF0QkQsV0FFSCxJQUFJQyxFQUFvQyxDQUFDLEVBY3pDLE9BYmNQLFNBQVNRLE9BQU9DLE1BQU0sS0FBS0MsUUFBTyxTQUFVQyxFQUFTSCxHQUUvRCxJQUFJSSxFQUFRSixFQUFPQyxNQUFNLEtBQ3pCLEdBQXFCLElBQWpCRyxFQUFNQyxPQUNWLENBQ0ksSUFBSWxDLEVBQU1pQyxFQUFNLEdBQUdFLE9BQ2Z0QixFQUFRb0IsRUFBTSxHQUVsQkwsRUFBUzVCLEdBQU9hLEMsQ0FFcEIsT0FBT21CLENBQ1gsR0FBRyxDQUFDLEdBRUdKLENBQ1gsQ0FJa0JRLEdBQ1ksTUFFUCxVQUFZVCxFQUN4QixLQWxDSEYsRUFBZSxJQUFJWSxRQTRCcEIsSUFHQ1YsRUExQkosT0FKQUYsRUFBYWEsT0FBTyxlQUFnQixvQkFDaENaLEdBQ0FELEVBQWFhLE9BQU8sZ0JBQWlCWixHQUVsQ0QsQ0FDWCxDQTNCdUJjLEdBZ0JuQixhQWZxQkMsTUFBTXRCLEVBQUksQ0FDM0JGLE9BQVFBLEVBQ1J5QixRQUFTaEIsRUFDVGlCLEtBQU16QixFQUFNMEIsS0FBS0MsVUFBVTNCLFFBQU80QixJQUVwQ0MsTUFBTUMsSSxNQUlKLEdBRkFDLFFBQVFDLElBQUlGLElBRThELEtBQW5DLFFBQXBDLEVBQUFBLEVBQVNOLFFBQVFwQyxJQUFJLHVCQUFlLGVBQUVrQixRQUFRLHFCQUM3QyxNQUFNLElBQUkyQixNQUFNLHlCQUdwQixPQUFPSCxFQUFTSSxNQUFNLEdBRzlCLEcscWxCQ21ETyxTQUFTQyxFQUF3QkMsRUFBa0NDLEdBQ3RFLElBQUkxQixFQUNKLENBQ0kyQixXQUFZLEdBQ1pDLFlBQWEsSUFFakIsSUFBS0gsRUFBTyxPQUFPekIsRUFFbkIsSUFBSTZCLEVBMENELFNBQXVCSixHQUMxQixJQUFLQSxFQUFPLE9BRVosSUFBSUssRUFBY0MsUUFBUUMsS0FBS0MsS0FBS0MsUUFBUUMsUUFBUUMsZ0JBR3BELE9BRGVYLEVBQU1ZLFVBQVVDLFFBQU9DLEdBQUtBLEVBQUVDLGtCQUFrQlYsR0FHbkUsQ0FsRHdCVyxDQUFjaEIsR0FpQ2xDLE9BOUJBSSxTQUFBQSxFQUFlYSxTQUFRSCxJQUVuQkEsRUFBRUMsT0FBT0csY0FBY0QsU0FBUUUsSUFDdEJBLEVBQUlDLGdCQUlMRCxFQUFJQyxtQkFBcUJuQixHQUN6QjFCLEVBQVM0QixZQUFZa0IsS0FBS0YsRSxJQUlsQ0wsRUFBRUMsT0FBT08sUUFBUUMsaUJBQWlCTixTQUFRTyxJQUNsQ0EsRUFBRUosaUJBQW1CbkIsR0FDckIxQixFQUFTMkIsV0FBV21CLEtBQUtHLEUsR0FFL0IsSUFjQ2pELENBQ1gsQ0F5QkEsU0FBZWtELEVBQTBCQyxFQUFlQyxHLHlDQUNwRCxJQUFJQyxRQ3ZMRCxTQUEwQkQsRyx5Q0FFN0IsSUFFSSxJQUFJakUsRUFBTSxtQkFDVixhRkhELFNBQThCQSxFQUFhaUUsRyx5Q0FFOUMsT0FBT2xFLEVBQWdCQyxFQUFJLE9BQU9pRSxFQUN0QyxHLENFQXFCRSxDQUFnQzlELE9BQU9DLFNBQVNGLFNBQVNHLE9BQVNQLEVBQUtpRSxFLENBRXhGLE1BQU9HLEdBRUhuQyxRQUFRb0MsS0FBSyxtQkFBb0JELEVBQUVILEUsQ0FHM0MsRyxDRDJLMEJLLENBQVdMLEdBR2pDLE9BREFoQyxRQUFRQyxJQUFJLHVCQUF3QixpQkFBa0JnQyxHQUNsREEsR0FLSmpDLFFBQVFDLElBQUksdUJBQXdCLGlCQUFrQmdDLEdBSzFELFNBQTZDQSxHQUV6QyxJQUdJLE9BRGVBLEVBQVVLLEtBQUtDLEtBQUlWLEdBQUtsQyxLQUFLNkMsTUFBTVgsRUFBRVksUyxDQUd4RCxNQUFNTixHQUVGbkMsUUFBUW9DLEtBQUssNkRBQThERCxFQUFFRixFLENBRWpGLE1BQU8sRUFDWCxDQWhCV1MsQ0FBbUNULEtBSnRDakMsUUFBUUMsSUFBSSxtQ0FBb0Msa0JBQ3pDLEdBS2YsRywyU0V6TEEsTUFBTTBDLEVBQThCLGlCQUM5QkMsRUFBdUIsU0FHdEIsU0FBU0MsRUFBTUMsRyxZQUVsQixJQUFJLG1CQUFFQyxFQUFrQixjQUFFQyxFQUFhLGVBQUVDLEdBd0M3QyxTQUF5QkgsR0FJckIsSUFBSUEsRUFBUUksS0FBTSxNQUFNLElBQUloRCxNQUFNLFdBRWxDLElBQUk4QyxFQUFnQkYsRUFBUUksS0FBS0MsV0FBV0MsRUFBV0osZUFNdkQsTUFBTyxDQUFFRCxtQkFMZ0JELEVBQVFJLEtBQUtDLFdBQVdDLEVBQVdMLG9CQUsvQkMsZ0JBQWVDLGVBSnZCSCxFQUFRSSxLQUFLQyxXQUFXQyxFQUFXSCxnQkFLNUQsQ0FyRGdFSSxDQUFnQlAsR0FFNUUsSUFBSUMsRUFBb0IsTUFBTSxJQUFJN0MsTUFBTSx5QkFDeEMsSUFBSThDLEVBQWUsTUFBTSxJQUFJOUMsTUFBTSxvQkFDbkMsSUFBSStDLEVBQWdCLE1BQU0sSUFBSS9DLE1BQU0scUJBSXBDLEdBRkM5QixPQUFla0YsT0FBU1IsT0FFV2pELElBQWpDaUQsRUFBUVMsZ0JBQWdCQyxLQUMzQixDQUNJLElBQUlDLEdBQU8sRUFPWCxLQUx1QyxRQUFwQyxFQUF1QixRQUF2QixFQUFBWCxFQUFRUyx1QkFBZSxlQUFFRyxtQkFBVyxlQUFFQyxjQUFjQyxTQUFTLFlBQW9DLFFBQXZCLEVBQUFkLEVBQVFTLHVCQUFlLGVBQUVHLGVBRWxHRCxHQUFPLElBR0QsSUFBUEEsRUFNQyxPQUhBekQsUUFBUUMsSUFBSSw4REFBK0QsbUNBQW9DNkMsRUFBUVMsZ0JBQWdCQyxNQUN2SXhELFFBQVFDLElBQUksa0RBQW1ELG1DQUFvQzZDLEVBQVFTLGdCQUFnQkMsTUFDM0h4RCxRQUFRQyxJQUFJLDBEQUEyRCxtQ0FBMkQsUUFBdkIsRUFBQTZDLEVBQVFTLHVCQUFlLGVBQUVHLGNBQzdILEMsQ0FhZixPQVRDdEYsT0FBZXlGLGNBQWlCekYsT0FBZXlGLGVBQWlCLENBQUMsRUFDakV6RixPQUFleUYsY0FBY0MseUJBQTJCZCxFQUV6RGUsRUFBc0JmLEVBQWVELEVBQW9CRSxHQXlCN0QsU0FBMEJILEVBQThCRSxFQUE0QkQsRUFBaUNFLEcsWUFDakgsSUFBSUgsRUFBUUksS0FBTSxNQUFNLElBQUloRCxNQUFNLFdBRXVDLFFBQXpFLEVBQUE4QyxFQUFjRyxXQUFXYSxFQUF1QkMsaUNBQXlCLFNBQUVDLEdBQUcsVUFBVSxTQUFxQkMsRyxNQUN6R25FLFFBQVFDLElBQUksZ0NBQTBHLFFBQXpFLEVBQUErQyxFQUFjRyxXQUFXYSxFQUF1QkMsaUNBQXlCLGVBQUVHLFlBQVksZ0NBQ3hJLElBR3NELFFBQXRELEVBQUF0QixFQUFRSSxLQUFLQyxXQUFXQyxFQUFXTCwyQkFBbUIsU0FBRW1CLEdBQUcsVUFBVSxTQUFxQkMsR0FFdEZKLEVBQXNCZixFQUFlRCxFQUFvQkUsR0FFekRvQixFQUFvQnZCLEVBQVFFLEVBQWVELEVBQW9CRSxFQUNuRSxJQUdrRCxRQUFsRCxFQUFBSCxFQUFRSSxLQUFLQyxXQUFXQyxFQUFXSCx1QkFBZSxTQUFFaUIsR0FBRyxVQUFVLFNBQXFCQyxHQUVsRkosRUFBc0JmLEVBQWVELEVBQW9CRSxHQUV6RG9CLEVBQW9CdkIsRUFBUUUsRUFBZUQsRUFBb0JFLEVBQ25FLElBSXdELFFBQXhELEVBQUFILEVBQVFJLEtBQUtDLFdBQVdDLEVBQVdrQiw2QkFBcUIsU0FBRUosR0FBRyxVQUFVLFNBQTJCQyxHLHFEQUU5RixJQUFJSSxFQUE4RCxRQUFqRCxFQUFZLFFBQVosRUFBQXpCLEVBQVFJLFlBQUksZUFBRUMsV0FBVyxnQ0FBd0IsZUFBRWlCLFdBQ3BFcEUsUUFBUUMsSUFBSSxnQ0FBa0YsUUFBakQsRUFBWSxRQUFaLEVBQUE2QyxFQUFRSSxZQUFJLGVBQUVDLFdBQVcsZ0NBQXdCLGVBQUVpQixZQUFZLGdDQUM1RyxJQUFJSSxFQUFTMUIsRUFBUTJCLFVBQVUsaUVBQzNCQyxRQUFvQ0MsTUFBTXRILElBQTZCLGdEQUFnRGtILEtBQzNILElBQUtHLEVBR0QsWUFEQTFFLFFBQVFDLElBQUksMkNBQTRDLG1DQUFvQ3lFLEdBR2hHLElBQ0lFLFNBRGdCRCxNQUFNdEgsSUFBNkIsNERBQ3BCd0gsTUFBTUMsR0FBOEJBLEVBQU9DLE9BQVNMLEVBQTRCSyxPQUM5R0gsRUFLTEosRUFBT3BELE9BQU80RCxZQUFZQyxlQUFlTCxFQUFxQnBCLElBSDFEeEQsUUFBUUMsSUFBSSwyQ0FBNEMsbUNBQW9DMkUsRSxNQUt4RyxDQXBFSU0sQ0FBaUJwQyxFQUFTRSxFQUFlRCxFQUFvQkUsR0FpUWpFLFNBQWtDSCxHLFFBRTlCLElBQUlxQyxFQUFPLElBQUlDLEtBUVhDLEVBQW1CLElBUFpGLEVBQUtHLGdCQUNKSCxFQUFLSSxXQUFhLElBQ3BCSixFQUFLSyxZQUNKTCxFQUFLTSxhQUNITixFQUFLTyxlQUNMUCxFQUFLUSxlQUNBUixFQUFLUyxvQkFFOEIsUUFBckQsRUFBWSxRQUFaLEVBQUE5QyxFQUFRSSxZQUFJLGVBQUVDLFdBQVdDLEVBQVdpQyx5QkFBaUIsU0FBRVEsU0FBU1IsRUFDcEUsQ0E1UUlTLENBQXlCaEQsR0FFekJpRCxJQUFJQyxPQUFPQyxVQUFVLDZCQUE4Qm5ELElBQzVDLENBQ1gsQ0FrRUEsU0FBU2lCLEVBQXNCZixFQUE2QkQsRUFBaUNFLElBSzdGLFNBQStCRCxFQUE0QmtELEdBQWtCLEcsTUFDekUsSUFBSWxELEVBQWNtRCxPQUFRLE1BQU0sSUFBSWpHLE1BQU0sYUFDMUMsSUFBSThDLEVBQWNHLFdBQVksTUFBTSxJQUFJakQsTUFBTSxpQkFFOUM4QyxFQUFjbUQsT0FBTzdFLFNBQVE4RSxJQUd6QkEsRUFBTUMsVUFBVUgsRUFBTyxJQUlnRCxRQUEzRSxFQUFBbEQsRUFBY0csV0FBV2EsRUFBdUJzQyxtQ0FBMkIsU0FBRUMsUUFBTyxFQUN4RixDQWhCSUMsQ0FBc0J4RCxFQUFlQyxFQUFlbUIsV0FDeEQsQ0ErQkEsU0FBZUMsRUFBb0J2QixFQUE2QkUsRUFBNEJELEVBQWlDRSxHLG1GQUd6SCxJQUFJaEYsUUFtSFIsU0FBNkI4RSxHLHlDQUV6QixJQUFJbkUsRUFBMkIsR0FDL0IsUUFBMEJpQixJQUF2QmtELEdBQWtFLElBQTlCQSxFQUFtQjdELE9BRXRELE9BQU9OLEVBS1gsSUFFSSxJQUFJWCxRSDlRTCxTQUE2QkYsRyx5Q0FDakMsT0FBT0QsRUFBZ0JDLEVBQUksV0FBTThCLEVBQ3BDLEcsQ0c0UXlCNEcsQ0FBZ0IsdUNBQXVDMUQsS0FFeEUsR0FEQS9DLFFBQVFDLElBQUksK0NBQWdELG1DQUFvQ2hDLEdBQzdGQSxHQUFRQSxFQUFLeUksV0FDaEIsQ0FDSSxJQUFJQyxFQUF1QixDQUN2QjFJLEtBQU1BLEdBR1ZXLEVBQVM4QyxLQUFLaUYsRSxFQUd0QixNQUFNeEUsR0FFRm5DLFFBQVFDLElBQUksd0NBQXdDa0MsRSxDQUd2RCxPQUFPdkQsQ0FDWixHLENBaEpxQmdJLENBQWM3RCxFQUFtQnFCLFlBQ2xEcEUsUUFBUUMsSUFBSWhDLEdBRVosSUFBSTRJLEVBQWlCNUksRUFBSzRHLE1BQUssU0FBVThCLEdBR3RDLE9BQU81RCxFQUFtQnFCLGFBQWV1QyxFQUFPMUksS0FBS3lJLFVBRXhELElBRUEsUUFBdUI3RyxJQUFuQmdILElBQThELElBQTlCNUQsRUFBZW1CLFdBRS9DLFlBNUJSLFNBQWtDcEIsRyx3Q0FDVixRQUFwQixFQUFBQSxFQUFjbUQsY0FBTSxTQUFFN0UsU0FBUSxTQUFVOEUsR0FDcENBLEVBQU1QLFNBQVMsR0FDbkIsRyxJQXdCSWlCLENBQW1COUQsR0FJdkIsS0FBd0IsUUFBcEIsRUFBQUEsRUFBYytELGNBQU0sZUFBRTVELFlBQVksTUFBTSxJQUFJakQsTUFBTSxhQUN0RCxJQUFJbUYsRUFBeUUsUUFBdEQsRUFBb0IsUUFBcEIsRUFBQXJDLEVBQWMrRCxjQUFNLGVBQUU1RCxXQUFXLDZCQUFxQixlQUFFaUIsZ0JBRXREdkUsSUFBckJ3RixHQUFrQ0EsRUFBaUJuRyxPQUtNLFFBQTVELEVBQVksUUFBWixFQUFBNEQsRUFBUUksWUFBSSxlQUFFQyxXQUFXQyxFQUFXNEQsZ0NBQXdCLFNBQUVuQixVQUE2QixRQUFwQixFQUFBZ0IsYUFBYyxFQUFkQSxFQUFnQjVJLFlBQUksZUFBRXlJLGFBQWMsSUFHcEMsUUFBeEUsRUFBQTFELEVBQWNHLFdBQVdhLEVBQXVCaUQsZ0NBQXdCLFNBQUVwQixVQUFxQyxRQUE1QixFQUFvQixRQUFwQixFQUFBZ0IsYUFBYyxFQUFkQSxFQUFnQjVJLFlBQUksZUFBRWlKLGNBQU0sZUFBRW5DLE9BQVEsSUFDakQsUUFBeEUsRUFBQS9CLEVBQWNHLFdBQVdhLEVBQXVCbUQsZ0NBQXdCLFNBQUV0QixVQUFxQyxRQUE1QixFQUFvQixRQUFwQixFQUFBZ0IsYUFBYyxFQUFkQSxFQUFnQjVJLFlBQUksZUFBRWlKLGNBQU0sZUFBRUUsT0FBUSxJQUV2RCxRQUFsRSxFQUFBcEUsRUFBY0csV0FBV2EsRUFBdUJxRCwwQkFBa0IsU0FBRXhCLFVBQTZCLFFBQXBCLEVBQUFnQixhQUFjLEVBQWRBLEVBQWdCNUksWUFBSSxlQUFFcUosWUFBYSxJQUN2QyxRQUF6RSxFQUFBdEUsRUFBY0csV0FBV2EsRUFBdUJDLGlDQUF5QixTQUFFNEIsVUFBc0MsUUFBN0IsRUFBb0IsUUFBcEIsRUFBQWdCLGFBQWMsRUFBZEEsRUFBZ0I1SSxZQUFJLGVBQUVzSixlQUFPLGVBQUV4QyxPQUFRLElBQzNELFFBQWhFLEVBQUEvQixFQUFjRyxXQUFXYSxFQUF1QndELHdCQUFnQixTQUFFM0IsVUFBNkIsUUFBcEIsRUFBQWdCLGFBQWMsRUFBZEEsRUFBZ0I1SSxZQUFJLGVBQUV3SixTQUFVLElBRTNHekgsUUFBUUMsSUFBSSwyQkFBNkIrQyxFQUFjMEUsV0FHdkQsS0EyQkosU0FBa0NiLEVBQStCL0QsSUY1SjFELFNBQWdDZixHLHlDQTRCL0IsT0FBT0QsRUFBK0NDLEVBMUJ2QyxDQUNYLFVBQWEsRUFDYixRQUFXLEVBQ1gsWUFBZSxHQUNmLGFBQWdCQSxFQUNoQixlQUFrQixHQUNsQixhQUFnQixDQUNaLFlBQWUsS0FDZixjQUFpQixLQUNqQixlQUFrQixNQUV0QixTQUFZLENBQ1IsU0FBWSxLQUNaLE1BQVMsSUFFYixXQUFjLENBQ1YsV0FBYyxNQUVsQixhQUFnQixHQUNoQixNQUFTLEdBQ1QsTUFBUyxHQUNULFNBQVksQ0FDUixVQUVKLGdCQUFrQixHQUc5QixHLEVFaUlJNEYsQ0FEaUJkLEVBQWU1SSxLQUFLaUosT0FBT0UsTUFDZnRILE1BQU04SCxJQUMvQixJQUFJVixFQUFTVSxFQUFRLEdBQ3JCNUgsUUFBUUMsSUFBSSwyQkFBNEJpSCxhQUFNLEVBQU5BLEVBQVFuQyxNQUFNLGdDQUFpQzZDLEdBQ3ZGLElBQUlDLEVBNElaLFNBQTRCL0UsR0FDeEIsT0FBTzFDLEVBQXdCMEMsRUFBUXpDLE1BQU91QyxFQUNsRCxDQTlJd0JrRixDQUFtQmhGLEdBQy9CaUYsRUFBZ0JGLEVBQVV0SCxXQUFXLEdBQ3JDZ0IsRUFBY3NHLEVBQVVySCxZQUFZLEdBRXhDLElBQUt1SCxJQUFrQnhHLEVBQ25CLE9BRUosSUFBSzJGLEVBRUQsWUFEQTNGLEVBQVl5RyxVQUFTLEdBR3pCLElBQUlDLEVBQXNCRixFQUFjRyxXQUFXQywwQkFBMEJqQixFQUFPMUQsR0FBSSxlQUFnQjBELEVBQU9uQyxNQUMvR2dELEVBQWNHLFdBQVdFLGVBQWVILEVBQU8sR0FFdkQsQ0E1Q1FJLENBQXlCeEIsRUFBZ0IvRCxFLENBRTdDLE1BQU1YLEdBRUZuQyxRQUFRQyxJQUFJLHdFLENBR2hCLEtBNENKLFNBQW1DNEcsRUFBK0IvRCxHQUN4QytELEVBQWU1SSxLQUFLc0osUUFBUXhDLEtBQUtqRyxNQUFNLEtBQUssR0Z0Ty9ELFNBQThCaUQsRyx5Q0F1Q2pDLE9BQU9ELEVBQXlDQyxFQXJDakMsQ0FDWCxVQUFhLEVBQ2IsUUFBVyxFQUNYLFlBQWUsR0FDZixhQUFnQkEsRUFDaEIsZUFBa0IsR0FDbEIsYUFBZ0IsQ0FDWixZQUFlLEtBQ2YsY0FBaUIsS0FDakIsZUFBa0IsTUFFdEIsU0FBWSxDQUNSLFNBQVksS0FDWixNQUFTLElBRWIsV0FBYyxDQUNWLFdBQWMsTUFFbEIsYUFBZ0IsR0FDaEIsTUFBUyxHQUNULE1BQVMsR0FDVCxTQUFZLENBQ1IsTUFDQSwyQkFDQSxTQUNBLGFBQ0EseUJBQ0EsV0FDQSxTQUNBLGdCQUNBLFdBQ0EsTUFDQSxhQUNBLHdCQUVKLGdCQUFrQixHQUcxQixHLENFK0xJdUcsQ0FBZXpCLEVBQWU1SSxLQUFLc0osUUFBUWdCLE9BQU96SSxNQUFNMEksSUFDcEQsSUFBSUMsRUFBT0QsRUFBTSxHQUNqQnhJLFFBQVFDLElBQUksZ0NBQWlDd0ksYUFBSSxFQUFKQSxFQUFNakYsSUFBSSxnQ0FBaUNpRixHQUN4RixJQUFJQyxFQXlHWixTQUE2QjVGLEdBQ3pCLE9BQU8xQyxFQUF3QjBDLEVBQVF6QyxNQUFNc0MsRUFDakQsQ0EzRytCZ0csQ0FBb0I3RixHQUN2Q2lGLEVBQWdCVyxFQUFpQm5JLFdBQVcsR0FDNUNnQixFQUFjbUgsRUFBaUJsSSxZQUFZLEdBRS9DLElBQUt1SCxJQUFrQnhHLEVBQ25CLE9BRUosSUFBS2tILEVBRUQsWUFEQWxILEVBQVl5RyxVQUFTLEdBSXpCLElBQUlDLEVBQXNCRixFQUFjRyxXQUFXQywwQkFBMEJNLEVBQUtqRixHQUFJLE9BQVFpRixFQUFLRyxVQUFZLElBQU1ILEVBQUtJLFNBQzFIZCxFQUFjRyxXQUFXRSxlQUFlSCxFQUFPLEdBRXZELENBOURRYSxDQUEwQmpDLEVBQWdCL0QsRSxDQUU5QyxNQUFNWCxHQUVGbkMsUUFBUUMsSUFBSSx3RSxLQW9IcEIsSUFBWW1ELEVBZ0JBWSxHQWhCWixTQUFZWixHQUNSLGlHQUNBLCtDQUNBLG1DQUNBLDRDQUNBLHVEQUNBLHdDQUNBLGtDQUNBLHNDQUNBLGdDQUVILENBWEQsQ0FBWUEsSUFBQUEsRUFBVSxLQWdCdEIsU0FBWVksR0FDUixpRUFDQSx5REFDQSx1REFDQSx1REFDQSwyREFDQSwwQ0FDQSxzQ0FDQSwyREFDSCxDQVRELENBQVlBLElBQUFBLEVBQXNCLEsiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly8vd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly8vd2VicGFjay9ydW50aW1lL21ha2UgbmFtZXNwYWNlIG9iamVjdCIsIndlYnBhY2s6Ly8vLi4vLi4vQ29tbW9uL2FwaS9hcGkudHMiLCJ3ZWJwYWNrOi8vLy4uLy4uL0NvbW1vbi9PZHNIZWxwZXIudHMiLCJ3ZWJwYWNrOi8vLy4uLy4uL0NvbW1vbi9hcGkvb2RzL3NlYXJjaC50cyIsIndlYnBhY2s6Ly8vLi9GQl9NYXR0ZXJEZXRhaWxzL2luZGV4LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRoZSByZXF1aXJlIHNjb3BlXG52YXIgX193ZWJwYWNrX3JlcXVpcmVfXyA9IHt9O1xuXG4iLCIvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgaGFybW9ueSBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSAoZXhwb3J0cywgZGVmaW5pdGlvbikgPT4ge1xuXHRmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGRlZmluaXRpb24sIGtleSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBrZXkpKSB7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pO1xuXHRcdH1cblx0fVxufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkpIiwiLy8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5yID0gKGV4cG9ydHMpID0+IHtcblx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG5cdH1cblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbn07IiwiXG4vKipcbiAqIFRoaXMgZmlsZSBjb250YWlucyB0aGUgYXBpIGNhbGxzIHRvIHRoZSBiYWNrZW5kLlxuICogdXRpbGlzaW5nIHRoZSBheGlvcyBsaWJyYXJ5IHRvIG1ha2UgdGhlIGNhbGxzLlxuICogaW5jbHVzaW5nIG9mIHdlYnBhY2tJZ25vcmUgaXMgdG8gYWxsb3cgdGhlIHdlYnBhY2sgdG8gaWdub3JlIHRoZSBjYWxscyBhbmQgbm90IHRyeSB0byBidW5kbGUgdGhlbS5cbiAqL1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZVBvc3Q8VD4oYXBpOiBzdHJpbmcsIHBvc3RCb2R5OiBhbnkpIDogUHJvbWlzZTxUPntcbiAgICAvL3JldHVybiBhd2FpdCAkYWpheC5wb3N0KC8qIHdlYnBhY2tJZ25vcmU6IHRydWUgKi8gdmFsaWRhdGVBcGkoYXBpKSwgcG9zdEJvZHkpO1xuICAgIHJldHVybiBleGVjdXRlRmV0Y2g8VD4oYXBpLFwiUE9TVFwiLHBvc3RCb2R5KTtcbn1cblxuLy8gZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVHZXQ8VD4oYXBpOiBzdHJpbmcpIDogUHJvbWlzZTxUPntcbi8vICAgICByZXR1cm4gYXdhaXQgJGFqYXguZ2V0KC8qIHdlYnBhY2tJZ25vcmU6IHRydWUgKi8gdmFsaWRhdGVBcGkoYXBpKSk7XG4vLyB9IFxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZUdldDxUPihhcGk6IHN0cmluZykgOiBQcm9taXNlPFQ+e1xuICAgcmV0dXJuIGV4ZWN1dGVGZXRjaDxUPihhcGksXCJHRVRcIix1bmRlZmluZWQpO1xufVxuXG5cblxuXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBleGVjdXRlUHV0PFQ+KGFwaTogc3RyaW5nLCBwb3N0Qm9keTogYW55KSA6IFByb21pc2U8VD57XG4gICAgLy9yZXR1cm4gYXdhaXQgJGFqYXgucHV0KC8qIHdlYnBhY2tJZ25vcmU6IHRydWUgKi8gdmFsaWRhdGVBcGkoYXBpKSwgcG9zdEJvZHkpO1xuICAgIHJldHVybiBleGVjdXRlRmV0Y2g8VD4oYXBpLFwiUFVUXCIscG9zdEJvZHkpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZURlbGV0ZTxUPihhcGk6IHN0cmluZykgOiBQcm9taXNlPFQ+e1xuICAgIC8vcmV0dXJuIGF3YWl0ICRhamF4LmRlbGV0ZSgvKiB3ZWJwYWNrSWdub3JlOiB0cnVlICovIHZhbGlkYXRlQXBpKGFwaSkpO1xuICAgIHJldHVybiBleGVjdXRlRmV0Y2g8VD4oYXBpLFwiREVMRVRFXCIsdW5kZWZpbmVkKTtcbn1cblxuZnVuY3Rpb24gdmFsaWRhdGVBcGkoYXBpOiBzdHJpbmcpIDogc3RyaW5ne1xuICAgbGV0IGxvY2F0aW9uPSAgd2luZG93LmRvY3VtZW50LmxvY2F0aW9uLm9yaWdpbjtcblxuICAgLy9pZiBhcGkgZG9lcyBub3QgaW5jbHVkZSB0aGUgbG9jYXRpb24gdGhlbiBhZGQgaXQuXG4gICAgaWYoYXBpLmluZGV4T2YobG9jYXRpb24pID09PSAtMSl7XG4gICAgICAgIC8vY2hlY2sgaWYgYXBpIHN0YXJ0IHdpdGggYSAvIGlmIG5vdCBhZGQgaXQuXG4gICAgICAgIGlmKGFwaS5pbmRleE9mKFwiL1wiKSAhPT0gMCl7XG4gICAgICAgICAgICBhcGkgPSBcIi9cIiArIGFwaTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgYXBpID0gbG9jYXRpb24gKyBhcGk7XG4gICAgfVxuICAgIHJldHVybiBhcGk7XG4gICAgXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBleGVjdXRlRmV0Y2g8VD4oYXBpOiBzdHJpbmcsIG1ldGhvZDpzdHJpbmcsZGF0YTphbnkpIDogUHJvbWlzZTxUPntcbiAgICBsZXQgdXJsID0gdmFsaWRhdGVBcGkoYXBpKTtcbiAgICBsZXQgZmV0Y2hIZWFkZXJzID0gYnVpbGRIZWFkZXJzKCk7XG4gICAgbGV0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLHtcbiAgICAgICAgbWV0aG9kOiBtZXRob2QsXG4gICAgICAgIGhlYWRlcnM6IGZldGNoSGVhZGVycyxcbiAgICAgICAgYm9keTogZGF0YT8gSlNPTi5zdHJpbmdpZnkoZGF0YSk6IHVuZGVmaW5lZFxuICAgIH1cbiAgICApLnRoZW4oKHJlc3BvbnNlKSA9PiB7XG4gICAgICAgIFxuICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgIC8vY2hlY2sgaWYgcmVzcG9uc2UgaXMgSlNPTlxuICAgICAgICBpZihyZXNwb25zZS5oZWFkZXJzLmdldChcImNvbnRlbnQtdHlwZVwiKT8uaW5kZXhPZihcImFwcGxpY2F0aW9uL2pzb25cIikgPT09IC0xKXtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlJlc3BvbnNlIHdhcyBub3QgSlNPTlwiKTtcbiAgICAgICAgfVxuICAgICAgICAvL3JldHVybiB0aGUganNvbiBhcyBvYmplY3RcbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcbiAgICB9KTtcbiAgICByZXR1cm4gcmVzcG9uc2U7XG59XG5cbmZ1bmN0aW9uIGJ1aWxkSGVhZGVycygpIHtcbiAgICBsZXQgYmVhcmVyID0gZ2V0QmVhcmVyVG9rZW4oKTtcbiAgICBsZXQgZmV0Y2hIZWFkZXJzID0gbmV3IEhlYWRlcnMoKTtcbiAgICBmZXRjaEhlYWRlcnMuYXBwZW5kKFwiQ29udGVudC1UeXBlXCIsIFwiYXBwbGljYXRpb24vanNvblwiKTtcbiAgICBpZiAoYmVhcmVyKSB7XG4gICAgICAgIGZldGNoSGVhZGVycy5hcHBlbmQoXCJBdXRob3JpemF0aW9uXCIsIGJlYXJlcik7XG4gICAgfVxuICAgIHJldHVybiBmZXRjaEhlYWRlcnM7XG59XG5cblxuZXhwb3J0IGZ1bmN0aW9uIGdldENvb2tpZXMoKTogeyBba2V5OnN0cmluZ106c3RyaW5nIH1cbntcbiAgICBsZXQgcmV0VmFsdWU6IHsgW2tleTpzdHJpbmddOnN0cmluZyB9ID0ge307XG4gICAgbGV0IGNvb2tpZXMgPSBkb2N1bWVudC5jb29raWUuc3BsaXQoXCI7XCIpLnJlZHVjZShmdW5jdGlvbiAoY29va2llcywgY29va2llKVxuICAgIHtcbiAgICAgICAgdmFyIHBhcnRzID0gY29va2llLnNwbGl0KFwiPVwiKTtcbiAgICAgICAgaWYgKHBhcnRzLmxlbmd0aCA9PT0gMilcbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIGtleSA9IHBhcnRzWzBdLnRyaW0oKTtcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IHBhcnRzWzFdO1xuXG4gICAgICAgICAgICByZXRWYWx1ZVtrZXldID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNvb2tpZXM7XG4gICAgfSwge30pO1xuXG4gICAgcmV0dXJuIHJldFZhbHVlO1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIGdldEJlYXJlclRva2VuKClcbntcbiAgICB2YXIgY29va2llcyA9IGdldENvb2tpZXMoKTtcbiAgICB2YXIgdG9rZW4gPSBjb29raWVzW1wiX2FwaVwiXTtcblxuICAgIGlmKCB0b2tlbiApIHJldHVybiBcIkJlYXJlciBcIiArIHRva2VuO1xuICAgIHJldHVybiBudWxsO1xufTsiLCIvKipcbiAqIFRoaXMgZmlsZSBjb250YWlucyBoZWxwZXIgZnVuY3Rpb25zIGZvciB3b3JraW5nIHdpdGggdGhlIE9EUyBBUElcbiAqIF9zZWFyY2ggaXMgYSB3cmFwcGVyIGFyb3VuZCB0aGUgT0RTIHNlYXJjaCBlbmRwb2ludFxuICovXG5pbXBvcnQgeyBJQXNwZWN0IH0gZnJvbSBcIi4uLy4uL1R5cGluZ3MvQXNwZWN0L0lBc3BlY3RcIjtcbmltcG9ydCB7IElPRFNPcmdhbmlzYXRpb25SZXN1bHQgfSBmcm9tIFwiLi4vLi4vVHlwaW5ncy9PZHNMaXN0L0lPRFNPcmdhbmlzYXRpb25SZXN1bHRcIjtcbmltcG9ydCB7IElPRFNQZXJzb25SZXN1bHQgfSBmcm9tIFwiLi4vLi4vVHlwaW5ncy9PZHNMaXN0L0lPRFNQZW9wbGVTZWFyY2hSZXN1bHRcIjtcbmltcG9ydCB7IElPRFNlYXJjaFJlc3VsdCB9IGZyb20gXCIuLi8uLi9UeXBpbmdzL09kc0xpc3QvSU9EU1NlYXJjaFJlc3VsdFwiO1xuaW1wb3J0IHsgVFNoYXJlRG9CbGFkZSB9IGZyb20gXCIuLi8uLi9UeXBpbmdzL1NoYXJlRG9KUy9BZGRFZGl0U2hhcmVkb1wiO1xuaW1wb3J0IHsgSVJvbGVDb25maWdNb2RlbHMgfSBmcm9tIFwiLi4vLi4vVHlwaW5ncy9XaWRnZXRzT2RzRW50aXR5UGlja2VyL0lSb2xlQ29uZmlnTW9kZWxzXCI7XG5pbXBvcnQgeyBJT2RzV2lkZ2V0LCBJT2RzV2lkZ2V0T0RTRW50aXRpZXMgfSBmcm9tIFwiLi4vLi4vVHlwaW5ncy9XaWRnZXRzT2RzRW50aXR5UGlja2VyL0lXaWRnZXRPZHNFbnRpdHlQaWNrZXJcIjtcbmltcG9ydCB7IF9zZWFyY2ggfSBmcm9tIFwiLi9hcGkvb2RzL3NlYXJjaFwiO1xuXG5cbi8qKlxuICogVXNlcyB0aGUgXCIvYXBpL29kcy9fc2VhcmNoXCIgZW5kcG9pbnQgdG8gc2VhcmNoIGZvciB1c2Vycy5cbiAqIEBwYXJhbSBzZWFyY2ggVGhlIHNlYXJjaCBzdHJpbmcgdG8gdXNlIHN1Y2ggYXMgc3VybmFtZSBvciBlbWFpbCBhZGRyZXNzXG4gKiBAcmV0dXJucyBcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNlYXJjaEZvclVzZXJzKHNlYXJjaDogc3RyaW5nKSA6IFByb21pc2U8SU9EU1BlcnNvblJlc3VsdFtdPlxuIHtcbiAgICBsZXQgcG9zdEJvZHkgPSB7XG4gICAgICAgIFwic3RhcnRQYWdlXCI6IDEsXG4gICAgICAgIFwiZW5kUGFnZVwiOiAxLFxuICAgICAgICBcInJvd3NQZXJQYWdlXCI6IDEwLFxuICAgICAgICBcInNlYXJjaFN0cmluZ1wiOiBzZWFyY2gsXG4gICAgICAgIFwib2RzRW50aXR5VHlwZXNcIjogW10sXG4gICAgICAgIFwiYXZhaWxhYmlsaXR5XCI6IHtcbiAgICAgICAgICAgIFwiaXNBdmFpbGFibGVcIjogbnVsbCxcbiAgICAgICAgICAgIFwiaXNPdXRPZk9mZmljZVwiOiBudWxsLFxuICAgICAgICAgICAgXCJpc05vdEF2YWlsYWJsZVwiOiBudWxsXG4gICAgICAgIH0sXG4gICAgICAgIFwibG9jYXRpb25cIjoge1xuICAgICAgICAgICAgXCJwb3N0Y29kZVwiOiBudWxsLFxuICAgICAgICAgICAgXCJyYW5nZVwiOiAxMFxuICAgICAgICB9LFxuICAgICAgICBcImNvbm5lY3Rpb25cIjoge1xuICAgICAgICAgICAgXCJzeXN0ZW1OYW1lXCI6IG51bGxcbiAgICAgICAgfSxcbiAgICAgICAgXCJjb21wZXRlbmNpZXNcIjogW10sXG4gICAgICAgIFwidGVhbXNcIjogW10sXG4gICAgICAgIFwicm9sZXNcIjogW10sXG4gICAgICAgIFwib2RzVHlwZXNcIjogW1xuICAgICAgICAgICAgXCJhY2xcIixcbiAgICAgICAgICAgIFwiYWx0LWVkaXNjb3ZlcnktdXNlci10eXBlXCIsXG4gICAgICAgICAgICBcImNsaWVudFwiLFxuICAgICAgICAgICAgXCJkZXBhcnRtZW50XCIsXG4gICAgICAgICAgICBcImRvY3VtZW50LXRyYWluaW5nLXR5cGVcIixcbiAgICAgICAgICAgIFwiZW1wbG95ZWVcIixcbiAgICAgICAgICAgIFwiZXhwZXJ0XCIsXG4gICAgICAgICAgICBcImV4dGVybmFsLXRlYW1cIixcbiAgICAgICAgICAgIFwiZXh0ZXJuYWxcIixcbiAgICAgICAgICAgIFwicG9kXCIsXG4gICAgICAgICAgICBcInN0cnVjdHVyYWxcIixcbiAgICAgICAgICAgIFwic3lzdGVtLWFkbWluaXN0cmF0b3JcIlxuICAgICAgICBdLFxuICAgICAgICBcIndhbGxNYW5hZ2VtZW50XCI6IGZhbHNlXG4gICAgfTtcbiAgICByZXR1cm4gc2VhcmNoT2RzQW5kUmV0dXJuUm93czxJT0RTUGVyc29uUmVzdWx0PihzZWFyY2gscG9zdEJvZHkpO1xufVxuXG4vKipcbiAqIFVzZXMgdGhlIFwiL2FwaS9vZHMvX3NlYXJjaFwiIGVuZHBvaW50IHRvIHNlYXJjaCBmb3IgY2xpZW50cy5cbiAqIEBwYXJhbSBzZWFyY2ggVGhlIHNlYXJjaCBzdHJpbmcgdG8gdXNlIHN1Y2ggYXMgY2xpZW50IGNvZGUgb3IgbmFtZVxuICogQHJldHVybnMgQSBsaXN0IG9mIGNsaWVudHNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNlYXJjaEZvckNsaWVudHMoc2VhcmNoOiBzdHJpbmcpOiBQcm9taXNlPElPRFNPcmdhbmlzYXRpb25SZXN1bHRbXT4ge1xuXG4gICAgICAgIGxldCBwb3N0Qm9keSA9IHtcbiAgICAgICAgICAgIFwic3RhcnRQYWdlXCI6IDEsXG4gICAgICAgICAgICBcImVuZFBhZ2VcIjogMSxcbiAgICAgICAgICAgIFwicm93c1BlclBhZ2VcIjogMTAsXG4gICAgICAgICAgICBcInNlYXJjaFN0cmluZ1wiOiBzZWFyY2gsXG4gICAgICAgICAgICBcIm9kc0VudGl0eVR5cGVzXCI6IFtdLFxuICAgICAgICAgICAgXCJhdmFpbGFiaWxpdHlcIjoge1xuICAgICAgICAgICAgICAgIFwiaXNBdmFpbGFibGVcIjogbnVsbCxcbiAgICAgICAgICAgICAgICBcImlzT3V0T2ZPZmZpY2VcIjogbnVsbCxcbiAgICAgICAgICAgICAgICBcImlzTm90QXZhaWxhYmxlXCI6IG51bGxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBcImxvY2F0aW9uXCI6IHtcbiAgICAgICAgICAgICAgICBcInBvc3Rjb2RlXCI6IG51bGwsXG4gICAgICAgICAgICAgICAgXCJyYW5nZVwiOiAxMFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIFwiY29ubmVjdGlvblwiOiB7XG4gICAgICAgICAgICAgICAgXCJzeXN0ZW1OYW1lXCI6IG51bGxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBcImNvbXBldGVuY2llc1wiOiBbXSxcbiAgICAgICAgICAgIFwidGVhbXNcIjogW10sXG4gICAgICAgICAgICBcInJvbGVzXCI6IFtdLFxuICAgICAgICAgICAgXCJvZHNUeXBlc1wiOiBbXG4gICAgICAgICAgICAgICAgXCJjbGllbnRcIlxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIFwid2FsbE1hbmFnZW1lbnRcIjogZmFsc2VcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHNlYXJjaE9kc0FuZFJldHVyblJvd3M8SU9EU09yZ2FuaXNhdGlvblJlc3VsdD4oc2VhcmNoLHBvc3RCb2R5KTtcbn1cblxuXG4vLyBSZWdpb246IEdldCBhbGwgcm9sZSBjb25maWcgZm9yIHJvbGVcbi8vIFRoaXMgaXMgYSBoZWxwZXIgZnVuY3Rpb24gdG8gZ2V0IGFsbCB0aGUgcm9sZSBjb25maWcgZm9yIGEgZ2l2ZW4gcm9sZVxuLy8gSXQgaXMgdXNlZCBpbiB0aGUgXCJnZXRSb2xlQ29uZmlnRm9yUm9sZVwiIGZ1bmN0aW9uIGJlbG93XG4vLyB0aGUgaW50ZXJmYWNlIGlzIHVzZWQgdG8gcmV0dXJuIHRoZSByZXN1bHRzIG9mIHRoZSBmdW5jdGlvblxuXG4vKipcbiAqIFRoaXMgaW50ZXJmYWNlIGlzIHVzZWQgdG8gcmV0dXJuIHRoZSByZXN1bHRzIG9mIHRoZSBmdW5jdGlvblxuICogQHByb3BlcnR5IHJvbGVDb25maWcgLSB0aGUgcm9sZSBjb25maWcgZm9yIHRoZSBnaXZlbiByb2xlXG4gKiBAcHJvcGVydHkgT0RTRW50aXRpZXMgLSB0aGUgT0RTIGVudGl0aWVzIGZvciB0aGUgZ2l2ZW4gcm9sZVxuICogQm90aCBhcmUgcmV0dXJuZWQgYXMgYm90aCBhcmUgbmVlZGVkIHdoZW4gdXBkYXRpbmcgdGhlIHdpZGdldFxuICovXG5leHBvcnQgaW50ZXJmYWNlIElHZXRBbGxSb2xlQ29uZmlnRm9yUm9sZSB7XG4gICAgcm9sZUNvbmZpZzogSVJvbGVDb25maWdNb2RlbHNbXSxcbiAgICBPRFNFbnRpdGllczogSU9kc1dpZGdldE9EU0VudGl0aWVzW11cbn1cblxuLyoqXG4gKiBUaGlzIGZ1bmN0aW9uIHJldHVybnMgYWxsIHRoZSByb2xlIGNvbmZpZyBmb3IgYSBnaXZlbiByb2xlXG4gKiBAcGFyYW0gYmxhZGUgXG4gKiBAcGFyYW0gcm9sZSBcbiAqIEByZXR1cm5zIFxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0QWxsUm9sZUNvbmZpZ0ZvclJvbGUoYmxhZGU6IFRTaGFyZURvQmxhZGUgfCB1bmRlZmluZWQsIHJvbGU6IHN0cmluZyk6IElHZXRBbGxSb2xlQ29uZmlnRm9yUm9sZSB7XG4gICAgbGV0IHJldFZhbHVlOiBJR2V0QWxsUm9sZUNvbmZpZ0ZvclJvbGUgPVxuICAgIHtcbiAgICAgICAgcm9sZUNvbmZpZzogW10sXG4gICAgICAgIE9EU0VudGl0aWVzOiBbXVxuICAgIH07XG4gICAgaWYgKCFibGFkZSkgcmV0dXJuIHJldFZhbHVlO1xuXG4gICAgbGV0IGFsbE9kc0FzcGVjdHMgPSBnZXRPZHNXaWRnZXRzKGJsYWRlKTtcblxuICAgIC8vIHAub3B0aW9ucy5yb2xlQ29uZmlnTW9kZWxzLmZvckVhY2goKHI6YW55KSA9PiB7XG4gICAgYWxsT2RzQXNwZWN0cz8uZm9yRWFjaChhID0+IHtcblxuICAgICAgICBhLndpZGdldC5vZHNFbnRpdGllcygpLmZvckVhY2gob2RzID0+IHtcbiAgICAgICAgICAgIGlmICghb2RzLnJvbGVTeXN0ZW1OYW1lKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAob2RzLnJvbGVTeXN0ZW1OYW1lKCkgPT09IHJvbGUpIHtcbiAgICAgICAgICAgICAgICByZXRWYWx1ZS5PRFNFbnRpdGllcy5wdXNoKG9kcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG5cbiAgICAgICAgYS53aWRnZXQub3B0aW9ucy5yb2xlQ29uZmlnTW9kZWxzLmZvckVhY2gociA9PiB7XG4gICAgICAgICAgICBpZiAoci5yb2xlU3lzdGVtTmFtZSA9PT0gcm9sZSkge1xuICAgICAgICAgICAgICAgIHJldFZhbHVlLnJvbGVDb25maWcucHVzaChyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcblxuICAgIH0pXG5cbiAgICAvLyBpZighYWxsT2RzQXNwZWN0cykgcmV0dXJuIHJldFZhbHVlO1xuICAgIC8vIGxldCBhc3BlY3RXaXRoUGFydG5lciA9IGFsbE9kc0FzcGVjdHMuZmlsdGVyKGE9PmEud2lkZ2V0Lm9kc0VudGl0aWVzKCkuZmluZCgobzphbnkpPT5vLnJvbGVOYW1lPT09cm9sZSkpO1xuICAgIC8vIGlmKCFhc3BlY3RXaXRoUGFydG5lcikgcmV0dXJuIHJldFZhbHVlO1xuXG4gICAgLy8gZm9yKGxldCBhc3BlY3Qgb2YgYXNwZWN0V2l0aFBhcnRuZXIpXG4gICAgLy8ge1xuICAgIC8vICAgICBsZXQgb2RzUGFydG5lciA9IGFzcGVjdC53aWRnZXQub2RzRW50aXRpZXMoKS5maW5kKChvOmFueSk9Pm8ucm9sZU5hbWU9PT1yb2xlKTtcbiAgICAvLyAgICAgaWYoIW9kc1BhcnRuZXIpIGNvbnRpbnVlO1xuICAgIC8vICAgICByZXRWYWx1ZS5wdXNoKG9kc1BhcnRuZXIpO1xuICAgIC8vIH1cbiAgICByZXR1cm4gcmV0VmFsdWU7XG59XG5cbi8qKlxuICogVGhpcyBmdW5jdGlvbiByZXR1cm5zIGFsbCB0aGUgcm9sZSBjb25maWcgZm9yIGEgZ2l2ZW4gcm9sZVxuICogQHBhcmFtIGJsYWRlXG4gKiBAcGFyYW0gcm9sZVxuICogQHJldHVybnNcbioqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldE9kc1dpZGdldHMoYmxhZGU6IFRTaGFyZURvQmxhZGUpOiBJQXNwZWN0PElPZHNXaWRnZXQ+W10gfCB1bmRlZmluZWQge1xuICAgIGlmICghYmxhZGUpIHJldHVybiB1bmRlZmluZWQ7XG5cbiAgICBsZXQgdHlwZVRvQ2hlY2sgPSBTaGFyZWRvLkNvcmUuQ2FzZS5Bc3BlY3RzLldpZGdldHMuT2RzRW50aXR5UGlja2VyO1xuXG4gICAgbGV0IHJldFZhbHVlID0gYmxhZGUuYXNwZWN0cygpLmZpbHRlcihhID0+IGEud2lkZ2V0IGluc3RhbmNlb2YgdHlwZVRvQ2hlY2spO1xuICAgIHJldHVybiByZXRWYWx1ZTtcblxufVxuXG4vLyAjcmVnaW9uIEdldCBhbGwgcm9sZSBjb25maWcgZm9yIHJvbGVcbi8vICNyZWdpb24gcHJpdmF0ZSBmdW5jdGlvbnNcbi8qKlxuICogVXNlcyB0aGUgXCIvYXBpL29kcy9fc2VhcmNoXCIgZW5kcG9pbnQgdG8gc2VhcmNoIGZvciBjbGllbnRzLlxuICogQHBhcmFtIHNlYXJjaCBUaGUgc2VhcmNoIHN0cmluZyB0byB1c2Ugc3VjaCBhcyBjbGllbnQgY29kZSBvciBuYW1lXG4gKiBAcmV0dXJucyBBIGxpc3Qgb2YgY2xpZW50c1xuICovXG5hc3luYyBmdW5jdGlvbiBzZWFyY2hPZHNBbmRSZXR1cm5Sb3dzPFQ+KHNlYXJjaDogc3RyaW5nLHBvc3RCb2R5OmFueSk6IFByb21pc2U8VFtdPiB7XG4gICAgbGV0IEFQSVJlc3VsdCA9IGF3YWl0IF9zZWFyY2g8VD4ocG9zdEJvZHkpO1xuICAgIC8vbG9nIGNvbG9yXG4gICAgY29uc29sZS5sb2coXCIlYyBPRFMgU2VhcmNoIFJlc3VsdFwiLCBcImNvbG9yOiAjZmYwMDAwXCIsIEFQSVJlc3VsdCk7XG4gICAgaWYoIUFQSVJlc3VsdCkgXG4gICAge1xuICAgICAgICBjb25zb2xlLmxvZyhcIiVjIE9EUyBTZWFyY2ggUmVzdWx0IC0gdW5kZWZpbmVkXCIsIFwiY29sb3I6ICNmZjAwMDBcIik7XG4gICAgICAgIHJldHVybiBbXTsgIFxuICAgIH1cbiAgICBjb25zb2xlLmxvZyhcIiVjIE9EUyBTZWFyY2ggUmVzdWx0XCIsIFwiY29sb3I6ICNmZjAwMDBcIiwgQVBJUmVzdWx0KTtcbiAgICByZXR1cm4gZXh0cmFjdFJvd3NGcm9tT0RTU2VhcmNoUmVzdWx0czxUPihBUElSZXN1bHQpO1xuICBcbn1cblxuZnVuY3Rpb24gZXh0cmFjdFJvd3NGcm9tT0RTU2VhcmNoUmVzdWx0czxUPiggQVBJUmVzdWx0OiBJT0RTZWFyY2hSZXN1bHQ8VD4pIDogVFtdXG4ge1xuICAgIHRyeVxuICAgIHtcbiAgICAgICAgbGV0IHJldFZhbHVlID0gQVBJUmVzdWx0LnJvd3MubWFwKHIgPT4gSlNPTi5wYXJzZShyLnJlc3VsdCkpO1xuICAgICAgICByZXR1cm4gcmV0VmFsdWU7XG4gICAgfVxuICAgIGNhdGNoKGUpXG4gICAge1xuICAgICAgICBjb25zb2xlLndhcm4oXCJPRFMgSGVscGVyIEVycm9yIHRyeWluZyB0byBleHRyYWN0IHJvd3MgZnJvbSBzZWFyY2ggcmVzdWx0XCIsIGUsQVBJUmVzdWx0KTtcbiAgICB9XG4gICAgcmV0dXJuIFtdO1xufVxuXG5cblxuLy8gI2VuZHJlZ2lvbiBwcml2YXRlIGZ1bmN0aW9ucyIsImltcG9ydCB7IElPRFNTZWFyY2hQb3N0Qm9keSB9IGZyb20gXCIuLi8uLi8uLi8uLi9UeXBpbmdzL2FwaS9vZHMvX3NlYXJjaFwiO1xuaW1wb3J0IHsgSU9EU2VhcmNoUmVzdWx0IH0gZnJvbSBcIi4uLy4uLy4uLy4uL1R5cGluZ3MvT2RzTGlzdC9JT0RTU2VhcmNoUmVzdWx0XCI7XG5pbXBvcnQgeyBleGVjdXRlUG9zdCB9IGZyb20gXCIuLi9hcGlcIjtcblxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gX3NlYXJjaDxUPihwb3N0Qm9keTpJT0RTU2VhcmNoUG9zdEJvZHkpIDogUHJvbWlzZTxJT0RTZWFyY2hSZXN1bHQ8VD4gfCB1bmRlZmluZWQ+XG57XG4gICAgdHJ5XG4gICAge1xuICAgICAgICBsZXQgYXBpID0gXCIvYXBpL29kcy9fc2VhcmNoXCI7XG4gICAgICAgIHJldHVybiBhd2FpdCBleGVjdXRlUG9zdDxJT0RTZWFyY2hSZXN1bHQ8VD4+KHdpbmRvdy5kb2N1bWVudC5sb2NhdGlvbi5vcmlnaW4gKyBhcGksIHBvc3RCb2R5KTtcbiAgICB9XG4gICAgY2F0Y2ggKGUpXG4gICAge1xuICAgICAgICBjb25zb2xlLndhcm4oXCJPRFMgU2VhcmNoIEVycm9yXCIsIGUscG9zdEJvZHkpO1xuICAgIH1cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xufVxuXG4iLCJcbmltcG9ydCB7IElGb3JtQnVpbGRlckNvbnRleHQgfSBmcm9tIFwiLi4vLi4vLi4vLi4vVHlwaW5ncy9Gb3JtQnVpbGRlci9JRm9ybUJ1aWxkZXJDb250ZXh0XCI7XG5pbXBvcnQgeyBJU2hhcmVEb09wdGlvblNldCB9IGZyb20gXCIuLi8uLi8uLi8uLi9UeXBpbmdzL09wdGlvblNldHMvSVNoYXJlRG9PcHRpb25TZXRcIjtcbmltcG9ydCB7IElPZHNFbnRpdHkgfSBmcm9tIFwiLi4vLi4vLi4vLi4vVHlwaW5ncy9XaWRnZXRzT2RzRW50aXR5UGlja2VyL0lPZHNFbnRpdHlcIjtcbmltcG9ydCB7ICBnZXRBbGxSb2xlQ29uZmlnRm9yUm9sZSwgc2VhcmNoRm9yQ2xpZW50cywgc2VhcmNoRm9yVXNlcnMgfSBmcm9tIFwiLi4vLi4vLi4vQ29tbW9uL09kc0hlbHBlclwiO1xuaW1wb3J0IHsgZXhlY3V0ZUdldCB9IGZyb20gXCIuLi8uLi8uLi9Db21tb24vYXBpL2FwaVwiO1xuaW1wb3J0IHsgRm9ybUJ1aWxkZXIgfSBmcm9tIFwiLi4vLi4vLi4vTW9kdWxlTG9hZGVyL0FscGhhY2FBZGFwdGVyXCI7XG5pbXBvcnQgeyBJRXhwZXJ0TWF0dGVyIH0gZnJvbSBcIi4uL1R5cGluZ3MvSUV4cGVydE1hdHRlckRhdGFcIjtcblxudHlwZSBPZHNXaWRnZXQgPSB7XG4gICAgW2tleTpzdHJpbmddOiBhbnlcbn07XG5cbi8vY29uc3RhbnRzIFxuY29uc3QgbWF0dGVyUGFydG5lclJvbGVTeXN0ZW1OYW1lID0gXCJtYXR0ZXItcGFydG5lclwiO1xuY29uc3QgY2xpZW50Um9sZVN5c3RlbU5hbWUgPSBcImNsaWVudFwiO1xuXG4vL1RoaXMgZnVuY3Rpb24gaXMgY2FsbGVkIGZyb20gdGhlIG1vZHVsZS1sb2FkZXIgd2ViY29tcG9uZW50IGluIHRoZSBmb3JtIGJ1aWxkZXJcbmV4cG9ydCBmdW5jdGlvbiBydW5NZShjb250ZXh0OiBJRm9ybUJ1aWxkZXJDb250ZXh0KSA6IGJvb2xlYW4ge1xuICAgXG4gICAgbGV0IHsgZXhwZXJ0TWF0dGVyTnVtYmVyLCBtYXR0ZXJEZXRhaWxzLCBwaXBlbGluZU1hdHRlciB9ID0gY3JlYXRlVmFyaWFibGVzKGNvbnRleHQpO1xuXG4gICAgaWYoIWV4cGVydE1hdHRlck51bWJlcikgdGhyb3cgbmV3IEVycm9yKFwiTm8gZXhwZXJ0TWF0dGVyTnVtYmVyXCIpO1xuICAgIGlmKCFtYXR0ZXJEZXRhaWxzKSB0aHJvdyBuZXcgRXJyb3IoXCJObyBtYXR0ZXJEZXRhaWxzXCIpO1xuICAgIGlmKCFwaXBlbGluZU1hdHRlcikgdGhyb3cgbmV3IEVycm9yKFwiTm8gcGlwZWxpbmVNYXR0ZXJcIik7XG4gICAgXG4gICAgKHdpbmRvdyBhcyBhbnkpLnRlc3RlciA9IGNvbnRleHQ7IC8vanVzdCBmb3IgZGVidWdnaW5nXG4gICAgXG4gICAgaWYoY29udGV4dC53b3JrSXRlbUNvbnRleHQuaWQoKSAhPT0gdW5kZWZpbmVkKVxuICAgIHtcbiAgICAgICAgbGV0IGV4aXQgPSB0cnVlO1xuICAgICAgICAvL2lmIHRoZSB3b3JrIGl0ZW0gaXMgbmV3IG9yIGluIGRyYWZ0IGRvbnQgZXhpdFxuICAgICAgICBpZihjb250ZXh0LndvcmtJdGVtQ29udGV4dD8ucGhhc2VOYW1lKCk/LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJkcmFmdFwiKSB8fCAhY29udGV4dC53b3JrSXRlbUNvbnRleHQ/LnBoYXNlTmFtZSgpKVxuICAgICAgICB7XG4gICAgICAgICAgICBleGl0ID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGlmKGV4aXQ9PT10cnVlKVxuICAgICAgICB7XG4gICAgICAgICAgICAgLy9vbmx5IHJ1biB0aGlzIGNvZGUgaWYgdGhlIHdvcmsgaXRlbSBpcyBuZXdcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiJWMgW01vZHVsZUxvYWRlcl0gRkJfTWF0dGVyRGV0YWlscyAtIGV4aXQgKG9ubHkgcnVuIG9uIG5ldylcIiwgXCJiYWNrZ3JvdW5kOiAjMjIyOyBjb2xvcjogI2JhZGE1NVwiLCBjb250ZXh0LndvcmtJdGVtQ29udGV4dC5pZCgpKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiJWMgW01vZHVsZUxvYWRlcl0gY29udGV4dC53b3JrSXRlbUNvbnRleHQuaWQoKSBcIiwgXCJiYWNrZ3JvdW5kOiAjMjIyOyBjb2xvcjogI2JhZGE1NVwiLCBjb250ZXh0LndvcmtJdGVtQ29udGV4dC5pZCgpKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiJWMgW01vZHVsZUxvYWRlcl0gY29udGV4dC53b3JrSXRlbUNvbnRleHQ/LnBoYXNlTmFtZSgpIFwiLCBcImJhY2tncm91bmQ6ICMyMjI7IGNvbG9yOiAjYmFkYTU1XCIsIGNvbnRleHQud29ya0l0ZW1Db250ZXh0Py5waGFzZU5hbWUoKSk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgICh3aW5kb3cgYXMgYW55KS5hc3BlY3REZWJ1Z2VyID0gKHdpbmRvdyBhcyBhbnkpLmFzcGVjdERlYnVnZXIgfHwge307XG4gICAgKHdpbmRvdyBhcyBhbnkpLmFzcGVjdERlYnVnZXIubWF0dGVyRGV0YWlsc0Zvcm1CdWlsZGVyID0gbWF0dGVyRGV0YWlscztcblxuICAgIGhpZGVTaG93TWF0dGVyRGV0YWlscyhtYXR0ZXJEZXRhaWxzLCBleHBlcnRNYXR0ZXJOdW1iZXIsIHBpcGVsaW5lTWF0dGVyKTtcbiAgICAvL2FkZCBhIGNoYW5nZSBldmVudCB0byB0aGUgZXhwZXJ0LW1hdHRlci1udW1iZXJcbiAgICBhZGRFdmVudEhhbmRsZXJzKGNvbnRleHQsIG1hdHRlckRldGFpbHMsIGV4cGVydE1hdHRlck51bWJlciwgcGlwZWxpbmVNYXR0ZXIpO1xuICAgIGdlbmVyYXRlVGVtcE1hdHRlck51bWJlcihjb250ZXh0KTtcblxuICAgICR1aS5ldmVudHMuYnJvYWRjYXN0KFwic2NyaXB0Lm1hdHRlckRldGFpbHNMb2FkZWRcIiwgY29udGV4dCk7XG4gICAgcmV0dXJuIHRydWU7XG59XG5cbi8vIFRoaXMgZnVuY3Rpb24gY3JlYXRlcyB2YXJpYWJsZXMgZm9yIHRoZSBmb3JtLlxuZnVuY3Rpb24gY3JlYXRlVmFyaWFibGVzKGNvbnRleHQ6IElGb3JtQnVpbGRlckNvbnRleHQpIHtcbiAgICAvLyBHZXQgdGhlIGZpZWxkc1xuICAgIC8vIGxldCBtYXR0ZXJEZXRhaWxzID0gY29udGV4dC5maWVsZHNbZW51bUZpZWxkcy5tYXR0ZXJEZXRhaWxzXTtcblxuICAgIGlmKCFjb250ZXh0LmZvcm0pIHRocm93IG5ldyBFcnJvcihcIk5vIGZvcm1cIik7XG5cbiAgICBsZXQgbWF0dGVyRGV0YWlscyA9IGNvbnRleHQuZm9ybS5maWVsZHNCeUlkW2VudW1GaWVsZHMubWF0dGVyRGV0YWlsc107IFxuICAgIGxldCBleHBlcnRNYXR0ZXJOdW1iZXIgPSBjb250ZXh0LmZvcm0uZmllbGRzQnlJZFtlbnVtRmllbGRzLmV4cGVydE1hdHRlck51bWJlcl07XG4gICAgbGV0IHBpcGVsaW5lTWF0dGVyID0gY29udGV4dC5mb3JtLmZpZWxkc0J5SWRbZW51bUZpZWxkcy5waXBlbGluZU1hdHRlcl07XG4gICAgXG5cbiAgICAvLyBSZXR1cm4gdGhlIHZhcmlhYmxlc1xuICAgIHJldHVybiB7IGV4cGVydE1hdHRlck51bWJlciwgbWF0dGVyRGV0YWlscywgcGlwZWxpbmVNYXR0ZXIgfTtcbn1cblxuZnVuY3Rpb24gYWRkRXZlbnRIYW5kbGVycyhjb250ZXh0OiBJRm9ybUJ1aWxkZXJDb250ZXh0LCBtYXR0ZXJEZXRhaWxzOiBGb3JtQnVpbGRlciwgZXhwZXJ0TWF0dGVyTnVtYmVyOiBGb3JtQnVpbGRlciwgcGlwZWxpbmVNYXR0ZXI6IEZvcm1CdWlsZGVyKSB7XG4gICAgaWYoIWNvbnRleHQuZm9ybSkgdGhyb3cgbmV3IEVycm9yKFwiTm8gZm9ybVwiKTtcbiAgICAvL2FkZCBldmVudCBoYW5kbGV0IGZvciBleHBlcnQtbWF0dGVyLW51bWJlciBjaGFuZ2VkXG4gICAgbWF0dGVyRGV0YWlscy5maWVsZHNCeUlkW2VudW1NYXR0ZXJEZXRhaWxGaWVsZHMubWF0dGVyRGV0YWlsc1BhcnRuZXJOYW1lXT8ub24oXCJjaGFuZ2VcIiwgZnVuY3Rpb24gKHRoaXM6IGFueSwgZXY6IGFueSkge1xuICAgICAgICBjb25zb2xlLmxvZyhcIiVjIFBhcnRuZXIgbmFtZSBjaGFuZ2VkIHRvOiBcIiArIG1hdHRlckRldGFpbHMuZmllbGRzQnlJZFtlbnVtTWF0dGVyRGV0YWlsRmllbGRzLm1hdHRlckRldGFpbHNQYXJ0bmVyTmFtZV0/LmdldFZhbHVlKCksIFwiY29sb3I6IHBpbms7IGZvbnQtc2l6ZTogMjBweDtcIik7XG4gICAgfSk7XG5cbiAgICAvL2FkZCBldmVudCBoYW5kbGV0IGZvciBleHBlcnQtbWF0dGVyLW51bWJlciBjaGFuZ2VkXG4gICAgY29udGV4dC5mb3JtLmZpZWxkc0J5SWRbZW51bUZpZWxkcy5leHBlcnRNYXR0ZXJOdW1iZXJdPy5vbihcImNoYW5nZVwiLCBmdW5jdGlvbiAodGhpczogYW55LCBldjogYW55KSB7XG4gICAgICAgIC8vIGhpZGUgb3Igc2hvdyB0aGUgbWF0dGVyIGRldGFpbHMgZmllbGRcbiAgICAgICAgaGlkZVNob3dNYXR0ZXJEZXRhaWxzKG1hdHRlckRldGFpbHMsIGV4cGVydE1hdHRlck51bWJlciwgcGlwZWxpbmVNYXR0ZXIpO1xuICAgICAgICAvLyB1cGRhdGUgdGhlIG1hdHRlciBkZXRhaWxzIGZpZWxkXG4gICAgICAgIHVwZGF0ZU1hdHRlckRldGFpbHMoY29udGV4dCxtYXR0ZXJEZXRhaWxzLCBleHBlcnRNYXR0ZXJOdW1iZXIsIHBpcGVsaW5lTWF0dGVyKTtcbiAgICB9KTtcblxuICAgIC8vYWRkIGV2ZW50IGhhbmRsZXQgZm9yIHBpcGVsaW5lLW1hdHRlciBjaGFuZ2VkXG4gICAgY29udGV4dC5mb3JtLmZpZWxkc0J5SWRbZW51bUZpZWxkcy5waXBlbGluZU1hdHRlcl0/Lm9uKFwiY2hhbmdlXCIsIGZ1bmN0aW9uICh0aGlzOiBhbnksIGV2OiBhbnkpIHtcbiAgICAgICAgLy8gaGlkZSBvciBzaG93IHRoZSBtYXR0ZXIgZGV0YWlscyBmaWVsZFxuICAgICAgICBoaWRlU2hvd01hdHRlckRldGFpbHMobWF0dGVyRGV0YWlscywgZXhwZXJ0TWF0dGVyTnVtYmVyLCBwaXBlbGluZU1hdHRlcik7XG4gICAgICAgIC8vIHVwZGF0ZSB0aGUgbWF0dGVyIGRldGFpbHMgZmllbGRcbiAgICAgICAgdXBkYXRlTWF0dGVyRGV0YWlscyhjb250ZXh0LG1hdHRlckRldGFpbHMsIGV4cGVydE1hdHRlck51bWJlciwgcGlwZWxpbmVNYXR0ZXIpOyBcbiAgICB9KTtcblxuICAgIC8vYWRkIGV2ZW50IGhhbmRsZXQgZm9yIGp1cmlzZGljdGlvbiBjaGFuZ2VkXG4gICAgLy91cGRhdGUgdGhlIE9PQiBKdXJpc2RpY3Rpb24gYXNwZWN0IGZpZWxkIGFuZCBmb3JtYnVpbGRlciBmaWVsZHNcbiAgICBjb250ZXh0LmZvcm0uZmllbGRzQnlJZFtlbnVtRmllbGRzLmp1cmlzZGljdGlvbnNDb3VudHJ5XT8ub24oXCJjaGFuZ2VcIiwgYXN5bmMgZnVuY3Rpb24gKHRoaXM6IGFueSwgZXY6IGFueSkge1xuICAgICAgICAvL3VwZGF0ZSBibGFkZSBqdXJpc2RpY3Rpb24gICAgIFxuICAgICAgICBsZXQgc2VsZWN0ZWRJZCA9IGNvbnRleHQuZm9ybT8uZmllbGRzQnlJZFtcImp1cmlzZGljdGlvbnMtY291bnRyeVwiXT8uZ2V0VmFsdWUoKTtcbiAgICAgICAgY29uc29sZS5sb2coXCIlYyBKdXJpc2RpY3Rpb24gY2hhbmdlZCB0bzogXCIgKyBjb250ZXh0LmZvcm0/LmZpZWxkc0J5SWRbXCJqdXJpc2RpY3Rpb25zLWNvdW50cnlcIl0/LmdldFZhbHVlKCksIFwiY29sb3I6IHJlZDsgZm9udC1zaXplOiAyMHB4O1wiKTtcbiAgICAgICAgbGV0IGFzcGVjdCA9IGNvbnRleHQuZ2V0QXNwZWN0KFwiU2hhcmVkby5Db3JlLkxlZ2FsLkFzcGVjdHMuV2lkZ2V0cy5JbnN0cnVjdGlvbldvcmtUeXBlRGV0YWlsc1wiKTtcbiAgICAgICAgbGV0IHNlbGVjdGVkSnVyaXNkaWN0aW9uQ291bnRyeSA9IGF3YWl0ICRhamF4LmdldCgvKiB3ZWJwYWNrSWdub3JlOiB0cnVlICovYC9hcGkvdjEvcHVibGljL21vZGVsbGVyL29wdGlvblNldHMvYWxsVmFsdWVzLyR7c2VsZWN0ZWRJZH1gKSBhcyBJU2hhcmVEb09wdGlvblNldDtcbiAgICAgICAgaWYgKCFzZWxlY3RlZEp1cmlzZGljdGlvbkNvdW50cnkpIHtcbiAgICAgICAgICAgIC8vbG9nIGlzc3VlXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIiVjIFtNb2R1bGVMb2FkZXJdIGdldEFzcGVjdCByZXR1cm4gdmFsdWVcIiwgXCJiYWNrZ3JvdW5kOiAjMjIyOyBjb2xvcjogI2JhZGE1NVwiLCBzZWxlY3RlZEp1cmlzZGljdGlvbkNvdW50cnkpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGxldCBvcHRpb25zID0gYXdhaXQgJGFqYXguZ2V0KC8qIHdlYnBhY2tJZ25vcmU6IHRydWUgKi9gL2FwaS92MS9wdWJsaWMvbW9kZWxsZXIvb3B0aW9uU2V0cy9qdXJpc2RpY3Rpb25zL3ZhbHVlc2ApO1xuICAgICAgICBsZXQgc2VsZWN0ZWRKdXJpc2RpY3Rpb24gPSBvcHRpb25zLmZpbmQoKG9wdGlvbjogSVNoYXJlRG9PcHRpb25TZXQpID0+IG9wdGlvbi5uYW1lID09PSBzZWxlY3RlZEp1cmlzZGljdGlvbkNvdW50cnkubmFtZSk7XG4gICAgICAgIGlmICghc2VsZWN0ZWRKdXJpc2RpY3Rpb24pIHtcbiAgICAgICAgICAgIC8vbG9nIGlzc3VlXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIiVjIFtNb2R1bGVMb2FkZXJdIGdldEFzcGVjdCByZXR1cm4gdmFsdWVcIiwgXCJiYWNrZ3JvdW5kOiAjMjIyOyBjb2xvcjogI2JhZGE1NVwiLCBzZWxlY3RlZEp1cmlzZGljdGlvbik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgYXNwZWN0LndpZGdldC5pbnN0cnVjdGlvbi5qdXJpc2RpY3Rpb25JZChzZWxlY3RlZEp1cmlzZGljdGlvbi5pZCk7XG4gICAgfSk7XG59XG5cbi8vIGhpZGUgb3Igc2hvdyB0aGUgbWF0dGVyIGRldGFpbHMgZmllbGRcbmZ1bmN0aW9uIGhpZGVTaG93TWF0dGVyRGV0YWlscyhtYXR0ZXJEZXRhaWxzOiBGb3JtQnVpbGRlciAsIGV4cGVydE1hdHRlck51bWJlcjogRm9ybUJ1aWxkZXIsIHBpcGVsaW5lTWF0dGVyOiBGb3JtQnVpbGRlcikge1xuICAgIHNldE1hdHRlckRldGFpbHNTdGF0ZShtYXR0ZXJEZXRhaWxzLCBwaXBlbGluZU1hdHRlci5nZXRWYWx1ZSgpKTtcbn1cblxuLy8gbWFrZSBhbGwgY2hpbGQgcHJvcGVydGllcyByZWFkb25seVxuZnVuY3Rpb24gc2V0TWF0dGVyRGV0YWlsc1N0YXRlKG1hdHRlckRldGFpbHM6IEZvcm1CdWlsZGVyLCBzdGF0dXM6IGJvb2xlYW4gPSB0cnVlKSB7XG4gICAgaWYoIW1hdHRlckRldGFpbHMuZmllbGRzKSB0aHJvdyBuZXcgRXJyb3IoXCJObyBmaWVsZHNcIik7XG4gICAgaWYoIW1hdHRlckRldGFpbHMuZmllbGRzQnlJZCkgdGhyb3cgbmV3IEVycm9yKFwiTm8gZmllbGRzQnlJZFwiKTtcbiAgICAvLyBnZXQgYWxsIHRoZSBjaGlsZCBwcm9wZXJ0aWVzXG4gICAgbWF0dGVyRGV0YWlscy5maWVsZHMuZm9yRWFjaChjaGlsZCA9PlxuICAgIHtcbiAgICAgICAgLy8gc2V0IHRoZSByZWFkb25seSBzdGF0dXMgb2YgdGhlIGNoaWxkIHByb3BlcnR5XG4gICAgICAgIGNoaWxkLnJlYWRvbmx5KCFzdGF0dXMpO1xuICAgIH0pO1xuXG4gICAgLy8gc2V0IHRoZSByZWFkb25seSBzdGF0dXMgb2YgdGhlIG1hdHRlciBkZXRhaWxzIHN1YiBhcmVhXG4gICAgbWF0dGVyRGV0YWlscy5maWVsZHNCeUlkW2VudW1NYXR0ZXJEZXRhaWxGaWVsZHMubWF0dGVyRGV0YWlsc0liTGFzdENoZWNrZWRdPy5oaWRkZW4odHJ1ZSk7XG59XG5cbi8vIGNsZWFyIGFsbCB0aGUgY2hpbGQgcHJvcGVydGllcyBvZiB0aGUgbWF0dGVyIGRldGFpbHMgc3ViIGFyZWEgb2YgdGhlIGZvcm0gYnVpbGRlclxuYXN5bmMgZnVuY3Rpb24gY2xlYXJNYXR0ZXJEZXRhaWxzKG1hdHRlckRldGFpbHM6IEZvcm1CdWlsZGVyKSB7XG4gICAgbWF0dGVyRGV0YWlscy5maWVsZHM/LmZvckVhY2goZnVuY3Rpb24gKGNoaWxkOiBhbnkpIHtcbiAgICAgICAgY2hpbGQuc2V0VmFsdWUoXCJcIik7XG4gICAgfSk7IFxufVxuXG5cbi8qIFxuMS4gV2UgZmlyc3QgZ2V0IHRoZSBkYXRhIGZyb20gdGhlIGVuZHBvaW50IGJ5IGNhbGxpbmcgZ2V0TWF0dGVyRGF0YSgpIGZ1bmN0aW9uXG4yLiBUaGVuIHdlIGNsZWFyIHRoZSBtYXR0ZXJEZXRhaWxzXG4zLiBXZSBmaW5kIHRoZSBzZWxlY3RlZCBtYXR0ZXIgYnkgdXNpbmcgdGhlIG1hdHRlciBjb2RlIGFuZCBjbGllbnQgY29kZSBmcm9tIHRoZSBkYXRhIHdlIGdvdCBmcm9tIHRoZSBlbmRwb2ludFxuNC4gSWYgdGhlIG1hdHRlciBpcyB1bmRlZmluZWQsIHdlIGNsZWFyIHRoZSBtYXR0ZXJEZXRhaWxzIGFuZCByZXR1cm5cbjUuIElmIHRoZSBtYXR0ZXIgaXMgbm90IHVuZGVmaW5lZCwgd2Ugc2V0IHRoZSB2YWx1ZXMgb2YgdGhlIG1hdHRlckRldGFpbHMgZmllbGRzICovXG5hc3luYyBmdW5jdGlvbiB1cGRhdGVNYXR0ZXJEZXRhaWxzKGNvbnRleHQ6IElGb3JtQnVpbGRlckNvbnRleHQsbWF0dGVyRGV0YWlsczogRm9ybUJ1aWxkZXIsIGV4cGVydE1hdHRlck51bWJlcjogRm9ybUJ1aWxkZXIsIHBpcGVsaW5lTWF0dGVyOiBGb3JtQnVpbGRlcikge1xuXG4gICAgXG4gICAgbGV0IGRhdGEgPSBhd2FpdCBnZXRNYXR0ZXJEYXRhKGV4cGVydE1hdHRlck51bWJlci5nZXRWYWx1ZSgpKTtcbiAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAvL2NsZWFyTWF0dGVyRGV0YWlscyhtYXR0ZXJEZXRhaWxzKTsgLy9jbGVhciB0aGUgbWF0dGVyIGRldGFpbHMgZm9ybVxuICAgIGxldCBzZWxlY3RlZE1hdHRlciA9IGRhdGEuZmluZChmdW5jdGlvbiAobWF0dGVyOiBhbnkpIHtcbiAgICAgICAgLy9zZXQgdGhlIGRpc3BsYXkgcG9ydGlvbiBvZiB0aGUgZXhwZXJ0LW1hdHRlci1udW1iZXIgZmllbGRcbiAgICAgICAvLyByZXR1cm4gZXhwZXJ0TWF0dGVyTnVtYmVyLmdldFZhbHVlKCkgPT09IGAke21hdHRlci5kYXRhLm1hdHRlckNvZGV9IC0gJHttYXR0ZXIuZGF0YS5jbGllbnQubmFtZX1gO1xuICAgICAgIHJldHVybiBleHBlcnRNYXR0ZXJOdW1iZXIuZ2V0VmFsdWUoKSA9PT0gbWF0dGVyLmRhdGEubWF0dGVyQ29kZTtcbiAgICAgICAgXG4gICAgfSk7XG5cbiAgICBpZiAoc2VsZWN0ZWRNYXR0ZXIgPT09IHVuZGVmaW5lZCB8fCBwaXBlbGluZU1hdHRlci5nZXRWYWx1ZSgpID09PSB0cnVlKSB7IC8vaWYgdGhlIG1hdHRlciBpcyBub3QgZm91bmQgb3IgaWYgdGhlIG1hdHRlciBpcyBhIHBpcGVsaW5lIG1hdHRlciwgY2xlYXIgdGhlIG1hdHRlciBkZXRhaWxzIGZvcm0gYW5kIHJldHVyblxuICAgICAgICBjbGVhck1hdHRlckRldGFpbHMobWF0dGVyRGV0YWlscyk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZighbWF0dGVyRGV0YWlscy5wYXJlbnQ/LmZpZWxkc0J5SWQpIHRocm93IG5ldyBFcnJvcihcIk5vIGNsaWVudFwiKTtcbiAgICBsZXQgdGVtcE1hdHRlck51bWJlciA9IG1hdHRlckRldGFpbHMucGFyZW50Py5maWVsZHNCeUlkWyd0ZW1wLW1hdHRlci1udW1iZXInXT8uZ2V0VmFsdWUoKTtcblxuICAgIGlmICh0ZW1wTWF0dGVyTnVtYmVyID09PSB1bmRlZmluZWQgfHwgdGVtcE1hdHRlck51bWJlci5sZW5ndGggPT09IDApIHtcbiAgICAgICAgLy8gbWF0dGVyRGV0YWlscy5wYXJlbnQuY2hpbGRyZW5CeVByb3BlcnR5SWRbJ3RlbXAtbWF0dGVyLW51bWJlciddLnNldFZhbHVlKFwiTi9BXCIpO1xuICAgIH1cblxuICAgICAvL3NldCB0aGUgdmFsdWUgcG9ydGlvbiBvZiB0aGUgZXhwZXJ0LW1hdHRlci1udW1iZXIgZmllbGRcbiAgICAgY29udGV4dC5mb3JtPy5maWVsZHNCeUlkW2VudW1GaWVsZHMuZXhwZXJ0TWF0dGVyTnVtYmVyVmFsdWVdPy5zZXRWYWx1ZShzZWxlY3RlZE1hdHRlcj8uZGF0YT8ubWF0dGVyQ29kZSB8fCBcIlwiKTtcbiAgICAgICBcblxuICAgIG1hdHRlckRldGFpbHMuZmllbGRzQnlJZFtlbnVtTWF0dGVyRGV0YWlsRmllbGRzLm1hdHRlckRldGFpbHNDbGllbnROYW1lXT8uc2V0VmFsdWUoc2VsZWN0ZWRNYXR0ZXI/LmRhdGE/LmNsaWVudD8ubmFtZSB8fCBcIlwiKTtcbiAgICBtYXR0ZXJEZXRhaWxzLmZpZWxkc0J5SWRbZW51bU1hdHRlckRldGFpbEZpZWxkcy5tYXR0ZXJEZXRhaWxzQ2xpZW50Q29kZV0/LnNldFZhbHVlKHNlbGVjdGVkTWF0dGVyPy5kYXRhPy5jbGllbnQ/LmNvZGUgfHwgXCJcIik7XG4gICAvLyBtYXR0ZXJEZXRhaWxzLmZpZWxkc0J5SWRbZW51bU1hdHRlckRldGFpbEZpZWxkcy5tYXR0ZXJEZXRhaWxzUHJhY3RpY2VBcmVhXT8uc2V0VmFsdWUoc2VsZWN0ZWRNYXR0ZXI/LmRhdGE/LnByYWN0aWNlQXJlYT8ubmFtZSB8fCBcIlwiKTtcbiAgICBtYXR0ZXJEZXRhaWxzLmZpZWxkc0J5SWRbZW51bU1hdHRlckRldGFpbEZpZWxkcy5tYXR0ZXJEZXRhaWxzTmFtZV0/LnNldFZhbHVlKHNlbGVjdGVkTWF0dGVyPy5kYXRhPy5zaG9ydE5hbWUgfHwgXCJcIik7XG4gICAgbWF0dGVyRGV0YWlscy5maWVsZHNCeUlkW2VudW1NYXR0ZXJEZXRhaWxGaWVsZHMubWF0dGVyRGV0YWlsc1BhcnRuZXJOYW1lXT8uc2V0VmFsdWUoc2VsZWN0ZWRNYXR0ZXI/LmRhdGE/LnBhcnRuZXI/Lm5hbWUgfHwgXCJcIik7XG4gICAgbWF0dGVyRGV0YWlscy5maWVsZHNCeUlkW2VudW1NYXR0ZXJEZXRhaWxGaWVsZHMubWF0dGVyRGV0YWlsc0liXT8uc2V0VmFsdWUoc2VsZWN0ZWRNYXR0ZXI/LmRhdGE/LnNlY3VyZSB8fCBcIlwiKTtcblxuICAgIGNvbnNvbGUubG9nKFwibWF0dGVyRGV0YWlscy5pc1ZhbGlkKCk6XCIgKyBtYXR0ZXJEZXRhaWxzLmlzVmFsaWQoKSk7XG5cblxuICAgIHRyeVxuICAgIHtcbiAgICAgICAgdHJ5VXBkYXRlQ2xpZW50T2RzUGlja2VyKHNlbGVjdGVkTWF0dGVyLCBjb250ZXh0KTtcbiAgICB9XG4gICAgY2F0Y2goZSlcbiAgICB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiRmFpbGVkIHRvIGF1dG8gdXBkYXRpbmcgb2RzIHBpY2tlcnMsIHVzZXIgcmVxdWlyZWQgdG8gc2VsZWN0IG1hbnVhbGx5XCIpO1xuICAgIH1cblxuICAgIHRyeVxuICAgIHtcbiAgICAgICAgdHJ5VXBkYXRlUGFydG5lck9kc1BpY2tlcihzZWxlY3RlZE1hdHRlciwgY29udGV4dCk7XG4gICAgfVxuICAgIGNhdGNoKGUpXG4gICAge1xuICAgICAgICBjb25zb2xlLmxvZyhcIkZhaWxlZCB0byBhdXRvIHVwZGF0aW5nIG9kcyBwaWNrZXJzLCB1c2VyIHJlcXVpcmVkIHRvIHNlbGVjdCBtYW51YWxseVwiKTtcbiAgICB9XG4gICAgXG59XG5cblxuLyoqXG4gKiBUcnkgdG8gdXBkYXRlIHRoZSBjbGllbnQgb2RzIHBpY2tlciB1c2luZyB0aGUgc2VsZWN0ZWQgbWF0dGVyIFxuICogVXNlcyBzZWFyY2hGb3JDbGllbnQgZnVuY3Rpb24gd2hpYyBpcyBhIGNvbW1vbiBvZHMgaGVscGVyIGZ1bmN0aW9uXG4gKiBAcGFyYW0gc2VsZWN0ZWRNYXR0ZXIgVGhlIHNlbGVjdGVkIG1hdHRlclxuICogQHBhcmFtIGNvbnRleHQgVGhlIGZvcm0gYnVpbGRlciBjb250ZXh0XG4gKi9cbmZ1bmN0aW9uIHRyeVVwZGF0ZUNsaWVudE9kc1BpY2tlcihzZWxlY3RlZE1hdHRlcjogSUV4cGVydE1hdHRlciwgY29udGV4dDogSUZvcm1CdWlsZGVyQ29udGV4dCkge1xuICAgIGxldCBjbGllbnRDb2RlID0gc2VsZWN0ZWRNYXR0ZXIuZGF0YS5jbGllbnQuY29kZTtcbiAgICBzZWFyY2hGb3JDbGllbnRzKGNsaWVudENvZGUpLnRoZW4oKGNsaWVudHMpID0+IHtcbiAgICAgICAgbGV0IGNsaWVudCA9IGNsaWVudHNbMF07XG4gICAgICAgIGNvbnNvbGUubG9nKFwiJWMgRm91bmQgQ2xpZW50IG5hbWUgOiBcIiArIGNsaWVudD8ubmFtZSwgXCJjb2xvcjogcGluazsgZm9udC1zaXplOiAyMHB4O1wiLCBjbGllbnRzKTtcbiAgICAgICAgbGV0IG9kc0NsaWVudCA9IGdldENsaWVudE9kc1BpY2tlcihjb250ZXh0KTtcbiAgICAgICAgbGV0IG9kc1JvbGVDb25maWcgPSBvZHNDbGllbnQucm9sZUNvbmZpZ1swXTtcbiAgICAgICAgbGV0IG9kc0VudGl0aWVzID0gb2RzQ2xpZW50Lk9EU0VudGl0aWVzWzBdO1xuICAgIFxuICAgICAgICBpZiAoIW9kc1JvbGVDb25maWcgfHwgIW9kc0VudGl0aWVzKVxuICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgIGlmICghY2xpZW50KSB7XG4gICAgICAgICAgICBvZHNFbnRpdGllcy5zZWxlY3RlZChmYWxzZSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgbGV0IGVudGl0eSA6IElPZHNFbnRpdHkgPSBvZHNSb2xlQ29uZmlnLmFkZFNlcnZpY2UuY3JlYXRlU2VsZWN0ZWRFbnRpdHlNb2RlbChjbGllbnQuaWQsIFwib3JnYW5pc2F0aW9uXCIsIGNsaWVudC5uYW1lKTtcbiAgICAgICAgb2RzUm9sZUNvbmZpZy5hZGRTZXJ2aWNlLnNlbGVjdGVkRW50aXR5KGVudGl0eSk7XG4gICAgfSk7XG59XG5cbi8qKlxuICogVHJpZXMgdG8gdXBkYXRlIHRoZSBwYXJ0bmVyIG9kcyBwaWNrZXJcbiAqIEBwYXJhbSBzZWxlY3RlZE1hdHRlciBUaGUgc2VsZWN0ZWQgbWF0dGVyXG4gKiBAcGFyYW0gY29udGV4dCAgVGhlIGZvcm0gYnVpbGRlciBjb250ZXh0XG4gKi9cbmZ1bmN0aW9uIHRyeVVwZGF0ZVBhcnRuZXJPZHNQaWNrZXIoc2VsZWN0ZWRNYXR0ZXI6IElFeHBlcnRNYXR0ZXIsIGNvbnRleHQ6IElGb3JtQnVpbGRlckNvbnRleHQpIHtcbiAgICBsZXQgcGFydG5lckxhc3ROYW1lID0gc2VsZWN0ZWRNYXR0ZXIuZGF0YS5wYXJ0bmVyLm5hbWUuc3BsaXQoXCIsXCIpWzBdO1xuICAgIHNlYXJjaEZvclVzZXJzKHNlbGVjdGVkTWF0dGVyLmRhdGEucGFydG5lci5lbWFpbCkudGhlbigodXNlcnMpID0+IHtcbiAgICAgICAgbGV0IHVzZXIgPSB1c2Vyc1swXTtcbiAgICAgICAgY29uc29sZS5sb2coXCIlYyBQYXJ0bmVyIG5hbWUgY2hhbmdlZCB0bzogXCIgKyB1c2VyPy5pZCwgXCJjb2xvcjogcGluazsgZm9udC1zaXplOiAyMHB4O1wiLCB1c2VyKTtcbiAgICAgICAgbGV0IG9kc01hdHRlclBhcnRuZXIgPSBnZXRQYXJ0bmVyT2RzUGlja2VyKGNvbnRleHQpO1xuICAgICAgICBsZXQgb2RzUm9sZUNvbmZpZyA9IG9kc01hdHRlclBhcnRuZXIucm9sZUNvbmZpZ1swXTtcbiAgICAgICAgbGV0IG9kc0VudGl0aWVzID0gb2RzTWF0dGVyUGFydG5lci5PRFNFbnRpdGllc1swXTtcbiAgICBcbiAgICAgICAgaWYgKCFvZHNSb2xlQ29uZmlnIHx8ICFvZHNFbnRpdGllcylcbiAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgICAgIG9kc0VudGl0aWVzLnNlbGVjdGVkKGZhbHNlKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBlbnRpdHkgOiBJT2RzRW50aXR5ID0gb2RzUm9sZUNvbmZpZy5hZGRTZXJ2aWNlLmNyZWF0ZVNlbGVjdGVkRW50aXR5TW9kZWwodXNlci5pZCwgXCJ1c2VyXCIsIHVzZXIuZmlyc3ROYW1lICsgXCIgXCIgKyB1c2VyLnN1cm5hbWUpO1xuICAgICAgICBvZHNSb2xlQ29uZmlnLmFkZFNlcnZpY2Uuc2VsZWN0ZWRFbnRpdHkoZW50aXR5KTtcbiAgICB9KTtcbn1cblxuLyoqXG4gKiBDYWxsIHRoZSBzZXJ2ZXIgdG8gZ2V0IHRoZSBtYXR0ZXIgZGF0YVxuICogQHJldHVybnMgdGhlIGRhdGEgZnJvbSB0aGUgc2VydmVyIHdpdGhvdXQgY2FjaGVcbiAqL1xuYXN5bmMgZnVuY3Rpb24gZ2V0TWF0dGVyRGF0YShleHBlcnRNYXR0ZXJOdW1iZXI/OnN0cmluZykgOiBQcm9taXNlPElFeHBlcnRNYXR0ZXJbXT4ge1xuICAgIFxuICAgIGxldCByZXRWYWx1ZTpJRXhwZXJ0TWF0dGVyW10gPSBbXTtcbiAgICBpZihleHBlcnRNYXR0ZXJOdW1iZXIgPT09IHVuZGVmaW5lZCB8fCBleHBlcnRNYXR0ZXJOdW1iZXIubGVuZ3RoID09PSAwKVxuICAgIHtcbiAgICAgICAgcmV0dXJuIHJldFZhbHVlO1xuICAgIH1cbiAgIFxuICAgIC8vcmV0dXJuIGF3YWl0ICRhamF4LmdldCgvKiB3ZWJwYWNrSWdub3JlOiB0cnVlICovIHdpbmRvdy5kb2N1bWVudC5sb2NhdGlvbi5vcmlnaW4gKyBcIi9faWRlRmlsZXMvU2FtcGxlRGF0YS9lRGlzY292ZXJ5L21hdHRlcnMuanNvblwiKSBhcyBJRXhwZXJ0TWF0dGVyW107XG4gICAgLy8gLy9nZXQgdGhlIGRhdGEgZnJvbSB0aGUgc2VydmVyIHdpdGhvdXQgY2FjaGVcbiAgICB0cnlcbiAgICB7XG4gICAgICAgIGxldCBkYXRhID0gYXdhaXQgZXhlY3V0ZUdldDxhbnk+KGAvYXBpL2V4dGVybmFsTWF0dGVyUHJvdmlkZXIvZGV0YWlscy8ke2V4cGVydE1hdHRlck51bWJlcn1gKTtcbiAgICAgICAgY29uc29sZS5sb2coXCIlYyBbTW9kdWxlTG9hZGVyXSBnZXRNYXR0ZXJEYXRhIHJldHVybiB2YWx1ZVwiLCBcImJhY2tncm91bmQ6ICMyMjI7IGNvbG9yOiAjYmFkYTU1XCIsIGRhdGEpXG4gICAgICAgIGlmKGRhdGEgJiYgZGF0YS5tYXR0ZXJDb2RlKVxuICAgICAgICB7XG4gICAgICAgICAgICBsZXQgbWF0dGVyOklFeHBlcnRNYXR0ZXIgPSB7XG4gICAgICAgICAgICAgICAgZGF0YTogZGF0YVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgcmV0VmFsdWUucHVzaChtYXR0ZXIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNhdGNoKGUpXG4gICAge1xuICAgICAgICBjb25zb2xlLmxvZyhcIkZhaWxlZCB0byBnZXQgbWF0dGVyIGRhdGEgZnJvbSBzZXJ2ZXJcIixlKTtcblxuICAgIH1cbiAgICAgcmV0dXJuIHJldFZhbHVlO1xufVxuXG4vKipcbiAqIEdlbmVyYXRlcyBhIHRlbXAgbWF0dGVyIG51bWJlciBhbmQgc2V0cyBpdCB0byB0aGUgdGVtcC1tYXR0ZXItbnVtYmVyIGZpZWxkXG4gKiBAcGFyYW0gY29udGV4dCBUaGUgZm9ybSBidWlsZGVyIGNvbnRleHRcbiAqL1xuZnVuY3Rpb24gZ2VuZXJhdGVUZW1wTWF0dGVyTnVtYmVyKGNvbnRleHQ6IElGb3JtQnVpbGRlckNvbnRleHQpXG57XG4gICAgbGV0IGRhdGUgPSBuZXcgRGF0ZSgpO1xuICAgIGxldCB5ZWFyID0gZGF0ZS5nZXRGdWxsWWVhcigpO1xuICAgIGxldCBtb250aCA9IGRhdGUuZ2V0TW9udGgoKSArIDE7XG4gICAgbGV0IGRheSA9IGRhdGUuZ2V0RGF0ZSgpOyBcbiAgICBsZXQgaG91ciA9IGRhdGUuZ2V0SG91cnMoKTtcbiAgICBsZXQgbWludXRlID0gZGF0ZS5nZXRNaW51dGVzKCk7XG4gICAgbGV0IHNlY29uZCA9IGRhdGUuZ2V0U2Vjb25kcygpO1xuICAgIGxldCBtaWxsaXNlY29uZCA9IGRhdGUuZ2V0TWlsbGlzZWNvbmRzKCk7XG4gICAgbGV0IHRlbXBNYXR0ZXJOdW1iZXIgPSBgVCR7eWVhcn0ke21vbnRofSR7ZGF5fSR7aG91cn0ke21pbnV0ZX0ke3NlY29uZH0ke21pbGxpc2Vjb25kfWA7XG4gICAgY29udGV4dC5mb3JtPy5maWVsZHNCeUlkW2VudW1GaWVsZHMudGVtcE1hdHRlck51bWJlcl0/LnNldFZhbHVlKHRlbXBNYXR0ZXJOdW1iZXIpO1xufVxuXG4vKipcbiAqIEVudW0gZm9yIHRoZSBmaWVsZHMgaW4gdGhlIGZvcm0gYnVpbGRlclxuICovXG5leHBvcnQgZW51bSBlbnVtRmllbGRzIHtcbiAgICBjdXN0b21BbHRFZGlzY292ZXJ5SW5zdHJ1Y3Rpb25NYXR0ZXJEZXRhaWxzID0gXCJjdXN0b20tYWx0LWVkaXNjb3ZlcnktaW5zdHJ1Y3Rpb24tbWF0dGVyLWRldGFpbHNcIixcbiAgICBqdXJpc2RpY3Rpb25zQ291bnRyeSA9IFwianVyaXNkaWN0aW9ucy1jb3VudHJ5XCIsXG4gICAgcGlwZWxpbmVNYXR0ZXIgPSBcInBpcGVsaW5lLW1hdHRlclwiLFxuICAgIGV4cGVydE1hdHRlck51bWJlciA9IFwiZXhwZXJ0LW1hdHRlci1udW1iZXJcIixcbiAgICBleHBlcnRNYXR0ZXJOdW1iZXJWYWx1ZSA9IFwiZXhwZXJ0LW1hdHRlci1udW1iZXItdmFsdWVcIixcbiAgICB0ZW1wTWF0dGVyTnVtYmVyID0gXCJ0ZW1wLW1hdHRlci1udW1iZXJcIixcbiAgICBzdWJNYXR0ZXJDb2RlID0gXCJzdWItbWF0dGVyLWNvZGVcIixcbiAgICBhYmNNYXR0ZXJOdW1iZXIgPSBcImFiYy1tYXR0ZXItbnVtYmVyXCIsXG4gICAgbWF0dGVyRGV0YWlscyA9IFwibWF0dGVyLWRldGFpbHNcIixcbiAgICBcbn1cblxuLyoqXG4gKiBFbnVtIGZvciB0aGUgZmllbGRzIGluIHRoZSBtYXR0ZXIgZGV0YWlscyBzdWIgYXJlYSBvZiB0aGUgZm9ybSBidWlsZGVyXG4gKi9cbmV4cG9ydCBlbnVtIGVudW1NYXR0ZXJEZXRhaWxGaWVsZHMge1xuICAgIG1hdHRlckRldGFpbHNQYXJ0bmVyU2VsZWN0b3IgPSBcIm1hdHRlci1kZXRhaWxzLXBhcnRuZXItc2VsZWN0b3JcIixcbiAgICBtYXR0ZXJEZXRhaWxzUGFydG5lck5hbWUgPSBcIm1hdHRlci1kZXRhaWxzLXBhcnRuZXItbmFtZVwiLFxuICAgIG1hdHRlckRldGFpbHNDbGllbnROYW1lID0gXCJtYXR0ZXItZGV0YWlscy1jbGllbnQtbmFtZVwiLFxuICAgIG1hdHRlckRldGFpbHNDbGllbnRDb2RlID0gXCJtYXR0ZXItZGV0YWlscy1jbGllbnQtY29kZVwiLFxuICAgIG1hdHRlckRldGFpbHNQcmFjdGljZUFyZWEgPSBcIm1hdHRlci1kZXRhaWxzLXByYWN0aWNlLWFyZWFcIixcbiAgICBtYXR0ZXJEZXRhaWxzTmFtZSA9IFwibWF0dGVyLWRldGFpbHMtbmFtZVwiLFxuICAgIG1hdHRlckRldGFpbHNJYiA9IFwibWF0dGVyLWRldGFpbHMtaWJcIixcbiAgICBtYXR0ZXJEZXRhaWxzSWJMYXN0Q2hlY2tlZCA9IFwibWF0dGVyLWRldGFpbHMtaWItbGFzdC1jaGVja1wiXG59XG5cbi8qKlxuICogU2VhcmNoZXMgZm9yIHRoZSBwYXJ0bmVyIG9kcyBwaWNrZXIgaW4gdGhlIGJsYWRlIHVzaW5nIGNvbW1vbiBvZHMgaGVscGVyIGZ1bmN0aW9uc1xuICogQHBhcmFtIGNvbnRleHQgXG4gKiBAcmV0dXJucyBcbiAqL1xuZnVuY3Rpb24gZ2V0UGFydG5lck9kc1BpY2tlcihjb250ZXh0OiBJRm9ybUJ1aWxkZXJDb250ZXh0KSB7XG4gICAgcmV0dXJuIGdldEFsbFJvbGVDb25maWdGb3JSb2xlKGNvbnRleHQuYmxhZGUsbWF0dGVyUGFydG5lclJvbGVTeXN0ZW1OYW1lKTtcbn1cblxuLyoqXG4gKiBTZWFyY2hlcyBmb3IgdGhlIHBhcnRuZXIgb2RzIHBpY2tlciBpbiB0aGUgYmxhZGUgdXNpbmcgY29tbW9uIG9kcyBoZWxwZXIgZnVuY3Rpb25zXG4gKiBAcGFyYW0gY29udGV4dCBcbiAqIEByZXR1cm5zIFxuICovXG5mdW5jdGlvbiBnZXRDbGllbnRPZHNQaWNrZXIoY29udGV4dDogSUZvcm1CdWlsZGVyQ29udGV4dCkge1xuICAgIHJldHVybiBnZXRBbGxSb2xlQ29uZmlnRm9yUm9sZShjb250ZXh0LmJsYWRlLCBjbGllbnRSb2xlU3lzdGVtTmFtZSk7XG59XG4iXSwibmFtZXMiOlsiX193ZWJwYWNrX3JlcXVpcmVfXyIsImV4cG9ydHMiLCJkZWZpbml0aW9uIiwia2V5IiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsIm9iaiIsInByb3AiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwiZXhlY3V0ZUZldGNoIiwiYXBpIiwibWV0aG9kIiwiZGF0YSIsInVybCIsImxvY2F0aW9uIiwid2luZG93IiwiZG9jdW1lbnQiLCJvcmlnaW4iLCJpbmRleE9mIiwidmFsaWRhdGVBcGkiLCJmZXRjaEhlYWRlcnMiLCJiZWFyZXIiLCJ0b2tlbiIsInJldFZhbHVlIiwiY29va2llIiwic3BsaXQiLCJyZWR1Y2UiLCJjb29raWVzIiwicGFydHMiLCJsZW5ndGgiLCJ0cmltIiwiZ2V0Q29va2llcyIsIkhlYWRlcnMiLCJhcHBlbmQiLCJidWlsZEhlYWRlcnMiLCJmZXRjaCIsImhlYWRlcnMiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsInVuZGVmaW5lZCIsInRoZW4iLCJyZXNwb25zZSIsImNvbnNvbGUiLCJsb2ciLCJFcnJvciIsImpzb24iLCJnZXRBbGxSb2xlQ29uZmlnRm9yUm9sZSIsImJsYWRlIiwicm9sZSIsInJvbGVDb25maWciLCJPRFNFbnRpdGllcyIsImFsbE9kc0FzcGVjdHMiLCJ0eXBlVG9DaGVjayIsIlNoYXJlZG8iLCJDb3JlIiwiQ2FzZSIsIkFzcGVjdHMiLCJXaWRnZXRzIiwiT2RzRW50aXR5UGlja2VyIiwiYXNwZWN0cyIsImZpbHRlciIsImEiLCJ3aWRnZXQiLCJnZXRPZHNXaWRnZXRzIiwiZm9yRWFjaCIsIm9kc0VudGl0aWVzIiwib2RzIiwicm9sZVN5c3RlbU5hbWUiLCJwdXNoIiwib3B0aW9ucyIsInJvbGVDb25maWdNb2RlbHMiLCJyIiwic2VhcmNoT2RzQW5kUmV0dXJuUm93cyIsInNlYXJjaCIsInBvc3RCb2R5IiwiQVBJUmVzdWx0IiwiZXhlY3V0ZVBvc3QiLCJlIiwid2FybiIsIl9zZWFyY2giLCJyb3dzIiwibWFwIiwicGFyc2UiLCJyZXN1bHQiLCJleHRyYWN0Um93c0Zyb21PRFNTZWFyY2hSZXN1bHRzIiwibWF0dGVyUGFydG5lclJvbGVTeXN0ZW1OYW1lIiwiY2xpZW50Um9sZVN5c3RlbU5hbWUiLCJydW5NZSIsImNvbnRleHQiLCJleHBlcnRNYXR0ZXJOdW1iZXIiLCJtYXR0ZXJEZXRhaWxzIiwicGlwZWxpbmVNYXR0ZXIiLCJmb3JtIiwiZmllbGRzQnlJZCIsImVudW1GaWVsZHMiLCJjcmVhdGVWYXJpYWJsZXMiLCJ0ZXN0ZXIiLCJ3b3JrSXRlbUNvbnRleHQiLCJpZCIsImV4aXQiLCJwaGFzZU5hbWUiLCJ0b0xvd2VyQ2FzZSIsImluY2x1ZGVzIiwiYXNwZWN0RGVidWdlciIsIm1hdHRlckRldGFpbHNGb3JtQnVpbGRlciIsImhpZGVTaG93TWF0dGVyRGV0YWlscyIsImVudW1NYXR0ZXJEZXRhaWxGaWVsZHMiLCJtYXR0ZXJEZXRhaWxzUGFydG5lck5hbWUiLCJvbiIsImV2IiwiZ2V0VmFsdWUiLCJ1cGRhdGVNYXR0ZXJEZXRhaWxzIiwianVyaXNkaWN0aW9uc0NvdW50cnkiLCJzZWxlY3RlZElkIiwiYXNwZWN0IiwiZ2V0QXNwZWN0Iiwic2VsZWN0ZWRKdXJpc2RpY3Rpb25Db3VudHJ5IiwiJGFqYXgiLCJzZWxlY3RlZEp1cmlzZGljdGlvbiIsImZpbmQiLCJvcHRpb24iLCJuYW1lIiwiaW5zdHJ1Y3Rpb24iLCJqdXJpc2RpY3Rpb25JZCIsImFkZEV2ZW50SGFuZGxlcnMiLCJkYXRlIiwiRGF0ZSIsInRlbXBNYXR0ZXJOdW1iZXIiLCJnZXRGdWxsWWVhciIsImdldE1vbnRoIiwiZ2V0RGF0ZSIsImdldEhvdXJzIiwiZ2V0TWludXRlcyIsImdldFNlY29uZHMiLCJnZXRNaWxsaXNlY29uZHMiLCJzZXRWYWx1ZSIsImdlbmVyYXRlVGVtcE1hdHRlck51bWJlciIsIiR1aSIsImV2ZW50cyIsImJyb2FkY2FzdCIsInN0YXR1cyIsImZpZWxkcyIsImNoaWxkIiwicmVhZG9ubHkiLCJtYXR0ZXJEZXRhaWxzSWJMYXN0Q2hlY2tlZCIsImhpZGRlbiIsInNldE1hdHRlckRldGFpbHNTdGF0ZSIsImV4ZWN1dGVHZXQiLCJtYXR0ZXJDb2RlIiwibWF0dGVyIiwiZ2V0TWF0dGVyRGF0YSIsInNlbGVjdGVkTWF0dGVyIiwiY2xlYXJNYXR0ZXJEZXRhaWxzIiwicGFyZW50IiwiZXhwZXJ0TWF0dGVyTnVtYmVyVmFsdWUiLCJtYXR0ZXJEZXRhaWxzQ2xpZW50TmFtZSIsImNsaWVudCIsIm1hdHRlckRldGFpbHNDbGllbnRDb2RlIiwiY29kZSIsIm1hdHRlckRldGFpbHNOYW1lIiwic2hvcnROYW1lIiwicGFydG5lciIsIm1hdHRlckRldGFpbHNJYiIsInNlY3VyZSIsImlzVmFsaWQiLCJzZWFyY2hGb3JDbGllbnRzIiwiY2xpZW50cyIsIm9kc0NsaWVudCIsImdldENsaWVudE9kc1BpY2tlciIsIm9kc1JvbGVDb25maWciLCJzZWxlY3RlZCIsImVudGl0eSIsImFkZFNlcnZpY2UiLCJjcmVhdGVTZWxlY3RlZEVudGl0eU1vZGVsIiwic2VsZWN0ZWRFbnRpdHkiLCJ0cnlVcGRhdGVDbGllbnRPZHNQaWNrZXIiLCJzZWFyY2hGb3JVc2VycyIsImVtYWlsIiwidXNlcnMiLCJ1c2VyIiwib2RzTWF0dGVyUGFydG5lciIsImdldFBhcnRuZXJPZHNQaWNrZXIiLCJmaXJzdE5hbWUiLCJzdXJuYW1lIiwidHJ5VXBkYXRlUGFydG5lck9kc1BpY2tlciJdLCJzb3VyY2VSb290IjoiIn0=