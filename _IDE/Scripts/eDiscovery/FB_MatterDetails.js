(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{enumFields:()=>v,enumMatterDetailFields:()=>p,runMe:()=>c});var n=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{d(r.next(e))}catch(e){o(e)}}function l(e){try{d(r.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}d((r=r.apply(e,t||[])).next())}))},r=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{d(r.next(e))}catch(e){o(e)}}function l(e){try{d(r.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}d((r=r.apply(e,t||[])).next())}))};var i=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{d(r.next(e))}catch(e){o(e)}}function l(e){try{d(r.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}d((r=r.apply(e,t||[])).next())}))};function o(e,t){let n={roleConfig:[],ODSEntities:[]};if(!e)return n;let r=function(e){if(!e)return;let t=Sharedo.Core.Case.Aspects.Widgets.OdsEntityPicker;return e.aspects().filter((e=>e.widget instanceof t))}(e);return null==r||r.forEach((e=>{e.widget.odsEntities().forEach((e=>{e.roleSystemName&&e.roleSystemName()===t&&n.ODSEntities.push(e)})),e.widget.options.roleConfigModels.forEach((e=>{e.roleSystemName===t&&n.roleConfig.push(e)}))})),n}function a(e,t){return i(this,void 0,void 0,(function*(){let e=yield function(e){return r(this,void 0,void 0,(function*(){try{let t="/api/ods/_search";return yield function(e,t){return n(this,void 0,void 0,(function*(){return yield $ajax.post(e,t)}))}(window.document.location.origin+t,e)}catch(t){console.warn("ODS Search Error",t,e)}}))}(t);return console.log("%c ODS Search Result","color: #ff0000",e),e?(console.log("%c ODS Search Result","color: #ff0000",e),function(e){try{return e.rows.map((e=>JSON.parse(e.result)))}catch(t){console.warn("ODS Helper Error trying to extract rows from search result",t,e)}return[]}(e)):(console.log("%c ODS Search Result - undefined","color: #ff0000"),[])}))}var l=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{d(r.next(e))}catch(e){o(e)}}function l(e){try{d(r.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}d((r=r.apply(e,t||[])).next())}))};const d="matter-partner",u="client";function c(e){var t,n;let{expertMatterNumber:r,matterDetails:i,pipelineMatter:o}=function(e){if(!e.form)throw new Error("No form");let t=e.form.fieldsById[v.matterDetails];return{expertMatterNumber:e.form.fieldsById[v.expertMatterNumber],matterDetails:t,pipelineMatter:e.form.fieldsById[v.pipelineMatter]}}(e);if(!r)throw new Error("No expertMatterNumber");if(!i)throw new Error("No matterDetails");if(!o)throw new Error("No pipelineMatter");window.tester=e,void 0===e.workItemContext.id()||(null===(n=null===(t=e.workItemContext)||void 0===t?void 0:t.phaseName())||void 0===n?void 0:n.toLowerCase().includes("draft"))?(s(i,0,o),function(e,t,n,r){var i,o,a,d;if(!e.form)throw new Error("No form");null===(i=t.fieldsById[p.matterDetailsPartnerName])||void 0===i||i.on("change",(function(e){var n;console.log("%c Partner name changed to: "+(null===(n=t.fieldsById[p.matterDetailsPartnerName])||void 0===n?void 0:n.getValue()),"color: pink; font-size: 20px;")})),null===(o=e.form.fieldsById[v.expertMatterNumber])||void 0===o||o.on("change",(function(i){s(t,0,r),m(e,t,n,r)})),null===(a=e.form.fieldsById[v.pipelineMatter])||void 0===a||a.on("change",(function(i){s(t,0,r),m(e,t,n,r)})),null===(d=e.form.fieldsById[v.jurisdictionsCountry])||void 0===d||d.on("change",(function(t){var n,r,i,o;return l(this,void 0,void 0,(function*(){let t=null===(r=null===(n=e.form)||void 0===n?void 0:n.fieldsById["jurisdictions-country"])||void 0===r?void 0:r.getValue();console.log("%c Jurisdiction changed to: "+(null===(o=null===(i=e.form)||void 0===i?void 0:i.fieldsById["jurisdictions-country"])||void 0===o?void 0:o.getValue()),"color: red; font-size: 20px;");let a=e.getAspect("Sharedo.Core.Legal.Aspects.Widgets.InstructionWorkTypeDetails"),l=yield $ajax.get(`/api/v1/public/modeller/optionSets/allValues/${t}`);if(!l)return void console.log("%c [ModuleLoader] getAspect return value","background: #222; color: #bada55",l);let d=(yield $ajax.get("/api/v1/public/modeller/optionSets/jurisdictions/values")).find((e=>e.name===l.name));d?a.widget.instruction.jurisdictionId(d.id):console.log("%c [ModuleLoader] getAspect return value","background: #222; color: #bada55",d)}))}))}(e,i,r,o),function(e){var t,n;let r=new Date,i=`T${r.getFullYear()}${r.getMonth()+1}${r.getDate()}${r.getHours()}${r.getMinutes()}${r.getSeconds()}${r.getMilliseconds()}`;null===(n=null===(t=e.form)||void 0===t?void 0:t.fieldsById[v.tempMatterNumber])||void 0===n||n.setValue(i)}(e)):console.log("%c [ModuleLoader] FB_MatterDetails - exit (only run on new)","background: #222; color: #bada55",e.workItemContext.id())}function s(e,t,n){!function(e,t=!0){if(!e.fields)throw new Error("No fields");if(!e.fieldsById)throw new Error("No fieldsById");e.fields.forEach((e=>{e.readonly(!t)}))}(e,n.getValue())}function f(e){var t;return l(this,void 0,void 0,(function*(){null===(t=e.fields)||void 0===t||t.forEach((function(e){e.setValue("")}))}))}function m(e,t,n,r){var c,s,m,y,g,h,w,b,D,N,S;return l(this,void 0,void 0,(function*(){let M=yield function(){return l(this,void 0,void 0,(function*(){return yield $ajax.get(window.document.location.origin+"/_ideFiles/SampleData/eDiscovery/matters.json")}))}();f(t);let x=M.find((function(e){return n.getValue()===e.data.matterCode}));if(void 0===x||!0===r.getValue())return void f(t);if(!(null===(c=t.parent)||void 0===c?void 0:c.fieldsById))throw new Error("No client");let I=null===(m=null===(s=t.parent)||void 0===s?void 0:s.fieldsById["temp-matter-number"])||void 0===m?void 0:m.getValue();void 0===I||I.length,null===(g=null===(y=e.form)||void 0===y?void 0:y.fieldsById[v.expertMatterNumberValue])||void 0===g||g.setValue(x.data.matterCode),null===(h=t.fieldsById[p.matterDetailsClientName])||void 0===h||h.setValue(x.data.client.name),null===(w=t.fieldsById[p.matterDetailsClientCode])||void 0===w||w.setValue(x.data.client.code),null===(b=t.fieldsById[p.matterDetailsPracticeArea])||void 0===b||b.setValue(x.data.practiceArea.name),null===(D=t.fieldsById[p.matterDetailsName])||void 0===D||D.setValue(x.data.shortName),null===(N=t.fieldsById[p.matterDetailsPartnerName])||void 0===N||N.setValue(x.data.partner.name),null===(S=t.fieldsById[p.matterDetailsIb])||void 0===S||S.setValue(x.data.secure),console.log("matterDetails.isValid():"+t.isValid());try{!function(e,t){e.data.partner.name.split(",")[0],function(e){return i(this,void 0,void 0,(function*(){return a(0,{startPage:1,endPage:1,rowsPerPage:10,searchString:e,odsEntityTypes:[],availability:{isAvailable:null,isOutOfOffice:null,isNotAvailable:null},location:{postcode:null,range:10},connection:{systemName:null},competencies:[],teams:[],roles:[],odsTypes:["acl","alt-ediscovery-user-type","client","department","document-training-type","employee","expert","external-team","external","pod","structural","system-administrator"],wallManagement:!1})}))}(e.data.partner.email).then((e=>{let n=e[0];console.log("%c Partner name changed to: "+(null==n?void 0:n.id),"color: pink; font-size: 20px;",n);let r=function(e){return o(e.blade,d)}(t),i=r.roleConfig[0],a=r.ODSEntities[0];if(!i||!a)return;if(!n)return void a.selected(!1);let l=i.addService.createSelectedEntityModel(n.id,"user",n.firstName+" "+n.surname);i.addService.selectedEntity(l)}))}(x,e),function(e,t){(function(e){return i(this,void 0,void 0,(function*(){return a(0,{startPage:1,endPage:1,rowsPerPage:10,searchString:e,odsEntityTypes:[],availability:{isAvailable:null,isOutOfOffice:null,isNotAvailable:null},location:{postcode:null,range:10},connection:{systemName:null},competencies:[],teams:[],roles:[],odsTypes:["client"],wallManagement:!1})}))})(e.data.client.code).then((e=>{let n=e[0];console.log("%c Found Client name : "+(null==n?void 0:n.name),"color: pink; font-size: 20px;",e);let r=function(e){return o(e.blade,u)}(t),i=r.roleConfig[0],a=r.ODSEntities[0];if(!i||!a)return;if(!n)return void a.selected(!1);let l=i.addService.createSelectedEntityModel(n.id,"organisation",n.name);i.addService.selectedEntity(l)}))}(x,e)}catch(e){console.log("Failed to auto updating ods pickers, user required to select manually")}}))}var v,p;!function(e){e.customAltEdiscoveryInstructionMatterDetails="custom-alt-ediscovery-instruction-matter-details",e.jurisdictionsCountry="jurisdictions-country",e.pipelineMatter="pipeline-matter",e.expertMatterNumber="expert-matter-number",e.expertMatterNumberValue="expert-matter-number-value",e.tempMatterNumber="temp-matter-number",e.subMatterCode="sub-matter-code",e.abcMatterNumber="abc-matter-number",e.matterDetails="matter-details"}(v||(v={})),function(e){e.matterDetailsPartnerSelector="matter-details-partner-selector",e.matterDetailsPartnerName="matter-details-partner-name",e.matterDetailsClientName="matter-details-client-name",e.matterDetailsClientCode="matter-details-client-code",e.matterDetailsPracticeArea="matter-details-practice-area",e.matterDetailsName="matter-details-name",e.matterDetailsIb="matter-details-ib"}(p||(p={})),window.FB_MatterDetails=t})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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a0QsRUFBY0csV0FBV0ksZUFBZUwsRUFBTyxHQUV2RCxDQW5DUVcsQ0FBeUJ2QyxFQUFnQnZELEUsQ0FFN0MsTUFBTWQsR0FFRkMsUUFBUUcsSUFBSSx3RSxLQTBGcEIsSUFBWWlCLEVBZ0JBVSxHQWhCWixTQUFZVixHQUNSLGlHQUNBLCtDQUNBLG1DQUNBLDRDQUNBLHVEQUNBLHdDQUNBLGtDQUNBLHNDQUNBLGdDQUVILENBWEQsQ0FBWUEsSUFBQUEsRUFBVSxLQWdCdEIsU0FBWVUsR0FDUixpRUFDQSx5REFDQSx1REFDQSx1REFDQSwyREFDQSwwQ0FDQSxxQ0FDSCxDQVJELENBQVlBLElBQUFBLEVBQXNCLEsiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly8vd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly8vd2VicGFjay9ydW50aW1lL21ha2UgbmFtZXNwYWNlIG9iamVjdCIsIndlYnBhY2s6Ly8vLi4vLi4vQ29tbW9uL09kc0hlbHBlci50cyIsIndlYnBhY2s6Ly8vLi4vLi4vQ29tbW9uL2FwaS9vZHMvc2VhcmNoLnRzIiwid2VicGFjazovLy8uLi8uLi9Db21tb24vYXBpL2FwaS50cyIsIndlYnBhY2s6Ly8vLi9GQl9NYXR0ZXJEZXRhaWxzL2luZGV4LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRoZSByZXF1aXJlIHNjb3BlXG52YXIgX193ZWJwYWNrX3JlcXVpcmVfXyA9IHt9O1xuXG4iLCIvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgaGFybW9ueSBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSAoZXhwb3J0cywgZGVmaW5pdGlvbikgPT4ge1xuXHRmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGRlZmluaXRpb24sIGtleSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBrZXkpKSB7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pO1xuXHRcdH1cblx0fVxufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkpIiwiLy8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5yID0gKGV4cG9ydHMpID0+IHtcblx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG5cdH1cblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbn07IiwiLyoqXG4gKiBUaGlzIGZpbGUgY29udGFpbnMgaGVscGVyIGZ1bmN0aW9ucyBmb3Igd29ya2luZyB3aXRoIHRoZSBPRFMgQVBJXG4gKiBfc2VhcmNoIGlzIGEgd3JhcHBlciBhcm91bmQgdGhlIE9EUyBzZWFyY2ggZW5kcG9pbnRcbiAqL1xuaW1wb3J0IHsgSUFzcGVjdCB9IGZyb20gXCIuLi8uLi9UeXBpbmdzL0FzcGVjdC9JQXNwZWN0XCI7XG5pbXBvcnQgeyBJT0RTT3JnYW5pc2F0aW9uUmVzdWx0IH0gZnJvbSBcIi4uLy4uL1R5cGluZ3MvT2RzTGlzdC9JT0RTT3JnYW5pc2F0aW9uUmVzdWx0XCI7XG5pbXBvcnQgeyBJT0RTUGVyc29uUmVzdWx0IH0gZnJvbSBcIi4uLy4uL1R5cGluZ3MvT2RzTGlzdC9JT0RTUGVvcGxlU2VhcmNoUmVzdWx0XCI7XG5pbXBvcnQgeyBJT0RTZWFyY2hSZXN1bHQgfSBmcm9tIFwiLi4vLi4vVHlwaW5ncy9PZHNMaXN0L0lPRFNTZWFyY2hSZXN1bHRcIjtcbmltcG9ydCB7IFRTaGFyZURvQmxhZGUgfSBmcm9tIFwiLi4vLi4vVHlwaW5ncy9TaGFyZURvSlMvQWRkRWRpdFNoYXJlZG9cIjtcbmltcG9ydCB7IElSb2xlQ29uZmlnTW9kZWxzIH0gZnJvbSBcIi4uLy4uL1R5cGluZ3MvV2lkZ2V0c09kc0VudGl0eVBpY2tlci9JUm9sZUNvbmZpZ01vZGVsc1wiO1xuaW1wb3J0IHsgSU9kc1dpZGdldCwgSU9kc1dpZGdldE9EU0VudGl0aWVzIH0gZnJvbSBcIi4uLy4uL1R5cGluZ3MvV2lkZ2V0c09kc0VudGl0eVBpY2tlci9JV2lkZ2V0T2RzRW50aXR5UGlja2VyXCI7XG5pbXBvcnQgeyBfc2VhcmNoIH0gZnJvbSBcIi4vYXBpL29kcy9zZWFyY2hcIjtcblxuXG4vKipcbiAqIFVzZXMgdGhlIFwiL2FwaS9vZHMvX3NlYXJjaFwiIGVuZHBvaW50IHRvIHNlYXJjaCBmb3IgdXNlcnMuXG4gKiBAcGFyYW0gc2VhcmNoIFRoZSBzZWFyY2ggc3RyaW5nIHRvIHVzZSBzdWNoIGFzIHN1cm5hbWUgb3IgZW1haWwgYWRkcmVzc1xuICogQHJldHVybnMgXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzZWFyY2hGb3JVc2VycyhzZWFyY2g6IHN0cmluZykgOiBQcm9taXNlPElPRFNQZXJzb25SZXN1bHRbXT5cbiB7XG4gICAgbGV0IHBvc3RCb2R5ID0ge1xuICAgICAgICBcInN0YXJ0UGFnZVwiOiAxLFxuICAgICAgICBcImVuZFBhZ2VcIjogMSxcbiAgICAgICAgXCJyb3dzUGVyUGFnZVwiOiAxMCxcbiAgICAgICAgXCJzZWFyY2hTdHJpbmdcIjogc2VhcmNoLFxuICAgICAgICBcIm9kc0VudGl0eVR5cGVzXCI6IFtdLFxuICAgICAgICBcImF2YWlsYWJpbGl0eVwiOiB7XG4gICAgICAgICAgICBcImlzQXZhaWxhYmxlXCI6IG51bGwsXG4gICAgICAgICAgICBcImlzT3V0T2ZPZmZpY2VcIjogbnVsbCxcbiAgICAgICAgICAgIFwiaXNOb3RBdmFpbGFibGVcIjogbnVsbFxuICAgICAgICB9LFxuICAgICAgICBcImxvY2F0aW9uXCI6IHtcbiAgICAgICAgICAgIFwicG9zdGNvZGVcIjogbnVsbCxcbiAgICAgICAgICAgIFwicmFuZ2VcIjogMTBcbiAgICAgICAgfSxcbiAgICAgICAgXCJjb25uZWN0aW9uXCI6IHtcbiAgICAgICAgICAgIFwic3lzdGVtTmFtZVwiOiBudWxsXG4gICAgICAgIH0sXG4gICAgICAgIFwiY29tcGV0ZW5jaWVzXCI6IFtdLFxuICAgICAgICBcInRlYW1zXCI6IFtdLFxuICAgICAgICBcInJvbGVzXCI6IFtdLFxuICAgICAgICBcIm9kc1R5cGVzXCI6IFtcbiAgICAgICAgICAgIFwiYWNsXCIsXG4gICAgICAgICAgICBcImFsdC1lZGlzY292ZXJ5LXVzZXItdHlwZVwiLFxuICAgICAgICAgICAgXCJjbGllbnRcIixcbiAgICAgICAgICAgIFwiZGVwYXJ0bWVudFwiLFxuICAgICAgICAgICAgXCJkb2N1bWVudC10cmFpbmluZy10eXBlXCIsXG4gICAgICAgICAgICBcImVtcGxveWVlXCIsXG4gICAgICAgICAgICBcImV4cGVydFwiLFxuICAgICAgICAgICAgXCJleHRlcm5hbC10ZWFtXCIsXG4gICAgICAgICAgICBcImV4dGVybmFsXCIsXG4gICAgICAgICAgICBcInBvZFwiLFxuICAgICAgICAgICAgXCJzdHJ1Y3R1cmFsXCIsXG4gICAgICAgICAgICBcInN5c3RlbS1hZG1pbmlzdHJhdG9yXCJcbiAgICAgICAgXSxcbiAgICAgICAgXCJ3YWxsTWFuYWdlbWVudFwiOiBmYWxzZVxuICAgIH07XG4gICAgcmV0dXJuIHNlYXJjaE9kc0FuZFJldHVyblJvd3M8SU9EU1BlcnNvblJlc3VsdD4oc2VhcmNoLHBvc3RCb2R5KTtcbn1cblxuLyoqXG4gKiBVc2VzIHRoZSBcIi9hcGkvb2RzL19zZWFyY2hcIiBlbmRwb2ludCB0byBzZWFyY2ggZm9yIGNsaWVudHMuXG4gKiBAcGFyYW0gc2VhcmNoIFRoZSBzZWFyY2ggc3RyaW5nIHRvIHVzZSBzdWNoIGFzIGNsaWVudCBjb2RlIG9yIG5hbWVcbiAqIEByZXR1cm5zIEEgbGlzdCBvZiBjbGllbnRzXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzZWFyY2hGb3JDbGllbnRzKHNlYXJjaDogc3RyaW5nKTogUHJvbWlzZTxJT0RTT3JnYW5pc2F0aW9uUmVzdWx0W10+IHtcblxuICAgICAgICBsZXQgcG9zdEJvZHkgPSB7XG4gICAgICAgICAgICBcInN0YXJ0UGFnZVwiOiAxLFxuICAgICAgICAgICAgXCJlbmRQYWdlXCI6IDEsXG4gICAgICAgICAgICBcInJvd3NQZXJQYWdlXCI6IDEwLFxuICAgICAgICAgICAgXCJzZWFyY2hTdHJpbmdcIjogc2VhcmNoLFxuICAgICAgICAgICAgXCJvZHNFbnRpdHlUeXBlc1wiOiBbXSxcbiAgICAgICAgICAgIFwiYXZhaWxhYmlsaXR5XCI6IHtcbiAgICAgICAgICAgICAgICBcImlzQXZhaWxhYmxlXCI6IG51bGwsXG4gICAgICAgICAgICAgICAgXCJpc091dE9mT2ZmaWNlXCI6IG51bGwsXG4gICAgICAgICAgICAgICAgXCJpc05vdEF2YWlsYWJsZVwiOiBudWxsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgXCJsb2NhdGlvblwiOiB7XG4gICAgICAgICAgICAgICAgXCJwb3N0Y29kZVwiOiBudWxsLFxuICAgICAgICAgICAgICAgIFwicmFuZ2VcIjogMTBcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBcImNvbm5lY3Rpb25cIjoge1xuICAgICAgICAgICAgICAgIFwic3lzdGVtTmFtZVwiOiBudWxsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgXCJjb21wZXRlbmNpZXNcIjogW10sXG4gICAgICAgICAgICBcInRlYW1zXCI6IFtdLFxuICAgICAgICAgICAgXCJyb2xlc1wiOiBbXSxcbiAgICAgICAgICAgIFwib2RzVHlwZXNcIjogW1xuICAgICAgICAgICAgICAgIFwiY2xpZW50XCJcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICBcIndhbGxNYW5hZ2VtZW50XCI6IGZhbHNlXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBzZWFyY2hPZHNBbmRSZXR1cm5Sb3dzPElPRFNPcmdhbmlzYXRpb25SZXN1bHQ+KHNlYXJjaCxwb3N0Qm9keSk7XG59XG5cblxuLy8gUmVnaW9uOiBHZXQgYWxsIHJvbGUgY29uZmlnIGZvciByb2xlXG4vLyBUaGlzIGlzIGEgaGVscGVyIGZ1bmN0aW9uIHRvIGdldCBhbGwgdGhlIHJvbGUgY29uZmlnIGZvciBhIGdpdmVuIHJvbGVcbi8vIEl0IGlzIHVzZWQgaW4gdGhlIFwiZ2V0Um9sZUNvbmZpZ0ZvclJvbGVcIiBmdW5jdGlvbiBiZWxvd1xuLy8gdGhlIGludGVyZmFjZSBpcyB1c2VkIHRvIHJldHVybiB0aGUgcmVzdWx0cyBvZiB0aGUgZnVuY3Rpb25cblxuLyoqXG4gKiBUaGlzIGludGVyZmFjZSBpcyB1c2VkIHRvIHJldHVybiB0aGUgcmVzdWx0cyBvZiB0aGUgZnVuY3Rpb25cbiAqIEBwcm9wZXJ0eSByb2xlQ29uZmlnIC0gdGhlIHJvbGUgY29uZmlnIGZvciB0aGUgZ2l2ZW4gcm9sZVxuICogQHByb3BlcnR5IE9EU0VudGl0aWVzIC0gdGhlIE9EUyBlbnRpdGllcyBmb3IgdGhlIGdpdmVuIHJvbGVcbiAqIEJvdGggYXJlIHJldHVybmVkIGFzIGJvdGggYXJlIG5lZWRlZCB3aGVuIHVwZGF0aW5nIHRoZSB3aWRnZXRcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBJR2V0QWxsUm9sZUNvbmZpZ0ZvclJvbGUge1xuICAgIHJvbGVDb25maWc6IElSb2xlQ29uZmlnTW9kZWxzW10sXG4gICAgT0RTRW50aXRpZXM6IElPZHNXaWRnZXRPRFNFbnRpdGllc1tdXG59XG5cbi8qKlxuICogVGhpcyBmdW5jdGlvbiByZXR1cm5zIGFsbCB0aGUgcm9sZSBjb25maWcgZm9yIGEgZ2l2ZW4gcm9sZVxuICogQHBhcmFtIGJsYWRlIFxuICogQHBhcmFtIHJvbGUgXG4gKiBAcmV0dXJucyBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEFsbFJvbGVDb25maWdGb3JSb2xlKGJsYWRlOiBUU2hhcmVEb0JsYWRlIHwgdW5kZWZpbmVkLCByb2xlOiBzdHJpbmcpOiBJR2V0QWxsUm9sZUNvbmZpZ0ZvclJvbGUge1xuICAgIGxldCByZXRWYWx1ZTogSUdldEFsbFJvbGVDb25maWdGb3JSb2xlID1cbiAgICB7XG4gICAgICAgIHJvbGVDb25maWc6IFtdLFxuICAgICAgICBPRFNFbnRpdGllczogW11cbiAgICB9O1xuICAgIGlmICghYmxhZGUpIHJldHVybiByZXRWYWx1ZTtcblxuICAgIGxldCBhbGxPZHNBc3BlY3RzID0gZ2V0T2RzV2lkZ2V0cyhibGFkZSk7XG5cbiAgICAvLyBwLm9wdGlvbnMucm9sZUNvbmZpZ01vZGVscy5mb3JFYWNoKChyOmFueSkgPT4ge1xuICAgIGFsbE9kc0FzcGVjdHM/LmZvckVhY2goYSA9PiB7XG5cbiAgICAgICAgYS53aWRnZXQub2RzRW50aXRpZXMoKS5mb3JFYWNoKG9kcyA9PiB7XG4gICAgICAgICAgICBpZiAoIW9kcy5yb2xlU3lzdGVtTmFtZSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKG9kcy5yb2xlU3lzdGVtTmFtZSgpID09PSByb2xlKSB7XG4gICAgICAgICAgICAgICAgcmV0VmFsdWUuT0RTRW50aXRpZXMucHVzaChvZHMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuXG4gICAgICAgIGEud2lkZ2V0Lm9wdGlvbnMucm9sZUNvbmZpZ01vZGVscy5mb3JFYWNoKHIgPT4ge1xuICAgICAgICAgICAgaWYgKHIucm9sZVN5c3RlbU5hbWUgPT09IHJvbGUpIHtcbiAgICAgICAgICAgICAgICByZXRWYWx1ZS5yb2xlQ29uZmlnLnB1c2gocik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG5cbiAgICB9KVxuXG4gICAgLy8gaWYoIWFsbE9kc0FzcGVjdHMpIHJldHVybiByZXRWYWx1ZTtcbiAgICAvLyBsZXQgYXNwZWN0V2l0aFBhcnRuZXIgPSBhbGxPZHNBc3BlY3RzLmZpbHRlcihhPT5hLndpZGdldC5vZHNFbnRpdGllcygpLmZpbmQoKG86YW55KT0+by5yb2xlTmFtZT09PXJvbGUpKTtcbiAgICAvLyBpZighYXNwZWN0V2l0aFBhcnRuZXIpIHJldHVybiByZXRWYWx1ZTtcblxuICAgIC8vIGZvcihsZXQgYXNwZWN0IG9mIGFzcGVjdFdpdGhQYXJ0bmVyKVxuICAgIC8vIHtcbiAgICAvLyAgICAgbGV0IG9kc1BhcnRuZXIgPSBhc3BlY3Qud2lkZ2V0Lm9kc0VudGl0aWVzKCkuZmluZCgobzphbnkpPT5vLnJvbGVOYW1lPT09cm9sZSk7XG4gICAgLy8gICAgIGlmKCFvZHNQYXJ0bmVyKSBjb250aW51ZTtcbiAgICAvLyAgICAgcmV0VmFsdWUucHVzaChvZHNQYXJ0bmVyKTtcbiAgICAvLyB9XG4gICAgcmV0dXJuIHJldFZhbHVlO1xufVxuXG4vKipcbiAqIFRoaXMgZnVuY3Rpb24gcmV0dXJucyBhbGwgdGhlIHJvbGUgY29uZmlnIGZvciBhIGdpdmVuIHJvbGVcbiAqIEBwYXJhbSBibGFkZVxuICogQHBhcmFtIHJvbGVcbiAqIEByZXR1cm5zXG4qKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRPZHNXaWRnZXRzKGJsYWRlOiBUU2hhcmVEb0JsYWRlKTogSUFzcGVjdDxJT2RzV2lkZ2V0PltdIHwgdW5kZWZpbmVkIHtcbiAgICBpZiAoIWJsYWRlKSByZXR1cm4gdW5kZWZpbmVkO1xuXG4gICAgbGV0IHR5cGVUb0NoZWNrID0gU2hhcmVkby5Db3JlLkNhc2UuQXNwZWN0cy5XaWRnZXRzLk9kc0VudGl0eVBpY2tlcjtcblxuICAgIGxldCByZXRWYWx1ZSA9IGJsYWRlLmFzcGVjdHMoKS5maWx0ZXIoYSA9PiBhLndpZGdldCBpbnN0YW5jZW9mIHR5cGVUb0NoZWNrKTtcbiAgICByZXR1cm4gcmV0VmFsdWU7XG5cbn1cblxuLy8gI3JlZ2lvbiBHZXQgYWxsIHJvbGUgY29uZmlnIGZvciByb2xlXG4vLyAjcmVnaW9uIHByaXZhdGUgZnVuY3Rpb25zXG4vKipcbiAqIFVzZXMgdGhlIFwiL2FwaS9vZHMvX3NlYXJjaFwiIGVuZHBvaW50IHRvIHNlYXJjaCBmb3IgY2xpZW50cy5cbiAqIEBwYXJhbSBzZWFyY2ggVGhlIHNlYXJjaCBzdHJpbmcgdG8gdXNlIHN1Y2ggYXMgY2xpZW50IGNvZGUgb3IgbmFtZVxuICogQHJldHVybnMgQSBsaXN0IG9mIGNsaWVudHNcbiAqL1xuYXN5bmMgZnVuY3Rpb24gc2VhcmNoT2RzQW5kUmV0dXJuUm93czxUPihzZWFyY2g6IHN0cmluZyxwb3N0Qm9keTphbnkpOiBQcm9taXNlPFRbXT4ge1xuICAgIGxldCBBUElSZXN1bHQgPSBhd2FpdCBfc2VhcmNoPFQ+KHBvc3RCb2R5KTtcbiAgICAvL2xvZyBjb2xvclxuICAgIGNvbnNvbGUubG9nKFwiJWMgT0RTIFNlYXJjaCBSZXN1bHRcIiwgXCJjb2xvcjogI2ZmMDAwMFwiLCBBUElSZXN1bHQpO1xuICAgIGlmKCFBUElSZXN1bHQpIFxuICAgIHtcbiAgICAgICAgY29uc29sZS5sb2coXCIlYyBPRFMgU2VhcmNoIFJlc3VsdCAtIHVuZGVmaW5lZFwiLCBcImNvbG9yOiAjZmYwMDAwXCIpO1xuICAgICAgICByZXR1cm4gW107ICBcbiAgICB9XG4gICAgY29uc29sZS5sb2coXCIlYyBPRFMgU2VhcmNoIFJlc3VsdFwiLCBcImNvbG9yOiAjZmYwMDAwXCIsIEFQSVJlc3VsdCk7XG4gICAgcmV0dXJuIGV4dHJhY3RSb3dzRnJvbU9EU1NlYXJjaFJlc3VsdHM8VD4oQVBJUmVzdWx0KTtcbiAgXG59XG5cbmZ1bmN0aW9uIGV4dHJhY3RSb3dzRnJvbU9EU1NlYXJjaFJlc3VsdHM8VD4oIEFQSVJlc3VsdDogSU9EU2VhcmNoUmVzdWx0PFQ+KSA6IFRbXVxuIHtcbiAgICB0cnlcbiAgICB7XG4gICAgICAgIGxldCByZXRWYWx1ZSA9IEFQSVJlc3VsdC5yb3dzLm1hcChyID0+IEpTT04ucGFyc2Uoci5yZXN1bHQpKTtcbiAgICAgICAgcmV0dXJuIHJldFZhbHVlO1xuICAgIH1cbiAgICBjYXRjaChlKVxuICAgIHtcbiAgICAgICAgY29uc29sZS53YXJuKFwiT0RTIEhlbHBlciBFcnJvciB0cnlpbmcgdG8gZXh0cmFjdCByb3dzIGZyb20gc2VhcmNoIHJlc3VsdFwiLCBlLEFQSVJlc3VsdCk7XG4gICAgfVxuICAgIHJldHVybiBbXTtcbn1cblxuXG5cbi8vICNlbmRyZWdpb24gcHJpdmF0ZSBmdW5jdGlvbnMiLCJpbXBvcnQgeyBJT0RTU2VhcmNoUG9zdEJvZHkgfSBmcm9tIFwiLi4vLi4vLi4vLi4vVHlwaW5ncy9hcGkvb2RzL19zZWFyY2hcIjtcbmltcG9ydCB7IElPRFNlYXJjaFJlc3VsdCB9IGZyb20gXCIuLi8uLi8uLi8uLi9UeXBpbmdzL09kc0xpc3QvSU9EU1NlYXJjaFJlc3VsdFwiO1xuaW1wb3J0IHsgZXhlY3V0ZVBvc3QgfSBmcm9tIFwiLi4vYXBpXCI7XG5cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIF9zZWFyY2g8VD4ocG9zdEJvZHk6SU9EU1NlYXJjaFBvc3RCb2R5KSA6IFByb21pc2U8SU9EU2VhcmNoUmVzdWx0PFQ+IHwgdW5kZWZpbmVkPlxue1xuICAgIHRyeVxuICAgIHtcbiAgICAgICAgbGV0IGFwaSA9IFwiL2FwaS9vZHMvX3NlYXJjaFwiO1xuICAgICAgICByZXR1cm4gYXdhaXQgZXhlY3V0ZVBvc3Q8SU9EU2VhcmNoUmVzdWx0PFQ+Pih3aW5kb3cuZG9jdW1lbnQubG9jYXRpb24ub3JpZ2luICsgYXBpLCBwb3N0Qm9keSk7XG4gICAgfVxuICAgIGNhdGNoIChlKVxuICAgIHtcbiAgICAgICAgY29uc29sZS53YXJuKFwiT0RTIFNlYXJjaCBFcnJvclwiLCBlLHBvc3RCb2R5KTtcbiAgICB9XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbn1cblxuIiwiXG4vKipcbiAqIFRoaXMgZmlsZSBjb250YWlucyB0aGUgYXBpIGNhbGxzIHRvIHRoZSBiYWNrZW5kLlxuICogdXRpbGlzaW5nIHRoZSBheGlvcyBsaWJyYXJ5IHRvIG1ha2UgdGhlIGNhbGxzLlxuICogaW5jbHVzaW5nIG9mIHdlYnBhY2tJZ25vcmUgaXMgdG8gYWxsb3cgdGhlIHdlYnBhY2sgdG8gaWdub3JlIHRoZSBjYWxscyBhbmQgbm90IHRyeSB0byBidW5kbGUgdGhlbS5cbiAqL1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZVBvc3Q8VD4oYXBpOiBzdHJpbmcsIHBvc3RCb2R5OiBhbnkpIDogUHJvbWlzZTxUPntcbiAgICByZXR1cm4gYXdhaXQgJGFqYXgucG9zdCgvKiB3ZWJwYWNrSWdub3JlOiB0cnVlICovIGFwaSwgcG9zdEJvZHkpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZUdldDxUPihhcGk6IHN0cmluZykgOiBQcm9taXNlPFQ+e1xuICAgIHJldHVybiBhd2FpdCAkYWpheC5nZXQoLyogd2VicGFja0lnbm9yZTogdHJ1ZSAqLyBhcGkpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZVB1dDxUPihhcGk6IHN0cmluZywgcG9zdEJvZHk6IGFueSkgOiBQcm9taXNlPFQ+e1xuICAgIHJldHVybiBhd2FpdCAkYWpheC5wdXQoLyogd2VicGFja0lnbm9yZTogdHJ1ZSAqLyBhcGksIHBvc3RCb2R5KTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVEZWxldGU8VD4oYXBpOiBzdHJpbmcpIDogUHJvbWlzZTxUPntcbiAgICByZXR1cm4gYXdhaXQgJGFqYXguZGVsZXRlKC8qIHdlYnBhY2tJZ25vcmU6IHRydWUgKi8gYXBpKTtcbn1cbiIsIlxuaW1wb3J0IHsgSUZvcm1CdWlsZGVyQ29udGV4dCB9IGZyb20gXCIuLi8uLi8uLi8uLi9UeXBpbmdzL0Zvcm1CdWlsZGVyL0lGb3JtQnVpbGRlckNvbnRleHRcIjtcbmltcG9ydCB7IElTaGFyZURvT3B0aW9uU2V0IH0gZnJvbSBcIi4uLy4uLy4uLy4uL1R5cGluZ3MvT3B0aW9uU2V0cy9JU2hhcmVEb09wdGlvblNldFwiO1xuaW1wb3J0IHsgSU9kc0VudGl0eSB9IGZyb20gXCIuLi8uLi8uLi8uLi9UeXBpbmdzL1dpZGdldHNPZHNFbnRpdHlQaWNrZXIvSU9kc0VudGl0eVwiO1xuaW1wb3J0IHsgIGdldEFsbFJvbGVDb25maWdGb3JSb2xlLCBzZWFyY2hGb3JDbGllbnRzLCBzZWFyY2hGb3JVc2VycyB9IGZyb20gXCIuLi8uLi8uLi9Db21tb24vT2RzSGVscGVyXCI7XG5pbXBvcnQgeyBGb3JtQnVpbGRlciB9IGZyb20gXCIuLi8uLi8uLi9Nb2R1bGVMb2FkZXIvQWxwaGFjYUFkYXB0ZXJcIjtcbmltcG9ydCB7IElFeHBlcnRNYXR0ZXIgfSBmcm9tIFwiLi4vVHlwaW5ncy9JRXhwZXJ0TWF0dGVyRGF0YVwiO1xuXG50eXBlIE9kc1dpZGdldCA9IHtcbiAgICBba2V5OnN0cmluZ106IGFueVxufTtcblxuLy9jb25zdGFudHMgXG5jb25zdCBtYXR0ZXJQYXJ0bmVyUm9sZVN5c3RlbU5hbWUgPSBcIm1hdHRlci1wYXJ0bmVyXCI7XG5jb25zdCBjbGllbnRSb2xlU3lzdGVtTmFtZSA9IFwiY2xpZW50XCI7XG5cbi8vVGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgZnJvbSB0aGUgbW9kdWxlLWxvYWRlciB3ZWJjb21wb25lbnQgaW4gdGhlIGZvcm0gYnVpbGRlclxuZXhwb3J0IGZ1bmN0aW9uIHJ1bk1lKGNvbnRleHQ6IElGb3JtQnVpbGRlckNvbnRleHQpIHtcbiAgIFxuICAgIGxldCB7IGV4cGVydE1hdHRlck51bWJlciwgbWF0dGVyRGV0YWlscywgcGlwZWxpbmVNYXR0ZXIgfSA9IGNyZWF0ZVZhcmlhYmxlcyhjb250ZXh0KTtcblxuICAgIGlmKCFleHBlcnRNYXR0ZXJOdW1iZXIpIHRocm93IG5ldyBFcnJvcihcIk5vIGV4cGVydE1hdHRlck51bWJlclwiKTtcbiAgICBpZighbWF0dGVyRGV0YWlscykgdGhyb3cgbmV3IEVycm9yKFwiTm8gbWF0dGVyRGV0YWlsc1wiKTtcbiAgICBpZighcGlwZWxpbmVNYXR0ZXIpIHRocm93IG5ldyBFcnJvcihcIk5vIHBpcGVsaW5lTWF0dGVyXCIpO1xuICAgIFxuICAgICh3aW5kb3cgYXMgYW55KS50ZXN0ZXIgPSBjb250ZXh0OyAvL2p1c3QgZm9yIGRlYnVnZ2luZ1xuICAgIFxuICAgIGlmKGNvbnRleHQud29ya0l0ZW1Db250ZXh0LmlkKCkgIT09IHVuZGVmaW5lZCAmJiAhY29udGV4dC53b3JrSXRlbUNvbnRleHQ/LnBoYXNlTmFtZSgpPy50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwiZHJhZnRcIikpXG4gICAge1xuICAgICAgICAvL29ubHkgcnVuIHRoaXMgY29kZSBpZiB0aGUgd29yayBpdGVtIGlzIG5ld1xuICAgICAgICBjb25zb2xlLmxvZyhcIiVjIFtNb2R1bGVMb2FkZXJdIEZCX01hdHRlckRldGFpbHMgLSBleGl0IChvbmx5IHJ1biBvbiBuZXcpXCIsIFwiYmFja2dyb3VuZDogIzIyMjsgY29sb3I6ICNiYWRhNTVcIiwgY29udGV4dC53b3JrSXRlbUNvbnRleHQuaWQoKSk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBoaWRlU2hvd01hdHRlckRldGFpbHMobWF0dGVyRGV0YWlscywgZXhwZXJ0TWF0dGVyTnVtYmVyLCBwaXBlbGluZU1hdHRlcik7XG4gICAgLy9hZGQgYSBjaGFuZ2UgZXZlbnQgdG8gdGhlIGV4cGVydC1tYXR0ZXItbnVtYmVyXG4gICAgYWRkRXZlbnRIYW5kbGVycyhjb250ZXh0LCBtYXR0ZXJEZXRhaWxzLCBleHBlcnRNYXR0ZXJOdW1iZXIsIHBpcGVsaW5lTWF0dGVyKTtcbiAgICBnZW5lcmF0ZVRlbXBNYXR0ZXJOdW1iZXIoY29udGV4dCk7XG59XG5cbi8vIFRoaXMgZnVuY3Rpb24gY3JlYXRlcyB2YXJpYWJsZXMgZm9yIHRoZSBmb3JtLlxuZnVuY3Rpb24gY3JlYXRlVmFyaWFibGVzKGNvbnRleHQ6IElGb3JtQnVpbGRlckNvbnRleHQpIHtcbiAgICAvLyBHZXQgdGhlIGZpZWxkc1xuICAgIC8vIGxldCBtYXR0ZXJEZXRhaWxzID0gY29udGV4dC5maWVsZHNbZW51bUZpZWxkcy5tYXR0ZXJEZXRhaWxzXTtcblxuICAgIGlmKCFjb250ZXh0LmZvcm0pIHRocm93IG5ldyBFcnJvcihcIk5vIGZvcm1cIik7XG5cbiAgICBsZXQgbWF0dGVyRGV0YWlscyA9IGNvbnRleHQuZm9ybS5maWVsZHNCeUlkW2VudW1GaWVsZHMubWF0dGVyRGV0YWlsc107IFxuICAgIGxldCBleHBlcnRNYXR0ZXJOdW1iZXIgPSBjb250ZXh0LmZvcm0uZmllbGRzQnlJZFtlbnVtRmllbGRzLmV4cGVydE1hdHRlck51bWJlcl07XG4gICAgbGV0IHBpcGVsaW5lTWF0dGVyID0gY29udGV4dC5mb3JtLmZpZWxkc0J5SWRbZW51bUZpZWxkcy5waXBlbGluZU1hdHRlcl07XG4gICAgXG5cbiAgICAvLyBSZXR1cm4gdGhlIHZhcmlhYmxlc1xuICAgIHJldHVybiB7IGV4cGVydE1hdHRlck51bWJlciwgbWF0dGVyRGV0YWlscywgcGlwZWxpbmVNYXR0ZXIgfTtcbn1cblxuZnVuY3Rpb24gYWRkRXZlbnRIYW5kbGVycyhjb250ZXh0OiBJRm9ybUJ1aWxkZXJDb250ZXh0LCBtYXR0ZXJEZXRhaWxzOiBGb3JtQnVpbGRlciwgZXhwZXJ0TWF0dGVyTnVtYmVyOiBGb3JtQnVpbGRlciwgcGlwZWxpbmVNYXR0ZXI6IEZvcm1CdWlsZGVyKSB7XG4gICAgaWYoIWNvbnRleHQuZm9ybSkgdGhyb3cgbmV3IEVycm9yKFwiTm8gZm9ybVwiKTtcbiAgICAvL2FkZCBldmVudCBoYW5kbGV0IGZvciBleHBlcnQtbWF0dGVyLW51bWJlciBjaGFuZ2VkXG4gICAgbWF0dGVyRGV0YWlscy5maWVsZHNCeUlkW2VudW1NYXR0ZXJEZXRhaWxGaWVsZHMubWF0dGVyRGV0YWlsc1BhcnRuZXJOYW1lXT8ub24oXCJjaGFuZ2VcIiwgZnVuY3Rpb24gKHRoaXM6IGFueSwgZXY6IGFueSkge1xuICAgICAgICBjb25zb2xlLmxvZyhcIiVjIFBhcnRuZXIgbmFtZSBjaGFuZ2VkIHRvOiBcIiArIG1hdHRlckRldGFpbHMuZmllbGRzQnlJZFtlbnVtTWF0dGVyRGV0YWlsRmllbGRzLm1hdHRlckRldGFpbHNQYXJ0bmVyTmFtZV0/LmdldFZhbHVlKCksIFwiY29sb3I6IHBpbms7IGZvbnQtc2l6ZTogMjBweDtcIik7XG4gICAgfSk7XG5cbiAgICAvL2FkZCBldmVudCBoYW5kbGV0IGZvciBleHBlcnQtbWF0dGVyLW51bWJlciBjaGFuZ2VkXG4gICAgY29udGV4dC5mb3JtLmZpZWxkc0J5SWRbZW51bUZpZWxkcy5leHBlcnRNYXR0ZXJOdW1iZXJdPy5vbihcImNoYW5nZVwiLCBmdW5jdGlvbiAodGhpczogYW55LCBldjogYW55KSB7XG4gICAgICAgIC8vIGhpZGUgb3Igc2hvdyB0aGUgbWF0dGVyIGRldGFpbHMgZmllbGRcbiAgICAgICAgaGlkZVNob3dNYXR0ZXJEZXRhaWxzKG1hdHRlckRldGFpbHMsIGV4cGVydE1hdHRlck51bWJlciwgcGlwZWxpbmVNYXR0ZXIpO1xuICAgICAgICAvLyB1cGRhdGUgdGhlIG1hdHRlciBkZXRhaWxzIGZpZWxkXG4gICAgICAgIHVwZGF0ZU1hdHRlckRldGFpbHMoY29udGV4dCxtYXR0ZXJEZXRhaWxzLCBleHBlcnRNYXR0ZXJOdW1iZXIsIHBpcGVsaW5lTWF0dGVyKTtcbiAgICB9KTtcblxuICAgIC8vYWRkIGV2ZW50IGhhbmRsZXQgZm9yIHBpcGVsaW5lLW1hdHRlciBjaGFuZ2VkXG4gICAgY29udGV4dC5mb3JtLmZpZWxkc0J5SWRbZW51bUZpZWxkcy5waXBlbGluZU1hdHRlcl0/Lm9uKFwiY2hhbmdlXCIsIGZ1bmN0aW9uICh0aGlzOiBhbnksIGV2OiBhbnkpIHtcbiAgICAgICAgLy8gaGlkZSBvciBzaG93IHRoZSBtYXR0ZXIgZGV0YWlscyBmaWVsZFxuICAgICAgICBoaWRlU2hvd01hdHRlckRldGFpbHMobWF0dGVyRGV0YWlscywgZXhwZXJ0TWF0dGVyTnVtYmVyLCBwaXBlbGluZU1hdHRlcik7XG4gICAgICAgIC8vIHVwZGF0ZSB0aGUgbWF0dGVyIGRldGFpbHMgZmllbGRcbiAgICAgICAgdXBkYXRlTWF0dGVyRGV0YWlscyhjb250ZXh0LG1hdHRlckRldGFpbHMsIGV4cGVydE1hdHRlck51bWJlciwgcGlwZWxpbmVNYXR0ZXIpOyBcbiAgICB9KTtcblxuICAgIC8vYWRkIGV2ZW50IGhhbmRsZXQgZm9yIGp1cmlzZGljdGlvbiBjaGFuZ2VkXG4gICAgLy91cGRhdGUgdGhlIE9PQiBKdXJpc2RpY3Rpb24gYXNwZWN0IGZpZWxkIGFuZCBmb3JtYnVpbGRlciBmaWVsZHNcbiAgICBjb250ZXh0LmZvcm0uZmllbGRzQnlJZFtlbnVtRmllbGRzLmp1cmlzZGljdGlvbnNDb3VudHJ5XT8ub24oXCJjaGFuZ2VcIiwgYXN5bmMgZnVuY3Rpb24gKHRoaXM6IGFueSwgZXY6IGFueSkge1xuICAgICAgICAvL3VwZGF0ZSBibGFkZSBqdXJpc2RpY3Rpb24gICAgIFxuICAgICAgICBsZXQgc2VsZWN0ZWRJZCA9IGNvbnRleHQuZm9ybT8uZmllbGRzQnlJZFtcImp1cmlzZGljdGlvbnMtY291bnRyeVwiXT8uZ2V0VmFsdWUoKTtcbiAgICAgICAgY29uc29sZS5sb2coXCIlYyBKdXJpc2RpY3Rpb24gY2hhbmdlZCB0bzogXCIgKyBjb250ZXh0LmZvcm0/LmZpZWxkc0J5SWRbXCJqdXJpc2RpY3Rpb25zLWNvdW50cnlcIl0/LmdldFZhbHVlKCksIFwiY29sb3I6IHJlZDsgZm9udC1zaXplOiAyMHB4O1wiKTtcbiAgICAgICAgbGV0IGFzcGVjdCA9IGNvbnRleHQuZ2V0QXNwZWN0KFwiU2hhcmVkby5Db3JlLkxlZ2FsLkFzcGVjdHMuV2lkZ2V0cy5JbnN0cnVjdGlvbldvcmtUeXBlRGV0YWlsc1wiKTtcbiAgICAgICAgbGV0IHNlbGVjdGVkSnVyaXNkaWN0aW9uQ291bnRyeSA9IGF3YWl0ICRhamF4LmdldCgvKiB3ZWJwYWNrSWdub3JlOiB0cnVlICovYC9hcGkvdjEvcHVibGljL21vZGVsbGVyL29wdGlvblNldHMvYWxsVmFsdWVzLyR7c2VsZWN0ZWRJZH1gKSBhcyBJU2hhcmVEb09wdGlvblNldDtcbiAgICAgICAgaWYgKCFzZWxlY3RlZEp1cmlzZGljdGlvbkNvdW50cnkpIHtcbiAgICAgICAgICAgIC8vbG9nIGlzc3VlXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIiVjIFtNb2R1bGVMb2FkZXJdIGdldEFzcGVjdCByZXR1cm4gdmFsdWVcIiwgXCJiYWNrZ3JvdW5kOiAjMjIyOyBjb2xvcjogI2JhZGE1NVwiLCBzZWxlY3RlZEp1cmlzZGljdGlvbkNvdW50cnkpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGxldCBvcHRpb25zID0gYXdhaXQgJGFqYXguZ2V0KC8qIHdlYnBhY2tJZ25vcmU6IHRydWUgKi9gL2FwaS92MS9wdWJsaWMvbW9kZWxsZXIvb3B0aW9uU2V0cy9qdXJpc2RpY3Rpb25zL3ZhbHVlc2ApO1xuICAgICAgICBsZXQgc2VsZWN0ZWRKdXJpc2RpY3Rpb24gPSBvcHRpb25zLmZpbmQoKG9wdGlvbjogSVNoYXJlRG9PcHRpb25TZXQpID0+IG9wdGlvbi5uYW1lID09PSBzZWxlY3RlZEp1cmlzZGljdGlvbkNvdW50cnkubmFtZSk7XG4gICAgICAgIGlmICghc2VsZWN0ZWRKdXJpc2RpY3Rpb24pIHtcbiAgICAgICAgICAgIC8vbG9nIGlzc3VlXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIiVjIFtNb2R1bGVMb2FkZXJdIGdldEFzcGVjdCByZXR1cm4gdmFsdWVcIiwgXCJiYWNrZ3JvdW5kOiAjMjIyOyBjb2xvcjogI2JhZGE1NVwiLCBzZWxlY3RlZEp1cmlzZGljdGlvbik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgYXNwZWN0LndpZGdldC5pbnN0cnVjdGlvbi5qdXJpc2RpY3Rpb25JZChzZWxlY3RlZEp1cmlzZGljdGlvbi5pZCk7XG4gICAgfSk7XG59XG5cbi8vIGhpZGUgb3Igc2hvdyB0aGUgbWF0dGVyIGRldGFpbHMgZmllbGRcbmZ1bmN0aW9uIGhpZGVTaG93TWF0dGVyRGV0YWlscyhtYXR0ZXJEZXRhaWxzOiBGb3JtQnVpbGRlciAsIGV4cGVydE1hdHRlck51bWJlcjogRm9ybUJ1aWxkZXIsIHBpcGVsaW5lTWF0dGVyOiBGb3JtQnVpbGRlcikge1xuICAgIHNldE1hdHRlckRldGFpbHNTdGF0ZShtYXR0ZXJEZXRhaWxzLCBwaXBlbGluZU1hdHRlci5nZXRWYWx1ZSgpKTtcbn1cblxuLy8gbWFrZSBhbGwgY2hpbGQgcHJvcGVydGllcyByZWFkb25seVxuZnVuY3Rpb24gc2V0TWF0dGVyRGV0YWlsc1N0YXRlKG1hdHRlckRldGFpbHM6IEZvcm1CdWlsZGVyLCBzdGF0dXM6IGJvb2xlYW4gPSB0cnVlKSB7XG4gICAgaWYoIW1hdHRlckRldGFpbHMuZmllbGRzKSB0aHJvdyBuZXcgRXJyb3IoXCJObyBmaWVsZHNcIik7XG4gICAgaWYoIW1hdHRlckRldGFpbHMuZmllbGRzQnlJZCkgdGhyb3cgbmV3IEVycm9yKFwiTm8gZmllbGRzQnlJZFwiKTtcbiAgICAvLyBnZXQgYWxsIHRoZSBjaGlsZCBwcm9wZXJ0aWVzXG4gICAgbWF0dGVyRGV0YWlscy5maWVsZHMuZm9yRWFjaChjaGlsZCA9PlxuICAgIHtcbiAgICAgICAgLy8gc2V0IHRoZSByZWFkb25seSBzdGF0dXMgb2YgdGhlIGNoaWxkIHByb3BlcnR5XG4gICAgICAgIGNoaWxkLnJlYWRvbmx5KCFzdGF0dXMpO1xuICAgIH0pO1xufVxuXG4vLyBjbGVhciBhbGwgdGhlIGNoaWxkIHByb3BlcnRpZXMgb2YgdGhlIG1hdHRlciBkZXRhaWxzIHN1YiBhcmVhIG9mIHRoZSBmb3JtIGJ1aWxkZXJcbmFzeW5jIGZ1bmN0aW9uIGNsZWFyTWF0dGVyRGV0YWlscyhtYXR0ZXJEZXRhaWxzOiBGb3JtQnVpbGRlcikge1xuICAgIG1hdHRlckRldGFpbHMuZmllbGRzPy5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZDogYW55KSB7XG4gICAgICAgIGNoaWxkLnNldFZhbHVlKFwiXCIpO1xuICAgIH0pOyBcbn1cblxuXG4vKiBcbjEuIFdlIGZpcnN0IGdldCB0aGUgZGF0YSBmcm9tIHRoZSBlbmRwb2ludCBieSBjYWxsaW5nIGdldE1hdHRlckRhdGEoKSBmdW5jdGlvblxuMi4gVGhlbiB3ZSBjbGVhciB0aGUgbWF0dGVyRGV0YWlsc1xuMy4gV2UgZmluZCB0aGUgc2VsZWN0ZWQgbWF0dGVyIGJ5IHVzaW5nIHRoZSBtYXR0ZXIgY29kZSBhbmQgY2xpZW50IGNvZGUgZnJvbSB0aGUgZGF0YSB3ZSBnb3QgZnJvbSB0aGUgZW5kcG9pbnRcbjQuIElmIHRoZSBtYXR0ZXIgaXMgdW5kZWZpbmVkLCB3ZSBjbGVhciB0aGUgbWF0dGVyRGV0YWlscyBhbmQgcmV0dXJuXG41LiBJZiB0aGUgbWF0dGVyIGlzIG5vdCB1bmRlZmluZWQsIHdlIHNldCB0aGUgdmFsdWVzIG9mIHRoZSBtYXR0ZXJEZXRhaWxzIGZpZWxkcyAqL1xuYXN5bmMgZnVuY3Rpb24gdXBkYXRlTWF0dGVyRGV0YWlscyhjb250ZXh0OiBJRm9ybUJ1aWxkZXJDb250ZXh0LG1hdHRlckRldGFpbHM6IEZvcm1CdWlsZGVyLCBleHBlcnRNYXR0ZXJOdW1iZXI6IEZvcm1CdWlsZGVyLCBwaXBlbGluZU1hdHRlcjogRm9ybUJ1aWxkZXIpIHtcblxuICAgIGxldCBkYXRhID0gYXdhaXQgZ2V0TWF0dGVyRGF0YSgpO1xuXG4gICAgY2xlYXJNYXR0ZXJEZXRhaWxzKG1hdHRlckRldGFpbHMpOyAvL2NsZWFyIHRoZSBtYXR0ZXIgZGV0YWlscyBmb3JtXG4gICAgbGV0IHNlbGVjdGVkTWF0dGVyID0gZGF0YS5maW5kKGZ1bmN0aW9uIChtYXR0ZXI6IGFueSkge1xuICAgICAgICAvL3NldCB0aGUgZGlzcGxheSBwb3J0aW9uIG9mIHRoZSBleHBlcnQtbWF0dGVyLW51bWJlciBmaWVsZFxuICAgICAgIC8vIHJldHVybiBleHBlcnRNYXR0ZXJOdW1iZXIuZ2V0VmFsdWUoKSA9PT0gYCR7bWF0dGVyLmRhdGEubWF0dGVyQ29kZX0gLSAke21hdHRlci5kYXRhLmNsaWVudC5uYW1lfWA7XG4gICAgICAgcmV0dXJuIGV4cGVydE1hdHRlck51bWJlci5nZXRWYWx1ZSgpID09PSBtYXR0ZXIuZGF0YS5tYXR0ZXJDb2RlO1xuICAgICAgICBcbiAgICB9KTtcblxuICAgIGlmIChzZWxlY3RlZE1hdHRlciA9PT0gdW5kZWZpbmVkIHx8IHBpcGVsaW5lTWF0dGVyLmdldFZhbHVlKCkgPT09IHRydWUpIHsgLy9pZiB0aGUgbWF0dGVyIGlzIG5vdCBmb3VuZCBvciBpZiB0aGUgbWF0dGVyIGlzIGEgcGlwZWxpbmUgbWF0dGVyLCBjbGVhciB0aGUgbWF0dGVyIGRldGFpbHMgZm9ybSBhbmQgcmV0dXJuXG4gICAgICAgIGNsZWFyTWF0dGVyRGV0YWlscyhtYXR0ZXJEZXRhaWxzKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmKCFtYXR0ZXJEZXRhaWxzLnBhcmVudD8uZmllbGRzQnlJZCkgdGhyb3cgbmV3IEVycm9yKFwiTm8gY2xpZW50XCIpO1xuICAgIGxldCB0ZW1wTWF0dGVyTnVtYmVyID0gbWF0dGVyRGV0YWlscy5wYXJlbnQ/LmZpZWxkc0J5SWRbJ3RlbXAtbWF0dGVyLW51bWJlciddPy5nZXRWYWx1ZSgpO1xuXG4gICAgaWYgKHRlbXBNYXR0ZXJOdW1iZXIgPT09IHVuZGVmaW5lZCB8fCB0ZW1wTWF0dGVyTnVtYmVyLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAvLyBtYXR0ZXJEZXRhaWxzLnBhcmVudC5jaGlsZHJlbkJ5UHJvcGVydHlJZFsndGVtcC1tYXR0ZXItbnVtYmVyJ10uc2V0VmFsdWUoXCJOL0FcIik7XG4gICAgfVxuXG4gICAgIC8vc2V0IHRoZSB2YWx1ZSBwb3J0aW9uIG9mIHRoZSBleHBlcnQtbWF0dGVyLW51bWJlciBmaWVsZFxuICAgICBjb250ZXh0LmZvcm0/LmZpZWxkc0J5SWRbZW51bUZpZWxkcy5leHBlcnRNYXR0ZXJOdW1iZXJWYWx1ZV0/LnNldFZhbHVlKHNlbGVjdGVkTWF0dGVyLmRhdGEubWF0dGVyQ29kZSk7XG4gICAgICAgXG5cbiAgICBtYXR0ZXJEZXRhaWxzLmZpZWxkc0J5SWRbZW51bU1hdHRlckRldGFpbEZpZWxkcy5tYXR0ZXJEZXRhaWxzQ2xpZW50TmFtZV0/LnNldFZhbHVlKHNlbGVjdGVkTWF0dGVyLmRhdGEuY2xpZW50Lm5hbWUpO1xuICAgIG1hdHRlckRldGFpbHMuZmllbGRzQnlJZFtlbnVtTWF0dGVyRGV0YWlsRmllbGRzLm1hdHRlckRldGFpbHNDbGllbnRDb2RlXT8uc2V0VmFsdWUoc2VsZWN0ZWRNYXR0ZXIuZGF0YS5jbGllbnQuY29kZSk7XG4gICAgbWF0dGVyRGV0YWlscy5maWVsZHNCeUlkW2VudW1NYXR0ZXJEZXRhaWxGaWVsZHMubWF0dGVyRGV0YWlsc1ByYWN0aWNlQXJlYV0/LnNldFZhbHVlKHNlbGVjdGVkTWF0dGVyLmRhdGEucHJhY3RpY2VBcmVhLm5hbWUpO1xuICAgIG1hdHRlckRldGFpbHMuZmllbGRzQnlJZFtlbnVtTWF0dGVyRGV0YWlsRmllbGRzLm1hdHRlckRldGFpbHNOYW1lXT8uc2V0VmFsdWUoc2VsZWN0ZWRNYXR0ZXIuZGF0YS5zaG9ydE5hbWUpO1xuICAgIG1hdHRlckRldGFpbHMuZmllbGRzQnlJZFtlbnVtTWF0dGVyRGV0YWlsRmllbGRzLm1hdHRlckRldGFpbHNQYXJ0bmVyTmFtZV0/LnNldFZhbHVlKHNlbGVjdGVkTWF0dGVyLmRhdGEucGFydG5lci5uYW1lKTtcbiAgICBtYXR0ZXJEZXRhaWxzLmZpZWxkc0J5SWRbZW51bU1hdHRlckRldGFpbEZpZWxkcy5tYXR0ZXJEZXRhaWxzSWJdPy5zZXRWYWx1ZShzZWxlY3RlZE1hdHRlci5kYXRhLnNlY3VyZSk7XG5cbiAgICBjb25zb2xlLmxvZyhcIm1hdHRlckRldGFpbHMuaXNWYWxpZCgpOlwiICsgbWF0dGVyRGV0YWlscy5pc1ZhbGlkKCkpO1xuXG4gICAgdHJ5XG4gICAge1xuICAgICAgICB0cnlVcGRhdGVQYXJ0bmVyT2RzUGlja2VyKHNlbGVjdGVkTWF0dGVyLCBjb250ZXh0KTtcbiAgICAgICAgdHJ5VXBkYXRlQ2xpZW50T2RzUGlja2VyKHNlbGVjdGVkTWF0dGVyLCBjb250ZXh0KTtcbiAgICB9XG4gICAgY2F0Y2goZSlcbiAgICB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiRmFpbGVkIHRvIGF1dG8gdXBkYXRpbmcgb2RzIHBpY2tlcnMsIHVzZXIgcmVxdWlyZWQgdG8gc2VsZWN0IG1hbnVhbGx5XCIpO1xuICAgIH1cblxufVxuXG5cbi8qKlxuICogVHJ5IHRvIHVwZGF0ZSB0aGUgY2xpZW50IG9kcyBwaWNrZXIgdXNpbmcgdGhlIHNlbGVjdGVkIG1hdHRlciBcbiAqIFVzZXMgc2VhcmNoRm9yQ2xpZW50IGZ1bmN0aW9uIHdoaWMgaXMgYSBjb21tb24gb2RzIGhlbHBlciBmdW5jdGlvblxuICogQHBhcmFtIHNlbGVjdGVkTWF0dGVyIFRoZSBzZWxlY3RlZCBtYXR0ZXJcbiAqIEBwYXJhbSBjb250ZXh0IFRoZSBmb3JtIGJ1aWxkZXIgY29udGV4dFxuICovXG5mdW5jdGlvbiB0cnlVcGRhdGVDbGllbnRPZHNQaWNrZXIoc2VsZWN0ZWRNYXR0ZXI6IElFeHBlcnRNYXR0ZXIsIGNvbnRleHQ6IElGb3JtQnVpbGRlckNvbnRleHQpIHtcbiAgICBsZXQgY2xpZW50Q29kZSA9IHNlbGVjdGVkTWF0dGVyLmRhdGEuY2xpZW50LmNvZGU7XG4gICAgc2VhcmNoRm9yQ2xpZW50cyhjbGllbnRDb2RlKS50aGVuKChjbGllbnRzKSA9PiB7XG4gICAgICAgIGxldCBjbGllbnQgPSBjbGllbnRzWzBdO1xuICAgICAgICBjb25zb2xlLmxvZyhcIiVjIEZvdW5kIENsaWVudCBuYW1lIDogXCIgKyBjbGllbnQ/Lm5hbWUsIFwiY29sb3I6IHBpbms7IGZvbnQtc2l6ZTogMjBweDtcIiwgY2xpZW50cyk7XG4gICAgICAgIGxldCBvZHNDbGllbnQgPSBnZXRDbGllbnRPZHNQaWNrZXIoY29udGV4dCk7XG4gICAgICAgIGxldCBvZHNSb2xlQ29uZmlnID0gb2RzQ2xpZW50LnJvbGVDb25maWdbMF07XG4gICAgICAgIGxldCBvZHNFbnRpdGllcyA9IG9kc0NsaWVudC5PRFNFbnRpdGllc1swXTtcbiAgICBcbiAgICAgICAgaWYgKCFvZHNSb2xlQ29uZmlnIHx8ICFvZHNFbnRpdGllcylcbiAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICBpZiAoIWNsaWVudCkge1xuICAgICAgICAgICAgb2RzRW50aXRpZXMuc2VsZWN0ZWQoZmFsc2UpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGxldCBlbnRpdHkgOiBJT2RzRW50aXR5ID0gb2RzUm9sZUNvbmZpZy5hZGRTZXJ2aWNlLmNyZWF0ZVNlbGVjdGVkRW50aXR5TW9kZWwoY2xpZW50LmlkLCBcIm9yZ2FuaXNhdGlvblwiLCBjbGllbnQubmFtZSk7XG4gICAgICAgIG9kc1JvbGVDb25maWcuYWRkU2VydmljZS5zZWxlY3RlZEVudGl0eShlbnRpdHkpO1xuICAgIH0pO1xufVxuXG4vKipcbiAqIFRyaWVzIHRvIHVwZGF0ZSB0aGUgcGFydG5lciBvZHMgcGlja2VyXG4gKiBAcGFyYW0gc2VsZWN0ZWRNYXR0ZXIgVGhlIHNlbGVjdGVkIG1hdHRlclxuICogQHBhcmFtIGNvbnRleHQgIFRoZSBmb3JtIGJ1aWxkZXIgY29udGV4dFxuICovXG5mdW5jdGlvbiB0cnlVcGRhdGVQYXJ0bmVyT2RzUGlja2VyKHNlbGVjdGVkTWF0dGVyOiBJRXhwZXJ0TWF0dGVyLCBjb250ZXh0OiBJRm9ybUJ1aWxkZXJDb250ZXh0KSB7XG4gICAgbGV0IHBhcnRuZXJMYXN0TmFtZSA9IHNlbGVjdGVkTWF0dGVyLmRhdGEucGFydG5lci5uYW1lLnNwbGl0KFwiLFwiKVswXTtcbiAgICBzZWFyY2hGb3JVc2VycyhzZWxlY3RlZE1hdHRlci5kYXRhLnBhcnRuZXIuZW1haWwpLnRoZW4oKHVzZXJzKSA9PiB7XG4gICAgICAgIGxldCB1c2VyID0gdXNlcnNbMF07XG4gICAgICAgIGNvbnNvbGUubG9nKFwiJWMgUGFydG5lciBuYW1lIGNoYW5nZWQgdG86IFwiICsgdXNlcj8uaWQsIFwiY29sb3I6IHBpbms7IGZvbnQtc2l6ZTogMjBweDtcIiwgdXNlcik7XG4gICAgICAgIGxldCBvZHNNYXR0ZXJQYXJ0bmVyID0gZ2V0UGFydG5lck9kc1BpY2tlcihjb250ZXh0KTtcbiAgICAgICAgbGV0IG9kc1JvbGVDb25maWcgPSBvZHNNYXR0ZXJQYXJ0bmVyLnJvbGVDb25maWdbMF07XG4gICAgICAgIGxldCBvZHNFbnRpdGllcyA9IG9kc01hdHRlclBhcnRuZXIuT0RTRW50aXRpZXNbMF07XG4gICAgXG4gICAgICAgIGlmICghb2RzUm9sZUNvbmZpZyB8fCAhb2RzRW50aXRpZXMpXG4gICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgaWYgKCF1c2VyKSB7XG4gICAgICAgICAgICBvZHNFbnRpdGllcy5zZWxlY3RlZChmYWxzZSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgZW50aXR5IDogSU9kc0VudGl0eSA9IG9kc1JvbGVDb25maWcuYWRkU2VydmljZS5jcmVhdGVTZWxlY3RlZEVudGl0eU1vZGVsKHVzZXIuaWQsIFwidXNlclwiLCB1c2VyLmZpcnN0TmFtZSArIFwiIFwiICsgdXNlci5zdXJuYW1lKTtcbiAgICAgICAgb2RzUm9sZUNvbmZpZy5hZGRTZXJ2aWNlLnNlbGVjdGVkRW50aXR5KGVudGl0eSk7XG4gICAgfSk7XG59XG5cbi8qKlxuICogQ2FsbCB0aGUgc2VydmVyIHRvIGdldCB0aGUgbWF0dGVyIGRhdGFcbiAqIEByZXR1cm5zIHRoZSBkYXRhIGZyb20gdGhlIHNlcnZlciB3aXRob3V0IGNhY2hlXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGdldE1hdHRlckRhdGEoKSB7XG4gICAgLy9nZXQgdGhlIGRhdGEgZnJvbSB0aGUgc2VydmVyIHdpdGhvdXQgY2FjaGVcbiAgICByZXR1cm4gYXdhaXQgJGFqYXguZ2V0KC8qIHdlYnBhY2tJZ25vcmU6IHRydWUgKi8gd2luZG93LmRvY3VtZW50LmxvY2F0aW9uLm9yaWdpbiArIFwiL19pZGVGaWxlcy9TYW1wbGVEYXRhL2VEaXNjb3ZlcnkvbWF0dGVycy5qc29uXCIpIGFzIElFeHBlcnRNYXR0ZXJbXTtcbn1cblxuLyoqXG4gKiBHZW5lcmF0ZXMgYSB0ZW1wIG1hdHRlciBudW1iZXIgYW5kIHNldHMgaXQgdG8gdGhlIHRlbXAtbWF0dGVyLW51bWJlciBmaWVsZFxuICogQHBhcmFtIGNvbnRleHQgVGhlIGZvcm0gYnVpbGRlciBjb250ZXh0XG4gKi9cbmZ1bmN0aW9uIGdlbmVyYXRlVGVtcE1hdHRlck51bWJlcihjb250ZXh0OiBJRm9ybUJ1aWxkZXJDb250ZXh0KVxue1xuICAgIGxldCBkYXRlID0gbmV3IERhdGUoKTtcbiAgICBsZXQgeWVhciA9IGRhdGUuZ2V0RnVsbFllYXIoKTtcbiAgICBsZXQgbW9udGggPSBkYXRlLmdldE1vbnRoKCkgKyAxO1xuICAgIGxldCBkYXkgPSBkYXRlLmdldERhdGUoKTsgXG4gICAgbGV0IGhvdXIgPSBkYXRlLmdldEhvdXJzKCk7XG4gICAgbGV0IG1pbnV0ZSA9IGRhdGUuZ2V0TWludXRlcygpO1xuICAgIGxldCBzZWNvbmQgPSBkYXRlLmdldFNlY29uZHMoKTtcbiAgICBsZXQgbWlsbGlzZWNvbmQgPSBkYXRlLmdldE1pbGxpc2Vjb25kcygpO1xuICAgIGxldCB0ZW1wTWF0dGVyTnVtYmVyID0gYFQke3llYXJ9JHttb250aH0ke2RheX0ke2hvdXJ9JHttaW51dGV9JHtzZWNvbmR9JHttaWxsaXNlY29uZH1gO1xuICAgIGNvbnRleHQuZm9ybT8uZmllbGRzQnlJZFtlbnVtRmllbGRzLnRlbXBNYXR0ZXJOdW1iZXJdPy5zZXRWYWx1ZSh0ZW1wTWF0dGVyTnVtYmVyKTtcbn1cblxuLyoqXG4gKiBFbnVtIGZvciB0aGUgZmllbGRzIGluIHRoZSBmb3JtIGJ1aWxkZXJcbiAqL1xuZXhwb3J0IGVudW0gZW51bUZpZWxkcyB7XG4gICAgY3VzdG9tQWx0RWRpc2NvdmVyeUluc3RydWN0aW9uTWF0dGVyRGV0YWlscyA9IFwiY3VzdG9tLWFsdC1lZGlzY292ZXJ5LWluc3RydWN0aW9uLW1hdHRlci1kZXRhaWxzXCIsXG4gICAganVyaXNkaWN0aW9uc0NvdW50cnkgPSBcImp1cmlzZGljdGlvbnMtY291bnRyeVwiLFxuICAgIHBpcGVsaW5lTWF0dGVyID0gXCJwaXBlbGluZS1tYXR0ZXJcIixcbiAgICBleHBlcnRNYXR0ZXJOdW1iZXIgPSBcImV4cGVydC1tYXR0ZXItbnVtYmVyXCIsXG4gICAgZXhwZXJ0TWF0dGVyTnVtYmVyVmFsdWUgPSBcImV4cGVydC1tYXR0ZXItbnVtYmVyLXZhbHVlXCIsXG4gICAgdGVtcE1hdHRlck51bWJlciA9IFwidGVtcC1tYXR0ZXItbnVtYmVyXCIsXG4gICAgc3ViTWF0dGVyQ29kZSA9IFwic3ViLW1hdHRlci1jb2RlXCIsXG4gICAgYWJjTWF0dGVyTnVtYmVyID0gXCJhYmMtbWF0dGVyLW51bWJlclwiLFxuICAgIG1hdHRlckRldGFpbHMgPSBcIm1hdHRlci1kZXRhaWxzXCIsXG4gICAgXG59XG5cbi8qKlxuICogRW51bSBmb3IgdGhlIGZpZWxkcyBpbiB0aGUgbWF0dGVyIGRldGFpbHMgc3ViIGFyZWEgb2YgdGhlIGZvcm0gYnVpbGRlclxuICovXG5leHBvcnQgZW51bSBlbnVtTWF0dGVyRGV0YWlsRmllbGRzIHtcbiAgICBtYXR0ZXJEZXRhaWxzUGFydG5lclNlbGVjdG9yID0gXCJtYXR0ZXItZGV0YWlscy1wYXJ0bmVyLXNlbGVjdG9yXCIsXG4gICAgbWF0dGVyRGV0YWlsc1BhcnRuZXJOYW1lID0gXCJtYXR0ZXItZGV0YWlscy1wYXJ0bmVyLW5hbWVcIixcbiAgICBtYXR0ZXJEZXRhaWxzQ2xpZW50TmFtZSA9IFwibWF0dGVyLWRldGFpbHMtY2xpZW50LW5hbWVcIixcbiAgICBtYXR0ZXJEZXRhaWxzQ2xpZW50Q29kZSA9IFwibWF0dGVyLWRldGFpbHMtY2xpZW50LWNvZGVcIixcbiAgICBtYXR0ZXJEZXRhaWxzUHJhY3RpY2VBcmVhID0gXCJtYXR0ZXItZGV0YWlscy1wcmFjdGljZS1hcmVhXCIsXG4gICAgbWF0dGVyRGV0YWlsc05hbWUgPSBcIm1hdHRlci1kZXRhaWxzLW5hbWVcIixcbiAgICBtYXR0ZXJEZXRhaWxzSWIgPSBcIm1hdHRlci1kZXRhaWxzLWliXCJcbn1cblxuLyoqXG4gKiBTZWFyY2hlcyBmb3IgdGhlIHBhcnRuZXIgb2RzIHBpY2tlciBpbiB0aGUgYmxhZGUgdXNpbmcgY29tbW9uIG9kcyBoZWxwZXIgZnVuY3Rpb25zXG4gKiBAcGFyYW0gY29udGV4dCBcbiAqIEByZXR1cm5zIFxuICovXG5mdW5jdGlvbiBnZXRQYXJ0bmVyT2RzUGlja2VyKGNvbnRleHQ6IElGb3JtQnVpbGRlckNvbnRleHQpIHtcbiAgICByZXR1cm4gZ2V0QWxsUm9sZUNvbmZpZ0ZvclJvbGUoY29udGV4dC5ibGFkZSxtYXR0ZXJQYXJ0bmVyUm9sZVN5c3RlbU5hbWUpO1xufVxuXG4vKipcbiAqIFNlYXJjaGVzIGZvciB0aGUgcGFydG5lciBvZHMgcGlja2VyIGluIHRoZSBibGFkZSB1c2luZyBjb21tb24gb2RzIGhlbHBlciBmdW5jdGlvbnNcbiAqIEBwYXJhbSBjb250ZXh0IFxuICogQHJldHVybnMgXG4gKi9cbmZ1bmN0aW9uIGdldENsaWVudE9kc1BpY2tlcihjb250ZXh0OiBJRm9ybUJ1aWxkZXJDb250ZXh0KSB7XG4gICAgcmV0dXJuIGdldEFsbFJvbGVDb25maWdGb3JSb2xlKGNvbnRleHQuYmxhZGUsIGNsaWVudFJvbGVTeXN0ZW1OYW1lKTtcbn1cbiJdLCJuYW1lcyI6WyJfX3dlYnBhY2tfcmVxdWlyZV9fIiwiZXhwb3J0cyIsImRlZmluaXRpb24iLCJrZXkiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0Iiwib2JqIiwicHJvcCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJnZXRBbGxSb2xlQ29uZmlnRm9yUm9sZSIsImJsYWRlIiwicm9sZSIsInJldFZhbHVlIiwicm9sZUNvbmZpZyIsIk9EU0VudGl0aWVzIiwiYWxsT2RzQXNwZWN0cyIsInR5cGVUb0NoZWNrIiwiU2hhcmVkbyIsIkNvcmUiLCJDYXNlIiwiQXNwZWN0cyIsIldpZGdldHMiLCJPZHNFbnRpdHlQaWNrZXIiLCJhc3BlY3RzIiwiZmlsdGVyIiwiYSIsIndpZGdldCIsImdldE9kc1dpZGdldHMiLCJmb3JFYWNoIiwib2RzRW50aXRpZXMiLCJvZHMiLCJyb2xlU3lzdGVtTmFtZSIsInB1c2giLCJvcHRpb25zIiwicm9sZUNvbmZpZ01vZGVscyIsInIiLCJzZWFyY2hPZHNBbmRSZXR1cm5Sb3dzIiwic2VhcmNoIiwicG9zdEJvZHkiLCJBUElSZXN1bHQiLCJhcGkiLCIkYWpheCIsInBvc3QiLCJleGVjdXRlUG9zdCIsIndpbmRvdyIsImRvY3VtZW50IiwibG9jYXRpb24iLCJvcmlnaW4iLCJlIiwiY29uc29sZSIsIndhcm4iLCJfc2VhcmNoIiwibG9nIiwicm93cyIsIm1hcCIsIkpTT04iLCJwYXJzZSIsInJlc3VsdCIsImV4dHJhY3RSb3dzRnJvbU9EU1NlYXJjaFJlc3VsdHMiLCJtYXR0ZXJQYXJ0bmVyUm9sZVN5c3RlbU5hbWUiLCJjbGllbnRSb2xlU3lzdGVtTmFtZSIsInJ1bk1lIiwiY29udGV4dCIsImV4cGVydE1hdHRlck51bWJlciIsIm1hdHRlckRldGFpbHMiLCJwaXBlbGluZU1hdHRlciIsImZvcm0iLCJFcnJvciIsImZpZWxkc0J5SWQiLCJlbnVtRmllbGRzIiwiY3JlYXRlVmFyaWFibGVzIiwidGVzdGVyIiwidW5kZWZpbmVkIiwid29ya0l0ZW1Db250ZXh0IiwiaWQiLCJwaGFzZU5hbWUiLCJ0b0xvd2VyQ2FzZSIsImluY2x1ZGVzIiwiaGlkZVNob3dNYXR0ZXJEZXRhaWxzIiwiZW51bU1hdHRlckRldGFpbEZpZWxkcyIsIm1hdHRlckRldGFpbHNQYXJ0bmVyTmFtZSIsIm9uIiwiZXYiLCJnZXRWYWx1ZSIsInVwZGF0ZU1hdHRlckRldGFpbHMiLCJqdXJpc2RpY3Rpb25zQ291bnRyeSIsInNlbGVjdGVkSWQiLCJhc3BlY3QiLCJnZXRBc3BlY3QiLCJzZWxlY3RlZEp1cmlzZGljdGlvbkNvdW50cnkiLCJzZWxlY3RlZEp1cmlzZGljdGlvbiIsImZpbmQiLCJvcHRpb24iLCJuYW1lIiwiaW5zdHJ1Y3Rpb24iLCJqdXJpc2RpY3Rpb25JZCIsImFkZEV2ZW50SGFuZGxlcnMiLCJkYXRlIiwiRGF0ZSIsInRlbXBNYXR0ZXJOdW1iZXIiLCJnZXRGdWxsWWVhciIsImdldE1vbnRoIiwiZ2V0RGF0ZSIsImdldEhvdXJzIiwiZ2V0TWludXRlcyIsImdldFNlY29uZHMiLCJnZXRNaWxsaXNlY29uZHMiLCJzZXRWYWx1ZSIsImdlbmVyYXRlVGVtcE1hdHRlck51bWJlciIsInN0YXR1cyIsImZpZWxkcyIsImNoaWxkIiwicmVhZG9ubHkiLCJzZXRNYXR0ZXJEZXRhaWxzU3RhdGUiLCJjbGVhck1hdHRlckRldGFpbHMiLCJkYXRhIiwiZ2V0TWF0dGVyRGF0YSIsInNlbGVjdGVkTWF0dGVyIiwibWF0dGVyIiwibWF0dGVyQ29kZSIsInBhcmVudCIsImxlbmd0aCIsImV4cGVydE1hdHRlck51bWJlclZhbHVlIiwibWF0dGVyRGV0YWlsc0NsaWVudE5hbWUiLCJjbGllbnQiLCJtYXR0ZXJEZXRhaWxzQ2xpZW50Q29kZSIsImNvZGUiLCJtYXR0ZXJEZXRhaWxzUHJhY3RpY2VBcmVhIiwicHJhY3RpY2VBcmVhIiwibWF0dGVyRGV0YWlsc05hbWUiLCJzaG9ydE5hbWUiLCJwYXJ0bmVyIiwibWF0dGVyRGV0YWlsc0liIiwic2VjdXJlIiwiaXNWYWxpZCIsInNwbGl0Iiwic2VhcmNoRm9yVXNlcnMiLCJlbWFpbCIsInRoZW4iLCJ1c2VycyIsInVzZXIiLCJvZHNNYXR0ZXJQYXJ0bmVyIiwiZ2V0UGFydG5lck9kc1BpY2tlciIsIm9kc1JvbGVDb25maWciLCJzZWxlY3RlZCIsImVudGl0eSIsImFkZFNlcnZpY2UiLCJjcmVhdGVTZWxlY3RlZEVudGl0eU1vZGVsIiwiZmlyc3ROYW1lIiwic3VybmFtZSIsInNlbGVjdGVkRW50aXR5IiwidHJ5VXBkYXRlUGFydG5lck9kc1BpY2tlciIsInNlYXJjaEZvckNsaWVudHMiLCJjbGllbnRzIiwib2RzQ2xpZW50IiwiZ2V0Q2xpZW50T2RzUGlja2VyIiwidHJ5VXBkYXRlQ2xpZW50T2RzUGlja2VyIl0sInNvdXJjZVJvb3QiOiIifQ==